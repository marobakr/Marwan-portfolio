exports.id=656,exports.ids=[656],exports.modules={4656:(__unused_webpack_module2,__webpack_exports__,__webpack_require__2)=>{"use strict";__webpack_require__2.r(__webpack_exports__),__webpack_require__2.d(__webpack_exports__,{ResumeComponent:()=>ResumeComponent});var canvase_component=__webpack_require__2(3453),common=__webpack_require__2(4565),core=__webpack_require__2(8371),cjs=__webpack_require__2(2859),operators=__webpack_require__2(3409),pdf=__webpack_require__2(405),pdf_namespaceObject=__webpack_require__2.t(pdf,2),pdf_viewer=__webpack_require__2(788),pdf_viewer_namespaceObject=__webpack_require__2.t(pdf_viewer,2);const _c0=["pdfViewerContainer"];function ng2_pdf_viewer_assign(obj,prop,value){obj[prop]=value}function isSSR(){return typeof window>"u"}isSSR()||ng2_pdf_viewer_assign(pdf_namespaceObject,"verbosity",pdf.VerbosityLevel.INFOS);var RenderTextMode=function(RenderTextMode2){return RenderTextMode2[RenderTextMode2.DISABLED=0]="DISABLED",RenderTextMode2[RenderTextMode2.ENABLED=1]="ENABLED",RenderTextMode2[RenderTextMode2.ENHANCED=2]="ENHANCED",RenderTextMode2}(RenderTextMode||{});let PdfViewerComponent=(()=>{class PdfViewerComponent2{element;ngZone;static CSS_UNITS=96/72;static BORDER_WIDTH=9;pdfViewerContainer;eventBus;pdfLinkService;pdfFindController;pdfViewer;isVisible=!1;_cMapsUrl=typeof pdf_namespaceObject<"u"?`https://unpkg.com/pdfjs-dist@${pdf.version}/cmaps/`:null;_imageResourcesPath=typeof pdf_namespaceObject<"u"?`https://unpkg.com/pdfjs-dist@${pdf.version}/web/images/`:void 0;_renderText=!0;_renderTextMode=RenderTextMode.ENABLED;_stickToPage=!1;_originalSize=!0;_pdf;_page=1;_zoom=1;_zoomScale="page-width";_rotation=0;_showAll=!0;_canAutoResize=!0;_fitToPage=!1;_externalLinkTarget="blank";_showBorders=!1;lastLoaded;_latestScrolledPage;resizeTimeout=null;pageScrollTimeout=null;isInitialized=!1;loadingTask;destroy$=new cjs.Subject;afterLoadComplete=new core.vpe;pageRendered=new core.vpe;pageInitialized=new core.vpe;textLayerRendered=new core.vpe;onError=new core.vpe;onProgress=new core.vpe;pageChange=new core.vpe(!0);src;set cMapsUrl(cMapsUrl){this._cMapsUrl=cMapsUrl}set page(_page){const originalPage=_page=parseInt(_page,10)||1;this._pdf&&(_page=this.getValidPageNumber(_page)),this._page=_page,originalPage!==_page&&this.pageChange.emit(_page)}set renderText(renderText){this._renderText=renderText}set renderTextMode(renderTextMode){this._renderTextMode=renderTextMode}set originalSize(originalSize){this._originalSize=originalSize}set showAll(value){this._showAll=value}set stickToPage(value){this._stickToPage=value}set zoom(value){value<=0||(this._zoom=value)}get zoom(){return this._zoom}set zoomScale(value){this._zoomScale=value}get zoomScale(){return this._zoomScale}set rotation(value){"number"==typeof value&&value%90==0?this._rotation=value:console.warn("Invalid pages rotation angle.")}set externalLinkTarget(value){this._externalLinkTarget=value}set autoresize(value){this._canAutoResize=!!value}set fitToPage(value){this._fitToPage=!!value}set showBorders(value){this._showBorders=!!value}static getLinkTarget(type){switch(type){case"blank":return pdf_viewer.LinkTarget.BLANK;case"none":return pdf_viewer.LinkTarget.NONE;case"self":return pdf_viewer.LinkTarget.SELF;case"parent":return pdf_viewer.LinkTarget.PARENT;case"top":return pdf_viewer.LinkTarget.TOP}return null}constructor(element,ngZone){if(this.element=element,this.ngZone=ngZone,isSSR())return;let pdfWorkerSrc;const pdfJsVersion=pdf.version;pdfWorkerSrc=window[`pdfWorkerSrc${pdfJsVersion}`]||(window.hasOwnProperty("pdfWorkerSrc")&&"string"==typeof window.pdfWorkerSrc&&window.pdfWorkerSrc?window.pdfWorkerSrc:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${pdfJsVersion}/legacy/build/pdf.worker.min.js`),ng2_pdf_viewer_assign(pdf.GlobalWorkerOptions,"workerSrc",pdfWorkerSrc)}ngAfterViewChecked(){if(this.isInitialized)return;const offset=this.pdfViewerContainer.nativeElement.offsetParent;!0!==this.isVisible||null!=offset?!1===this.isVisible&&null!=offset&&(this.isVisible=!0,setTimeout(()=>{this.initialize(),this.ngOnChanges({src:this.src})})):this.isVisible=!1}ngOnInit(){this.initialize(),this.setupResizeListener()}ngOnDestroy(){this.clear(),this.destroy$.next(),this.loadingTask=null}ngOnChanges(changes){if(!isSSR()&&this.isVisible)if("src"in changes)this.loadPDF();else if(this._pdf){if("renderText"in changes?(this.pdfViewer.textLayerMode=this._renderText?this._renderTextMode:RenderTextMode.DISABLED,this.resetPdfDocument()):"showAll"in changes&&(this.setupViewer(),this.resetPdfDocument()),"page"in changes){const{page}=changes;if(page.currentValue===this._latestScrolledPage)return;this.pdfViewer.scrollPageIntoView({pageNumber:this._page})}this.update()}}updateSize(){(0,cjs.from)(this._pdf.getPage(this.pdfViewer.currentPageNumber)).pipe((0,operators.Rs)(this.destroy$)).subscribe({next:page=>{const rotation=this._rotation+page.rotate,viewportWidth=page.getViewport({scale:this._zoom,rotation}).width*PdfViewerComponent2.CSS_UNITS;let scale=this._zoom,stickToPage=!0;if(!this._originalSize||this._fitToPage&&viewportWidth>this.pdfViewerContainer.nativeElement.clientWidth){const viewPort=page.getViewport({scale:1,rotation});scale=this.getScale(viewPort.width,viewPort.height),stickToPage=!this._stickToPage}this.pdfViewer._setScale(scale,stickToPage)}})}clear(){this.loadingTask&&!this.loadingTask.destroyed&&this.loadingTask.destroy(),this._pdf&&(this._latestScrolledPage=0,this._pdf.destroy(),this._pdf=void 0),this.pdfViewer&&this.pdfViewer.setDocument(null),this.pdfLinkService&&this.pdfLinkService.setDocument(null,null),this.pdfFindController&&this.pdfFindController.setDocument(null)}getPDFLinkServiceConfig(){const linkTarget=PdfViewerComponent2.getLinkTarget(this._externalLinkTarget);return linkTarget?{externalLinkTarget:linkTarget}:{}}initEventBus(){this.eventBus=function createEventBus(pdfJsViewer,destroy$){const globalEventBus=new pdfJsViewer.EventBus;return function attachDOMEventsToEventBus(eventBus,destroy$){(0,cjs.fromEvent)(eventBus,"documentload").pipe((0,operators.Rs)(destroy$)).subscribe(()=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("documentload",!0,!0,{}),window.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"pagerendered").pipe((0,operators.Rs)(destroy$)).subscribe(({pageNumber,cssTransform,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("pagerendered",!0,!0,{pageNumber,cssTransform}),source.div.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"textlayerrendered").pipe((0,operators.Rs)(destroy$)).subscribe(({pageNumber,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("textlayerrendered",!0,!0,{pageNumber}),source.textLayerDiv.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"pagechanging").pipe((0,operators.Rs)(destroy$)).subscribe(({pageNumber,source})=>{const event=document.createEvent("UIEvents");event.initEvent("pagechanging",!0,!0),event.pageNumber=pageNumber,source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"pagesinit").pipe((0,operators.Rs)(destroy$)).subscribe(({source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("pagesinit",!0,!0,null),source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"pagesloaded").pipe((0,operators.Rs)(destroy$)).subscribe(({pagesCount,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("pagesloaded",!0,!0,{pagesCount}),source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"scalechange").pipe((0,operators.Rs)(destroy$)).subscribe(({scale,presetValue,source})=>{const event=document.createEvent("UIEvents");event.initEvent("scalechange",!0,!0),event.scale=scale,event.presetValue=presetValue,source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"updateviewarea").pipe((0,operators.Rs)(destroy$)).subscribe(({location,source})=>{const event=document.createEvent("UIEvents");event.initEvent("updateviewarea",!0,!0),event.location=location,source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"find").pipe((0,operators.Rs)(destroy$)).subscribe(({source,type,query,phraseSearch,caseSensitive,highlightAll,findPrevious})=>{if(source===window)return;const event=document.createEvent("CustomEvent");event.initCustomEvent("find"+type,!0,!0,{query,phraseSearch,caseSensitive,highlightAll,findPrevious}),window.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"attachmentsloaded").pipe((0,operators.Rs)(destroy$)).subscribe(({attachmentsCount,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("attachmentsloaded",!0,!0,{attachmentsCount}),source.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"sidebarviewchanged").pipe((0,operators.Rs)(destroy$)).subscribe(({view,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("sidebarviewchanged",!0,!0,{view}),source.outerContainer.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"pagemode").pipe((0,operators.Rs)(destroy$)).subscribe(({mode,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("pagemode",!0,!0,{mode}),source.pdfViewer.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"namedaction").pipe((0,operators.Rs)(destroy$)).subscribe(({action,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("namedaction",!0,!0,{action}),source.pdfViewer.container.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"presentationmodechanged").pipe((0,operators.Rs)(destroy$)).subscribe(({active,switchInProgress})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("presentationmodechanged",!0,!0,{active,switchInProgress}),window.dispatchEvent(event)}),(0,cjs.fromEvent)(eventBus,"outlineloaded").pipe((0,operators.Rs)(destroy$)).subscribe(({outlineCount,source})=>{const event=document.createEvent("CustomEvent");event.initCustomEvent("outlineloaded",!0,!0,{outlineCount}),source.container.dispatchEvent(event)})}(globalEventBus,destroy$),globalEventBus}(pdf_viewer_namespaceObject,this.destroy$),(0,cjs.fromEvent)(this.eventBus,"pagerendered").pipe((0,operators.Rs)(this.destroy$)).subscribe(event=>{this.pageRendered.emit(event)}),(0,cjs.fromEvent)(this.eventBus,"pagesinit").pipe((0,operators.Rs)(this.destroy$)).subscribe(event=>{this.pageInitialized.emit(event)}),(0,cjs.fromEvent)(this.eventBus,"pagechanging").pipe((0,operators.Rs)(this.destroy$)).subscribe(({pageNumber})=>{this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.pageScrollTimeout=window.setTimeout(()=>{this._latestScrolledPage=pageNumber,this.pageChange.emit(pageNumber)},100)}),(0,cjs.fromEvent)(this.eventBus,"textlayerrendered").pipe((0,operators.Rs)(this.destroy$)).subscribe(event=>{this.textLayerRendered.emit(event)})}initPDFServices(){this.pdfLinkService=new pdf_viewer.PDFLinkService({eventBus:this.eventBus,...this.getPDFLinkServiceConfig()}),this.pdfFindController=new pdf_viewer.PDFFindController({eventBus:this.eventBus,linkService:this.pdfLinkService})}getPDFOptions(){return{eventBus:this.eventBus,container:this.element.nativeElement.querySelector("div"),removePageBorders:!this._showBorders,linkService:this.pdfLinkService,textLayerMode:this._renderText?this._renderTextMode:RenderTextMode.DISABLED,findController:this.pdfFindController,l10n:new pdf_viewer.GenericL10n("en"),imageResourcesPath:this._imageResourcesPath}}setupViewer(){ng2_pdf_viewer_assign(pdf_namespaceObject,"disableTextLayer",!this._renderText),this.initPDFServices(),this.pdfViewer=this._showAll?new pdf_viewer.PDFViewer(this.getPDFOptions()):new pdf_viewer.PDFSinglePageViewer(this.getPDFOptions()),this.pdfLinkService.setViewer(this.pdfViewer),this.pdfViewer._currentPageNumber=this._page}getValidPageNumber(page){return page<1?1:page>this._pdf.numPages?this._pdf.numPages:page}getDocumentParams(){const srcType=typeof this.src;if(!this._cMapsUrl)return this.src;const params={cMapUrl:this._cMapsUrl,cMapPacked:!0,enableXfa:!0};return"string"===srcType?params.url=this.src:"object"===srcType&&(void 0!==this.src.byteLength?params.data=this.src:Object.assign(params,this.src)),params}loadPDF(){if(!this.src)return;if(this.lastLoaded===this.src)return void this.update();this.clear(),this.setupViewer(),this.loadingTask=pdf.getDocument(this.getDocumentParams()),this.loadingTask.onProgress=progressData=>{this.onProgress.emit(progressData)};const src=this.src;(0,cjs.from)(this.loadingTask.promise).pipe((0,operators.Rs)(this.destroy$)).subscribe({next:pdf2=>{this._pdf=pdf2,this.lastLoaded=src,this.afterLoadComplete.emit(pdf2),this.resetPdfDocument(),this.update()},error:error=>{this.lastLoaded=null,this.onError.emit(error)}})}update(){this.page=this._page,this.render()}render(){this._page=this.getValidPageNumber(this._page),(0!==this._rotation||this.pdfViewer.pagesRotation!==this._rotation)&&setTimeout(()=>{this.pdfViewer.pagesRotation=this._rotation}),this._stickToPage&&setTimeout(()=>{this.pdfViewer.currentPageNumber=this._page}),this.updateSize()}getScale(viewportWidth,viewportHeight){const borderSize=this._showBorders?2*PdfViewerComponent2.BORDER_WIDTH:0,pdfContainerWidth=this.pdfViewerContainer.nativeElement.clientWidth-borderSize,pdfContainerHeight=this.pdfViewerContainer.nativeElement.clientHeight-borderSize;if(0===pdfContainerHeight||0===viewportHeight||0===pdfContainerWidth||0===viewportWidth)return 1;let ratio=1;switch(this._zoomScale){case"page-fit":ratio=Math.min(pdfContainerHeight/viewportHeight,pdfContainerWidth/viewportWidth);break;case"page-height":ratio=pdfContainerHeight/viewportHeight;break;default:ratio=pdfContainerWidth/viewportWidth}return this._zoom*ratio/PdfViewerComponent2.CSS_UNITS}resetPdfDocument(){this.pdfLinkService.setDocument(this._pdf,null),this.pdfFindController.setDocument(this._pdf),this.pdfViewer.setDocument(this._pdf)}initialize(){isSSR()||!this.isVisible||(this.isInitialized=!0,this.initEventBus(),this.setupViewer())}setupResizeListener(){isSSR()||this.ngZone.runOutsideAngular(()=>{(0,cjs.fromEvent)(window,"resize").pipe((0,operators.bh)(100),(0,operators.hX)(()=>this._canAutoResize&&!!this._pdf),(0,operators.Rs)(this.destroy$)).subscribe(()=>{this.updateSize()})})}static \u0275fac=function(t){return new(t||PdfViewerComponent2)(core.Y36(core.SBq),core.Y36(core.R0b))};static \u0275cmp=core.Xpm({type:PdfViewerComponent2,selectors:[["pdf-viewer"]],viewQuery:function(rf,ctx){if(1&rf&&core.Gf(_c0,5),2&rf){let _t;core.iGM(_t=core.CRH())&&(ctx.pdfViewerContainer=_t.first)}},inputs:{src:"src",cMapsUrl:["c-maps-url","cMapsUrl"],page:"page",renderText:["render-text","renderText"],renderTextMode:["render-text-mode","renderTextMode"],originalSize:["original-size","originalSize"],showAll:["show-all","showAll"],stickToPage:["stick-to-page","stickToPage"],zoom:"zoom",zoomScale:["zoom-scale","zoomScale"],rotation:"rotation",externalLinkTarget:["external-link-target","externalLinkTarget"],autoresize:"autoresize",fitToPage:["fit-to-page","fitToPage"],showBorders:["show-borders","showBorders"]},outputs:{afterLoadComplete:"after-load-complete",pageRendered:"page-rendered",pageInitialized:"pages-initialized",textLayerRendered:"text-layer-rendered",onError:"error",onProgress:"on-progress",pageChange:"pageChange"},features:[core.TTD],decls:3,vars:0,consts:[[1,"ng2-pdf-viewer-container"],["pdfViewerContainer",""],[1,"pdfViewer"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"div",0,1),core._UZ(2,"div",2),core.qZA())},styles:['.ng2-pdf-viewer-container[_ngcontent-%COMP%]{overflow-x:auto;position:absolute;height:100%;width:100%;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 0;--page-margin: 1px auto -8px;--page-border: 9px solid transparent;--spreadHorizontalWrapped-margin-LR: -3.5px;--viewer-container-height: 0;--annotation-unfocused-field-background: url("data:image/svg+xml;charset=UTF-8,<svg width=\'1px\' height=\'1px\' xmlns=\'http://www.w3.org/2000/svg\'><rect width=\'100%\' height=\'100%\' style=\'fill:rgba(0, 54, 255, 0.13);\'/></svg>");--xfa-unfocused-field-background: var( --annotation-unfocused-field-background );--page-border-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA1ElEQVQ4jbWUWw6EIAxFy2NFs/8NzR4UJhpqLsdi5mOmSSMUOfYWqv3S0gMr4XlYH/64gZa/gN3ANYA7KAXALt4ktoQ5MI9YxqaG8bWmsIysMuT6piSQCa4whZThCu8CM4zP9YJaKci9jicPq3NcBWYoPMGUlhG7ivtkB+gVyFY75wXghOvh8t5mto1Mdim6e+MBqH6XsY+YAwjpq3vGF7weTWQptLEDVCZvPTMl5JZZsdh47FHW6qFMyvLYqjcnmdFfY9Xk/KDOlzCusX2mi/ofM7MPkzBcSp4Q1/wAAAAASUVORK5CYII=) 9 9 repeat;--scale-factor: 1;--focus-outline: solid 2px blue;--hover-outline: dashed 2px blue;--freetext-line-height: 1.35;--freetext-padding: 2px;--editorInk-editing-cursor: pointer}@media screen and (forced-colors: active){[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 9px;--page-margin: 8px auto -1px;--page-border: 1px solid CanvasText;--page-border-image: none;--spreadHorizontalWrapped-margin-LR: 3.5px}}@media (forced-colors: active){[_nghost-%COMP%]    {--focus-outline: solid 3px ButtonText;--hover-outline: dashed 3px ButtonText}}[_nghost-%COMP%]     .textLayer{position:absolute;text-align:initial;inset:0;overflow:hidden;opacity:.2;line-height:1;-webkit-text-size-adjust:none;text-size-adjust:none;forced-color-adjust:none}[_nghost-%COMP%]     .textLayer span, [_nghost-%COMP%]     .textLayer br{color:transparent;position:absolute;white-space:pre;cursor:text;transform-origin:0% 0%}[_nghost-%COMP%]     .textLayer span.markedContent{top:0;height:0}[_nghost-%COMP%]     .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}[_nghost-%COMP%]     .textLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .textLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .textLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .textLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .textLayer .highlight.selected{background-color:#006400}[_nghost-%COMP%]     .textLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .textLayer br::selection{background:transparent}[_nghost-%COMP%]     .textLayer .endOfContent{display:block;position:absolute;inset:100% 0 0;z-index:-1;cursor:default;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .textLayer .endOfContent.active{top:0}@media (forced-colors: active){[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .annotationLayer{position:absolute;top:0;left:0;pointer-events:none;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer section{position:absolute;text-align:initial;pointer-events:auto;box-sizing:border-box;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>canvas{width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a:hover{opacity:.2;background:rgb(255,255,0);box-shadow:0 2px 10px #ff0}[_nghost-%COMP%]     .annotationLayer .textAnnotation img{position:absolute;cursor:pointer;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{background-image:var(--annotation-unfocused-field-background);border:1px solid transparent;box-sizing:border-box;font:calc(9px * var(--scale-factor)) sans-serif;height:100%;margin:0;vertical-align:top;width:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid red}[_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select option{padding:0}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{border-radius:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea{resize:none}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input[disabled], [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea[disabled], [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input[disabled]{background:none;border:1px solid transparent;cursor:not-allowed}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:hover, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:hover, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:hover{border:1px solid rgb(0,0,0)}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:focus{background:none;border:1px solid transparent}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input :focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea :focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton :focus{background-image:none;background-color:transparent;outline:auto}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{background-color:CanvasText;content:"";display:block;position:absolute}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{height:80%;left:45%;width:1px}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before{transform:rotate(45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{transform:rotate(-45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{border-radius:50%;height:50%;left:30%;top:20%;width:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb{font-family:monospace;padding-left:2px;padding-right:0}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb:focus{width:103%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .annotationLayer .popupTriggerArea{height:100%;width:100%}[_nghost-%COMP%]     .annotationLayer .popupWrapper{position:absolute;font-size:calc(9px * var(--scale-factor));width:100%;min-width:calc(180px * var(--scale-factor));pointer-events:none}[_nghost-%COMP%]     .annotationLayer .popup{position:absolute;max-width:calc(180px * var(--scale-factor));background-color:#ff9;box-shadow:0 calc(2px * var(--scale-factor)) calc(5px * var(--scale-factor)) #888;border-radius:calc(2px * var(--scale-factor));padding:calc(6px * var(--scale-factor));margin-left:calc(5px * var(--scale-factor));cursor:pointer;font:message-box;white-space:normal;word-wrap:break-word;pointer-events:auto}[_nghost-%COMP%]     .annotationLayer .popup>*{font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popup h1{display:inline-block}[_nghost-%COMP%]     .annotationLayer .popupDate{display:inline-block;margin-left:calc(5px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popupContent{border-top:1px solid rgb(51,51,51);margin-top:calc(2px * var(--scale-factor));padding-top:calc(2px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .richText>*{white-space:pre-wrap;font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .highlightAnnotation, [_nghost-%COMP%]     .annotationLayer .underlineAnnotation, [_nghost-%COMP%]     .annotationLayer .squigglyAnnotation, [_nghost-%COMP%]     .annotationLayer .strikeoutAnnotation, [_nghost-%COMP%]     .annotationLayer .freeTextAnnotation, [_nghost-%COMP%]     .annotationLayer .lineAnnotation svg line, [_nghost-%COMP%]     .annotationLayer .squareAnnotation svg rect, [_nghost-%COMP%]     .annotationLayer .circleAnnotation svg ellipse, [_nghost-%COMP%]     .annotationLayer .polylineAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .polygonAnnotation svg polygon, [_nghost-%COMP%]     .annotationLayer .caretAnnotation, [_nghost-%COMP%]     .annotationLayer .inkAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .stampAnnotation, [_nghost-%COMP%]     .annotationLayer .fileAttachmentAnnotation{cursor:pointer}[_nghost-%COMP%]     .annotationLayer section svg{position:absolute;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .annotationTextContent{position:absolute;width:100%;height:100%;opacity:0;color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none}[_nghost-%COMP%]     .annotationLayer .annotationTextContent span{width:100%;display:inline-block}@media (forced-colors: active){[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .xfaLayer .highlight{margin:-1px;padding:1px;background-color:#efcbed;border-radius:4px}[_nghost-%COMP%]     .xfaLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .xfaLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .xfaLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .xfaLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .xfaLayer .highlight.selected{background-color:#cbdfcb}[_nghost-%COMP%]     .xfaLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .xfaPage{overflow:hidden;position:relative}[_nghost-%COMP%]     .xfaContentarea{position:absolute}[_nghost-%COMP%]     .xfaPrintOnly{display:none}[_nghost-%COMP%]     .xfaLayer{position:absolute;text-align:initial;top:0;left:0;transform-origin:0 0;line-height:1.2}[_nghost-%COMP%]     .xfaLayer *{color:inherit;font:inherit;font-style:inherit;font-weight:inherit;font-kerning:inherit;letter-spacing:-.01px;text-align:inherit;text-decoration:inherit;box-sizing:border-box;background-color:transparent;padding:0;margin:0;pointer-events:auto;line-height:inherit}[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid red}[_nghost-%COMP%]     .xfaLayer div{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg *{pointer-events:none}[_nghost-%COMP%]     .xfaLayer a{color:#00f}[_nghost-%COMP%]     .xfaRich li{margin-left:3em}[_nghost-%COMP%]     .xfaFont{color:#000;font-weight:400;font-kerning:none;font-size:10px;font-style:normal;letter-spacing:0;text-decoration:none;vertical-align:0}[_nghost-%COMP%]     .xfaCaption{overflow:hidden;flex:0 0 auto}[_nghost-%COMP%]     .xfaCaptionForCheckButton{overflow:hidden;flex:1 1 auto}[_nghost-%COMP%]     .xfaLabel{height:100%;width:100%}[_nghost-%COMP%]     .xfaLeft{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]     .xfaRight{display:flex;flex-direction:row-reverse;align-items:center}[_nghost-%COMP%]     .xfaLeft>.xfaCaption, [_nghost-%COMP%]     .xfaLeft>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaRight>.xfaCaption, [_nghost-%COMP%]     .xfaRight>.xfaCaptionForCheckButton{max-height:100%}[_nghost-%COMP%]     .xfaTop{display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .xfaBottom{display:flex;flex-direction:column-reverse;align-items:flex-start}[_nghost-%COMP%]     .xfaTop>.xfaCaption, [_nghost-%COMP%]     .xfaTop>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaBottom>.xfaCaption, [_nghost-%COMP%]     .xfaBottom>.xfaCaptionForCheckButton{width:100%}[_nghost-%COMP%]     .xfaBorder{background-color:transparent;position:absolute;pointer-events:none}[_nghost-%COMP%]     .xfaWrapped{width:100%;height:100%}[_nghost-%COMP%]     .xfaTextfield:focus, [_nghost-%COMP%]     .xfaSelect:focus{background-image:none;background-color:transparent;outline:auto;outline-offset:-1px}[_nghost-%COMP%]     .xfaCheckbox:focus, [_nghost-%COMP%]     .xfaRadio:focus{outline:auto}[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{height:100%;width:100%;flex:1 1 auto;border:none;resize:none;background-image:var(--xfa-unfocused-field-background)}[_nghost-%COMP%]     .xfaTop>.xfaTextfield, [_nghost-%COMP%]     .xfaTop>.xfaSelect, [_nghost-%COMP%]     .xfaBottom>.xfaTextfield, [_nghost-%COMP%]     .xfaBottom>.xfaSelect{flex:0 1 auto}[_nghost-%COMP%]     .xfaButton{cursor:pointer;width:100%;height:100%;border:none;text-align:center}[_nghost-%COMP%]     .xfaLink{width:100%;height:100%;position:absolute;top:0;left:0}[_nghost-%COMP%]     .xfaCheckbox, [_nghost-%COMP%]     .xfaRadio{width:100%;height:100%;flex:0 0 auto;border:none}[_nghost-%COMP%]     .xfaRich{white-space:pre-wrap;width:100%;height:100%}[_nghost-%COMP%]     .xfaImage{object-position:left top;object-fit:contain;width:100%;height:100%}[_nghost-%COMP%]     .xfaLrTb, [_nghost-%COMP%]     .xfaRlTb, [_nghost-%COMP%]     .xfaTb{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaLr{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaRl{display:flex;flex-direction:row-reverse;align-items:stretch}[_nghost-%COMP%]     .xfaTb>div{justify-content:left}[_nghost-%COMP%]     .xfaPosition{position:relative}[_nghost-%COMP%]     .xfaArea{position:relative}[_nghost-%COMP%]     .xfaValignMiddle{display:flex;align-items:center}[_nghost-%COMP%]     .xfaTable{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRow{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRlRow{display:flex;flex-direction:row-reverse;align-items:stretch;flex:1}[_nghost-%COMP%]     .xfaTable .xfaRlRow>div{flex:1}[_nghost-%COMP%]     .xfaNonInteractive input, [_nghost-%COMP%]     .xfaNonInteractive textarea, [_nghost-%COMP%]     .xfaDisabled input, [_nghost-%COMP%]     .xfaDisabled textarea, [_nghost-%COMP%]     .xfaReadOnly input, [_nghost-%COMP%]     .xfaReadOnly textarea{background:initial}@media print{[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{background:transparent}[_nghost-%COMP%]     .xfaSelect{-webkit-appearance:none;appearance:none;text-indent:1px;text-overflow:""}}[_nghost-%COMP%]     [data-editor-rotation="90"]{transform:rotate(90deg)}[_nghost-%COMP%]     [data-editor-rotation="180"]{transform:rotate(180deg)}[_nghost-%COMP%]     [data-editor-rotation="270"]{transform:rotate(270deg)}[_nghost-%COMP%]     .annotationEditorLayer{background:transparent;position:absolute;top:0;left:0;font-size:calc(100px * var(--scale-factor));transform-origin:0 0}[_nghost-%COMP%]     .annotationEditorLayer .selectedEditor{outline:var(--focus-outline);resize:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor{position:absolute;background:transparent;border-radius:3px;padding:calc(var(--freetext-padding) * var(--scale-factor));resize:none;width:auto;height:auto;z-index:1;transform-origin:0 0;touch-action:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal{background:transparent;border:none;top:0;left:0;overflow:visible;white-space:nowrap;resize:none;font:10px sans-serif;line-height:var(--freetext-line-height)}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay{position:absolute;display:none;background:transparent;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay.enabled{display:block}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:empty:before{content:attr(default-content);color:gray}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:focus{outline:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled{resize:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled.selectedEditor{resize:horizontal}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor:hover:not(.selectedEditor), [_nghost-%COMP%]     .annotationEditorLayer .inkEditor:hover:not(.selectedEditor){outline:var(--hover-outline)}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor{position:absolute;background:transparent;border-radius:3px;overflow:auto;width:100%;height:100%;z-index:1;transform-origin:0 0;cursor:auto}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.editing{resize:none;cursor:var(--editorInk-editing-cursor),pointer}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor .inkEditorCanvas{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none}[_nghost-%COMP%]     [data-main-rotation="90"]{transform:rotate(90deg) translateY(-100%)}[_nghost-%COMP%]     [data-main-rotation="180"]{transform:rotate(180deg) translate(-100%,-100%)}[_nghost-%COMP%]     [data-main-rotation="270"]{transform:rotate(270deg) translate(-100%)}[_nghost-%COMP%]     .pdfViewer{padding-bottom:var(--pdfViewer-padding-bottom)}[_nghost-%COMP%]     .pdfViewer .canvasWrapper{overflow:hidden}[_nghost-%COMP%]     .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:var(--page-margin);position:relative;overflow:visible;border:var(--page-border);border-image:var(--page-border-image);background-clip:content-box;background-color:#fff}[_nghost-%COMP%]     .pdfViewer .dummyPage{position:relative;width:0;height:var(--viewer-container-height)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}[_nghost-%COMP%]     .pdfViewer.singlePageView{display:inline-block}[_nghost-%COMP%]     .pdfViewer.singlePageView .page{margin:0;border:none}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .pdfViewer.scrollWrapped, [_nghost-%COMP%]     .spread{margin-left:3.5px;margin-right:3.5px;text-align:center}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .spread{white-space:nowrap}[_nghost-%COMP%]     .pdfViewer.removePageBorders, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{margin-left:0;margin-right:0}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .spread .dummyPage, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{display:inline-block;vertical-align:middle}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page{margin-left:var(--spreadHorizontalWrapped-margin-LR);margin-right:var(--spreadHorizontalWrapped-margin-LR)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .spread .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollWrapped .page{margin-left:5px;margin-right:5px}[_nghost-%COMP%]     .pdfViewer .page canvas{margin:0;display:block}[_nghost-%COMP%]     .pdfViewer .page canvas[hidden]{display:none}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon{position:absolute;display:block;inset:0;background:url(data:image/gif;base64,R0lGODlhGAAYAPQQAM7Ozvr6+uDg4LCwsOjo6I6OjsjIyJycnNjY2KioqMDAwPLy8nZ2doaGhri4uGhoaP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/ilPcHRpbWl6ZWQgd2l0aCBodHRwczovL2V6Z2lmLmNvbS9vcHRpbWl6ZQAh+QQJBwAQACwAAAAAGAAYAAAFmiAkjiTkOGVaBgjZNGSgkgKjjM8zLoI8iy+BKCdiCX8iBeMAhEEIPRXLxViYUE9CbCQoFAzFhHY3zkaT3oPvBz1zE4UBsr1eWZH4vAowOBwGAHk8AoQLfH6Agm0Ed3qOAXWOIgQKiWyFJQgDgJEpdG+WEACNEFNFmKVlVzJQk6qdkwqBoi1mebJ3ALNGeIZHtGSwNDS1RZKueCEAIfkECQcAEAAsAAAAABgAGAAABZcgJI4kpChlWgYCWRQkEKgjURgjw4zOg9CjVwuiEyEeO6CxkBC9nA+HiuUqLEyoBZI0Mx4SAFFgQCDZuguBoGv6Dtg0gvpqdhxQQDkBzuUr/4A1JwMKP39pc2mDhYCIc4GQYn6QCwCMeY91l0p6dBAEJ0OfcFRimZ91Mwt0alxxAIZyRmuAsKxDLKKvZbM1tJxmvGKRpn8hACH5BAkHABAALAAAAAAYABgAAAWhICSOJGQYZVoGAnkcJBKoI3EAY1GMCtPSosSBINKJBIwGkHdwBGGQA0OhYpEGQxNqkYzNIITBACEKKBaxxNfBeOCO4vMy0Hg8nDHFeCktkKtfNAtoS4UqAicKBj9zBAKPC4iKi4aRkISGmWWBmjUIAIyHkCUEAKCVo2WmREecVqoCgZhgP4NHrGWCj7e3szSpuxAsoVWxnp6cVV4kyZW+KSEAIfkECQcAEAAsAAAAABgAGAAABZkgJI4kBABlWgYEOQykEKgjMSDjcYxG0dKi108nEhQKQN4rCIMkCgbawjWYnSCLY2yGVSgEooBhWqsGGwxc0RtNBgoMhmJ1QgETjANYFeBKyUmBKQQIdT9JDmgPDQ6EhoKJD4sOgpWWgiwChyqEBH5hmptSoSOZgJ4kLKWkYTF7C2SaqaM/hEWygay4mYG8t6uffFuzl1iANCEAIfkECQcAEAAsAAAAABgAGAAABZ0gJI4khCBlmhKkopBCoI6LIozDMAIHO4uuBVBnOiR+I4FrCDwAZsKdQnaCLIwwmRUA8JmioprWUCjcwlwUMnAoG0qL03k2KCS8cC0UjOzDCQKBfHQFDAwFU4CCfgqFhy9+kZJWgzSKSAcPZn+BfQENDw8OljGWJAFeDoZPYTBnC1GdSXqnsoBolSulX2GyP6hgvnG0KrS3NJNhuSQhACH5BAkHABAALAAAAAAYABgAAAWaICSOJCQIZZoupGGQRKCOC0CMijIiwz2LABtQZxoMfjQhxAXszWQ7gOwECRhh0MCJJRJARTUoIHFAgbfI6uBwAJS01J/i4PClVYHvfV8lbLlIBmwFbQt+aGmChG18jXeGT4dICQxlb4g/AQUMDER9XjR6BAdiDQwINDBmkAsPDVh4cX4imw53iLKuaVqAcUsPqEiidkt6j4AzIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiREEGWaBiSCtCoZCMsIAKOg1LEo0KKbaKFQ9EYLoOkFuQlirNxzCQkUW9GZ0hQd4nyDAWr4G/esYSbyZFYZwu3jqiuvr8u8I2BwOAwASXh1e31/doeHC3klWnElfAlTd46MfQUGk2stCVEGBQWSdCciDg5VDAVYKoEiDQ0iBwxGcj9RDw8+qHIzebc2DJJQJK6qiKVyIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiS0LGWaBiRBtCoZCKgoCCMB1DF0sz6cCQDo5W62l28XAyZFpyECBv3lnCbhUqHMIo0Qg4Jbmn1jRCa4iV27TzfXGjEecOFWMN1OdvvfPGUuXSoKBw6EXokrAwcHRVU0UAeEBANAAAmUI1gNDyhjJgUHLW0iDg8FIqOnBQZrDA9TELE2rEYIDw4jta2LMpCrqld/YQpgIQAh+QQJBwAQACwAAAAAGAAYAAAFmyAkjiS0LGWaBiRBkKw6BgIqCsJcyyMe4yJajhcEml5H26o1PN2QQd3uFiv2AADlAgflIbDdZLgkABOJgep5LfWty4p4zeU+w+XsvJWXliEKDwdEBgMKYQ4PDw1qK3EDCCMAiQ5BCV0LCj+FSDQkgCgGBiYHAy2MIgoMghAHqw4HAGsNDEMFBTekdgwKI7aRB2MwkL2rVHoQoWchACH5BAkHABAALAAAAAAYABgAAAWWICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkfbqjU83ZBB3e4WK0qrCxyU55peid0qcUwuixyNx6PhILsAcAJazXYj4lvz2MkLiFsHDAlEcABKZwwMBX8pBgoKQxAIigpBA1sLBj+PSDQkB4uSACYDlTMyBgWDEKVnl2QFBUigN61gBQYjtLV5JZ4jtlR6omMhACH5BAkHABAALAAAAAAYABgAAAWaICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkdbidYanm7I4AjwYDh6saJuJ3JUG1mZi9srPA7EcRimJLrfJYWZUVC8TziXnEG3u/E+cIJaPAFrPQl1aQAIbRAGBZGHJQiMUQKRBkEKbQsAPZaEXQcslSYKmjMyAAdXj34ACkNEiUgDA5t+PAQHn6Ogjkuzry2DNwhuIQAh+QQFBwAQACwAAAAAGAAYAAAFnCAkjiS0LGVaBgBJEGSguo8zCsK4CPIsMg+ECCcKEH0ix6MwhJl4KiOp8UCdmrEbo6EoHpxF8A6aBBZ6vhf5dmAkkGr0CoWs21WGQ2FvsI9xC3l7B311fy93iWGKJQQOhHCAJQB6A3IqcWwJLU90i2FkUiMKlhBELEI6MwgDXRAGhQgAYD6tTqRFAJxpA6mvrqazSKJJhUWMpjlIIQA7) center no-repeat}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon.notVisible{background:none}[_nghost-%COMP%]     .pdfViewer.enablePermissions .textLayer span{-webkit-user-select:none!important;user-select:none!important;cursor:not-allowed}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer{padding-bottom:0}[_nghost-%COMP%]     .pdfPresentationMode .spread{margin:0}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer .page{margin:0 auto;border:2px solid transparent}']})}return PdfViewerComponent2})(),PdfViewerModule=(()=>{class PdfViewerModule2{static \u0275fac=function(t){return new(t||PdfViewerModule2)};static \u0275mod=core.oAB({type:PdfViewerModule2});static \u0275inj=core.cJS({})}return PdfViewerModule2})();var projects_service=__webpack_require__2(2278);const resume_component_c0=function(a0){return{activeItem:a0}};let ResumeComponent=(()=>{class ResumeComponent2{constructor(_viewportScroller){this._viewportScroller=_viewportScroller,this.page1=!0,this.page2=!1,this.currentPage=1,this.pdfSrc="../assets/Marwan_Abubakr_Resume.pdf"}pdfPagination(event,item){this.currentPage=event,this.toggleBullets(item),this._viewportScroller.scrollToPosition([0,0])}toggleBullets(word){this.page1="page1"===word,this.page2="page2"===word}static#_=this.\u0275fac=function(t){return new(t||ResumeComponent2)(core.Y36(common.EM))};static#_2=this.\u0275cmp=core.Xpm({type:ResumeComponent2,selectors:[["app-resume"]],standalone:!0,features:[core._Bn([projects_service.m]),core.jDz],decls:16,vars:15,consts:[[1,"resume","position-relative"],[1,"container","text-center"],["download","Marwan Abubakr FrontEnd Angular.pdf",1,"btn","main__btn","text-capitalize","text-white","mb-5",3,"href"],[1,"fa-solid","fa-download","px-1"],[1,"resume__pdf"],[1,"mb-5",3,"src","render-text","page","external-link-target","rotation","original-size","fit-to-page","show-all","autoresize","pageChange"],[1,"resume__bulets"],["bullets",""],[1,"mb-5","activeItem",3,"ngClass","click"],["target","_blank",1,"btn","main__btn","text-capitalize","text-white","mb-5",3,"href"],[1,"fa-solid","fa-print","px-1"]],template:function(rf,ctx){1&rf&&(core.TgZ(0,"section",0)(1,"div",1)(2,"a",2),core._UZ(3,"i",3),core.TgZ(4,"span"),core._uU(5,"download CV"),core.qZA()(),core.TgZ(6,"div",4)(7,"pdf-viewer",5),core.NdJ("pageChange",function($event){return ctx.currentPage=$event}),core.qZA(),core.TgZ(8,"div",6,7)(10,"span",8),core.NdJ("click",function(){return ctx.pdfPagination(1,"page1")}),core.qZA()(),core.TgZ(11,"a",9),core._UZ(12,"i",10),core.TgZ(13,"span"),core._uU(14,"print CV"),core.qZA()()()(),core._UZ(15,"app-canvase"),core.qZA()),2&rf&&(core.xp6(2),core.Q6J("href",ctx.pdfSrc,core.LSH),core.xp6(5),core.Q6J("src",ctx.pdfSrc)("render-text",!0)("page",ctx.currentPage)("external-link-target","blank")("render-text",!0)("rotation",90)("original-size",!1)("fit-to-page",!0)("show-all",!1)("autoresize",!0),core.xp6(3),core.Q6J("ngClass",core.VKq(13,resume_component_c0,ctx.page1)),core.xp6(1),core.Q6J("href",ctx.pdfSrc,core.LSH))},dependencies:[common.ez,common.mk,PdfViewerModule,PdfViewerComponent,canvase_component.z],styles:["section[_ngcontent-%COMP%]{padding-top:150px;padding-bottom:100px;background-color:#0f0b18}.main-fonts[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.projects__active[_ngcontent-%COMP%]{background-color:#171126}.resume[_ngcontent-%COMP%]{padding-bottom:0}@media (max-width: 576px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:55vh}}@media (min-width: 577px) and (max-width: 767px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:70vh}}@media (min-width: 768px) and (max-width: 992px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:85vh}}@media (min-width: 993px) and (max-width: 1199px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:130vh}}@media (min-width: 1200px) and (max-width: 1399px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:160vh}}@media (min-width: 1400px){.resume[_ngcontent-%COMP%]   pdf-viewer[_ngcontent-%COMP%]{height:155vh}}.resume__bulets[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;cursor:pointer;width:20px;height:20px;border-radius:50%;margin-left:5px;margin-right:5px;background-color:#c95bf5;gap:10px}.resume[_ngcontent-%COMP%]   .activeItem[_ngcontent-%COMP%]{background-color:#623686;border:2px solid #fff}"]})}return ResumeComponent2})()},405:(module,__unused_webpack_exports,__webpack_require__)=>{var _asyncToGenerator=__webpack_require__(7156).default,factory;globalThis,factory=()=>(()=>{"use strict";var __webpack_modules__=[,(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.VerbosityLevel=exports2.Util=exports2.UnknownErrorException=exports2.UnexpectedResponseException=exports2.UNSUPPORTED_FEATURES=exports2.TextRenderingMode=exports2.StreamType=exports2.RenderingIntentFlag=exports2.PermissionFlag=exports2.PasswordResponses=exports2.PasswordException=exports2.PageActionEventType=exports2.OPS=exports2.MissingPDFException=exports2.LINE_FACTOR=exports2.LINE_DESCENT_FACTOR=exports2.InvalidPDFException=exports2.ImageKind=exports2.IDENTITY_MATRIX=exports2.FormatError=exports2.FontType=exports2.FeatureTest=exports2.FONT_IDENTITY_MATRIX=exports2.DocumentActionEventType=exports2.CMapCompressionType=exports2.BaseException=exports2.AnnotationType=exports2.AnnotationStateModelType=exports2.AnnotationReviewState=exports2.AnnotationReplyType=exports2.AnnotationMode=exports2.AnnotationMarkedState=exports2.AnnotationFlag=exports2.AnnotationFieldFlag=exports2.AnnotationEditorType=exports2.AnnotationEditorPrefix=exports2.AnnotationEditorParamsType=exports2.AnnotationBorderStyleType=exports2.AnnotationActionEventType=exports2.AbortException=void 0,exports2.arrayByteLength=arrayByteLength,exports2.arraysToBytes=function arraysToBytes(arr){const length=arr.length;if(1===length&&arr[0]instanceof Uint8Array)return arr[0];let resultLength=0;for(let i=0;i<length;i++)resultLength+=arrayByteLength(arr[i]);let pos=0;const data=new Uint8Array(resultLength);for(let i=0;i<length;i++){let item=arr[i];item instanceof Uint8Array||(item="string"==typeof item?stringToBytes(item):new Uint8Array(item));const itemLength=item.byteLength;data.set(item,pos),pos+=itemLength}return data},exports2.assert=function assert(cond,msg){cond||unreachable(msg)},exports2.bytesToString=function bytesToString(bytes){("object"!=typeof bytes||null===bytes||void 0===bytes.length)&&unreachable("Invalid argument for bytesToString");const length=bytes.length;if(length<8192)return String.fromCharCode.apply(null,bytes);const strBuf=[];for(let i=0;i<length;i+=8192){const chunkEnd=Math.min(i+8192,length),chunk=bytes.subarray(i,chunkEnd);strBuf.push(String.fromCharCode.apply(null,chunk))}return strBuf.join("")},exports2.createPromiseCapability=function createPromiseCapability(){const capability=Object.create(null);let isSettled=!1;return Object.defineProperty(capability,"settled",{get:()=>isSettled}),capability.promise=new Promise(function(resolve,reject){capability.resolve=function(data){isSettled=!0,resolve(data)},capability.reject=function(reason){isSettled=!0,reject(reason)}}),capability},exports2.createValidAbsoluteUrl=function createValidAbsoluteUrl(url,baseUrl=null,options=null){if(!url)return null;try{if(options&&"string"==typeof url){if(options.addDefaultProtocol&&url.startsWith("www.")){const dots=url.match(/\./g);dots&&dots.length>=2&&(url=`http://${url}`)}if(options.tryConvertEncoding)try{url=stringToUTF8String(url)}catch{}}const absoluteUrl=baseUrl?new URL(url,baseUrl):new URL(url);if(function _isValidProtocol(url){if(!url)return!1;switch(url.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(absoluteUrl))return absoluteUrl}catch{}return null},exports2.escapeString=function escapeString(str){return str.replace(/([()\\\n\r])/g,match=>"\n"===match?"\\n":"\r"===match?"\\r":`\\${match}`)},exports2.getModificationDate=function getModificationDate(date=new Date){return[date.getUTCFullYear().toString(),(date.getUTCMonth()+1).toString().padStart(2,"0"),date.getUTCDate().toString().padStart(2,"0"),date.getUTCHours().toString().padStart(2,"0"),date.getUTCMinutes().toString().padStart(2,"0"),date.getUTCSeconds().toString().padStart(2,"0")].join("")},exports2.getVerbosityLevel=function getVerbosityLevel(){return verbosity},exports2.info=function info(msg){verbosity>=VerbosityLevel.INFOS&&console.log(`Info: ${msg}`)},exports2.isArrayBuffer=function isArrayBuffer(v){return"object"==typeof v&&null!==v&&void 0!==v.byteLength},exports2.isArrayEqual=function isArrayEqual(arr1,arr2){if(arr1.length!==arr2.length)return!1;for(let i=0,ii=arr1.length;i<ii;i++)if(arr1[i]!==arr2[i])return!1;return!0},exports2.isAscii=function isAscii(str){return/^[\x00-\x7F]*$/.test(str)},exports2.objectFromMap=function objectFromMap(map){const obj=Object.create(null);for(const[key,value]of map)obj[key]=value;return obj},exports2.objectSize=function objectSize(obj){return Object.keys(obj).length},exports2.setVerbosityLevel=function setVerbosityLevel(level){Number.isInteger(level)&&(verbosity=level)},exports2.shadow=shadow,exports2.string32=function string32(value){return String.fromCharCode(value>>24&255,value>>16&255,value>>8&255,255&value)},exports2.stringToBytes=stringToBytes,exports2.stringToPDFString=function stringToPDFString(str){if(str[0]>="\xef"){let encoding;if("\xfe"===str[0]&&"\xff"===str[1]?encoding="utf-16be":"\xff"===str[0]&&"\xfe"===str[1]?encoding="utf-16le":"\xef"===str[0]&&"\xbb"===str[1]&&"\xbf"===str[2]&&(encoding="utf-8"),encoding)try{const decoder=new TextDecoder(encoding,{fatal:!0}),buffer=stringToBytes(str);return decoder.decode(buffer)}catch(ex){warn(`stringToPDFString: "${ex}".`)}}const strBuf=[];for(let i=0,ii=str.length;i<ii;i++){const code=PDFStringTranslateTable[str.charCodeAt(i)];strBuf.push(code?String.fromCharCode(code):str.charAt(i))}return strBuf.join("")},exports2.stringToUTF16BEString=function stringToUTF16BEString(str){const buf=["\xfe\xff"];for(let i=0,ii=str.length;i<ii;i++){const char=str.charCodeAt(i);buf.push(String.fromCharCode(char>>8&255),String.fromCharCode(255&char))}return buf.join("")},exports2.stringToUTF8String=stringToUTF8String,exports2.unreachable=unreachable,exports2.utf8StringToString=function utf8StringToString(str){return unescape(encodeURIComponent(str))},exports2.warn=warn,__w_pdfjs_require__2(2),exports2.IDENTITY_MATRIX=[1,0,0,1,0,0],exports2.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],exports2.LINE_FACTOR=1.35,exports2.LINE_DESCENT_FACTOR=.35,exports2.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},exports2.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},exports2.AnnotationEditorPrefix="pdfjs_internal_editor_",exports2.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},exports2.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},exports2.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},exports2.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},exports2.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},exports2.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},exports2.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},exports2.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},exports2.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},exports2.AnnotationReplyType={GROUP:"Group",REPLY:"R"},exports2.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},exports2.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},exports2.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},exports2.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},exports2.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},exports2.PageActionEventType={O:"PageOpen",C:"PageClose"},exports2.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},exports2.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const VerbosityLevel={ERRORS:0,WARNINGS:1,INFOS:5};exports2.VerbosityLevel=VerbosityLevel,exports2.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},exports2.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},exports2.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},exports2.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let verbosity=VerbosityLevel.WARNINGS;function warn(msg){verbosity>=VerbosityLevel.WARNINGS&&console.log(`Warning: ${msg}`)}function unreachable(msg){throw new Error(msg)}function shadow(obj,prop,value){return Object.defineProperty(obj,prop,{value,enumerable:!0,configurable:!0,writable:!1}),value}const BaseException=function(){function BaseException2(message,name){this.constructor===BaseException2&&unreachable("Cannot initialize BaseException."),this.message=message,this.name=name}return BaseException2.prototype=new Error,BaseException2.constructor=BaseException2,BaseException2}();function stringToBytes(str){"string"!=typeof str&&unreachable("Invalid argument for stringToBytes");const length=str.length,bytes=new Uint8Array(length);for(let i=0;i<length;++i)bytes[i]=255&str.charCodeAt(i);return bytes}function arrayByteLength(arr){return void 0!==arr.length?arr.length:void 0!==arr.byteLength?arr.byteLength:void unreachable("Invalid argument for arrayByteLength")}exports2.BaseException=BaseException,exports2.PasswordException=class PasswordException extends BaseException{constructor(msg,code){super(msg,"PasswordException"),this.code=code}},exports2.UnknownErrorException=class UnknownErrorException extends BaseException{constructor(msg,details){super(msg,"UnknownErrorException"),this.details=details}},exports2.InvalidPDFException=class InvalidPDFException extends BaseException{constructor(msg){super(msg,"InvalidPDFException")}},exports2.MissingPDFException=class MissingPDFException extends BaseException{constructor(msg){super(msg,"MissingPDFException")}},exports2.UnexpectedResponseException=class UnexpectedResponseException extends BaseException{constructor(msg,status){super(msg,"UnexpectedResponseException"),this.status=status}},exports2.FormatError=class FormatError extends BaseException{constructor(msg){super(msg,"FormatError")}},exports2.AbortException=class AbortException extends BaseException{constructor(msg){super(msg,"AbortException")}},exports2.FeatureTest=class FeatureTest{static get isLittleEndian(){return shadow(this,"isLittleEndian",function isLittleEndian(){const buffer8=new Uint8Array(4);return buffer8[0]=1,1===new Uint32Array(buffer8.buffer,0,1)[0]}())}static get isEvalSupported(){return shadow(this,"isEvalSupported",function isEvalSupported(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return shadow(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}};const hexNumbers=[...Array(256).keys()].map(n=>n.toString(16).padStart(2,"0"));class Util{static makeHexColor(r,g,b){return`#${hexNumbers[r]}${hexNumbers[g]}${hexNumbers[b]}`}static scaleMinMax(transform,minMax){let temp;transform[0]?(transform[0]<0&&(temp=minMax[0],minMax[0]=minMax[1],minMax[1]=temp),minMax[0]*=transform[0],minMax[1]*=transform[0],transform[3]<0&&(temp=minMax[2],minMax[2]=minMax[3],minMax[3]=temp),minMax[2]*=transform[3],minMax[3]*=transform[3]):(temp=minMax[0],minMax[0]=minMax[2],minMax[2]=temp,temp=minMax[1],minMax[1]=minMax[3],minMax[3]=temp,transform[1]<0&&(temp=minMax[2],minMax[2]=minMax[3],minMax[3]=temp),minMax[2]*=transform[1],minMax[3]*=transform[1],transform[2]<0&&(temp=minMax[0],minMax[0]=minMax[1],minMax[1]=temp),minMax[0]*=transform[2],minMax[1]*=transform[2]),minMax[0]+=transform[4],minMax[1]+=transform[4],minMax[2]+=transform[5],minMax[3]+=transform[5]}static transform(m1,m2){return[m1[0]*m2[0]+m1[2]*m2[1],m1[1]*m2[0]+m1[3]*m2[1],m1[0]*m2[2]+m1[2]*m2[3],m1[1]*m2[2]+m1[3]*m2[3],m1[0]*m2[4]+m1[2]*m2[5]+m1[4],m1[1]*m2[4]+m1[3]*m2[5]+m1[5]]}static applyTransform(p,m){return[p[0]*m[0]+p[1]*m[2]+m[4],p[0]*m[1]+p[1]*m[3]+m[5]]}static applyInverseTransform(p,m){const d=m[0]*m[3]-m[1]*m[2];return[(p[0]*m[3]-p[1]*m[2]+m[2]*m[5]-m[4]*m[3])/d,(-p[0]*m[1]+p[1]*m[0]+m[4]*m[1]-m[5]*m[0])/d]}static getAxialAlignedBoundingBox(r,m){const p1=Util.applyTransform(r,m),p2=Util.applyTransform(r.slice(2,4),m),p3=Util.applyTransform([r[0],r[3]],m),p4=Util.applyTransform([r[2],r[1]],m);return[Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1])]}static inverseTransform(m){const d=m[0]*m[3]-m[1]*m[2];return[m[3]/d,-m[1]/d,-m[2]/d,m[0]/d,(m[2]*m[5]-m[4]*m[3])/d,(m[4]*m[1]-m[5]*m[0])/d]}static apply3dTransform(m,v){return[m[0]*v[0]+m[1]*v[1]+m[2]*v[2],m[3]*v[0]+m[4]*v[1]+m[5]*v[2],m[6]*v[0]+m[7]*v[1]+m[8]*v[2]]}static singularValueDecompose2dScale(m){const transpose=[m[0],m[2],m[1],m[3]],a=m[0]*transpose[0]+m[1]*transpose[2],d=m[2]*transpose[1]+m[3]*transpose[3],first=(a+d)/2,second=Math.sqrt((a+d)**2-4*(a*d-(m[2]*transpose[0]+m[3]*transpose[2])*(m[0]*transpose[1]+m[1]*transpose[3])))/2,sy=first-second||1;return[Math.sqrt(first+second||1),Math.sqrt(sy)]}static normalizeRect(rect){const r=rect.slice(0);return rect[0]>rect[2]&&(r[0]=rect[2],r[2]=rect[0]),rect[1]>rect[3]&&(r[1]=rect[3],r[3]=rect[1]),r}static intersect(rect1,rect2){const xLow=Math.max(Math.min(rect1[0],rect1[2]),Math.min(rect2[0],rect2[2])),xHigh=Math.min(Math.max(rect1[0],rect1[2]),Math.max(rect2[0],rect2[2]));if(xLow>xHigh)return null;const yLow=Math.max(Math.min(rect1[1],rect1[3]),Math.min(rect2[1],rect2[3])),yHigh=Math.min(Math.max(rect1[1],rect1[3]),Math.max(rect2[1],rect2[3]));return yLow>yHigh?null:[xLow,yLow,xHigh,yHigh]}static bezierBoundingBox(x0,y0,x1,y1,x2,y2,x3,y3){const tvalues=[],bounds=[[],[]];let a,b,c,t,t1,t2,b2ac,sqrtb2ac;for(let i=0;i<2;++i)if(0===i?(b=6*x0-12*x1+6*x2,a=-3*x0+9*x1-9*x2+3*x3,c=3*x1-3*x0):(b=6*y0-12*y1+6*y2,a=-3*y0+9*y1-9*y2+3*y3,c=3*y1-3*y0),Math.abs(a)<1e-12){if(Math.abs(b)<1e-12)continue;t=-c/b,0<t&&t<1&&tvalues.push(t)}else b2ac=b*b-4*c*a,sqrtb2ac=Math.sqrt(b2ac),!(b2ac<0)&&(t1=(-b+sqrtb2ac)/(2*a),0<t1&&t1<1&&tvalues.push(t1),t2=(-b-sqrtb2ac)/(2*a),0<t2&&t2<1&&tvalues.push(t2));let mt,j=tvalues.length;const jlen=j;for(;j--;)t=tvalues[j],mt=1-t,bounds[0][j]=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3,bounds[1][j]=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3;return bounds[0][jlen]=x0,bounds[1][jlen]=y0,bounds[0][jlen+1]=x3,bounds[1][jlen+1]=y3,bounds[0].length=bounds[1].length=jlen+2,[Math.min(...bounds[0]),Math.min(...bounds[1]),Math.max(...bounds[0]),Math.max(...bounds[1])]}}exports2.Util=Util;const PDFStringTranslateTable=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToUTF8String(str){return decodeURIComponent(escape(str))}},(__unused_webpack_module2,__unused_webpack_exports2,__w_pdfjs_require__2)=>{__w_pdfjs_require__2(3)},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.isNodeJS=void 0;const isNodeJS=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);exports2.isNodeJS=isNodeJS},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory,NodeCMapReaderFactory,NodeStandardFontDataFactory}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=NodeCanvasFactory,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=NodeCMapReaderFactory,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=NodeStandardFontDataFactory}function setPDFNetworkStreamFactory(pdfNetworkStreamFactory){createPDFNetworkStream=pdfNetworkStreamFactory}function getDocument(src){const task=new PDFDocumentLoadingTask;let source;if("string"==typeof src||src instanceof URL)source={url:src};else if((0,_util.isArrayBuffer)(src))source={data:src};else if(src instanceof PDFDataRangeTransport)source={range:src};else{if("object"!=typeof src)throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!src.url&&!src.data&&!src.range)throw new Error("Invalid parameter object: need either .data, .range or .url");source=src}const params=Object.create(null);let rangeTransport=null,worker2=null;for(const key in source){const value=source[key];switch(key){case"url":if(typeof window<"u")try{params[key]=new URL(value,window.location).href;continue}catch(ex){(0,_util.warn)(`Cannot create valid URL: "${ex}".`)}else if("string"==typeof value||value instanceof URL){params[key]=value.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":rangeTransport=value;continue;case"worker":worker2=value;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&value instanceof Buffer)params[key]=new Uint8Array(value);else{if(value instanceof Uint8Array)break;if("string"==typeof value)params[key]=(0,_util.stringToBytes)(value);else if("object"!=typeof value||null===value||isNaN(value.length)){if(!(0,_util.isArrayBuffer)(value))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");params[key]=new Uint8Array(value)}else params[key]=new Uint8Array(value)}continue}params[key]=value}if(params.CMapReaderFactory=params.CMapReaderFactory||DefaultCMapReaderFactory,params.StandardFontDataFactory=params.StandardFontDataFactory||DefaultStandardFontDataFactory,params.ignoreErrors=!0!==params.stopAtErrors,params.fontExtraProperties=!0===params.fontExtraProperties,params.pdfBug=!0===params.pdfBug,params.enableXfa=!0===params.enableXfa,(!Number.isInteger(params.rangeChunkSize)||params.rangeChunkSize<1)&&(params.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof params.docBaseUrl||(0,_display_utils.isDataScheme)(params.docBaseUrl))&&(params.docBaseUrl=null),(!Number.isInteger(params.maxImageSize)||params.maxImageSize<-1)&&(params.maxImageSize=-1),"string"!=typeof params.cMapUrl&&(params.cMapUrl=null),"string"!=typeof params.standardFontDataUrl&&(params.standardFontDataUrl=null),"boolean"!=typeof params.useWorkerFetch&&(params.useWorkerFetch=params.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&params.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof params.isEvalSupported&&(params.isEvalSupported=!0),"boolean"!=typeof params.disableFontFace&&(params.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof params.useSystemFonts&&(params.useSystemFonts=!_is_node.isNodeJS&&!params.disableFontFace),("object"!=typeof params.ownerDocument||null===params.ownerDocument)&&(params.ownerDocument=globalThis.document),"boolean"!=typeof params.disableRange&&(params.disableRange=!1),"boolean"!=typeof params.disableStream&&(params.disableStream=!1),"boolean"!=typeof params.disableAutoFetch&&(params.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(params.verbosity),!worker2){const workerParams={verbosity:params.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};worker2=workerParams.port?PDFWorker.fromPort(workerParams):new PDFWorker(workerParams),task._worker=worker2}const docId=task.docId;return worker2.promise.then(function(){if(task.destroyed)throw new Error("Loading aborted");const workerIdPromise=_fetchDocument(worker2,params,rangeTransport,docId),networkStreamPromise=new Promise(function(resolve){let networkStream;rangeTransport?networkStream=new _transport_stream.PDFDataTransportStream({length:params.length,initialData:params.initialData,progressiveDone:params.progressiveDone,contentDispositionFilename:params.contentDispositionFilename,disableRange:params.disableRange,disableStream:params.disableStream},rangeTransport):params.data||(networkStream=createPDFNetworkStream({url:params.url,length:params.length,httpHeaders:params.httpHeaders,withCredentials:params.withCredentials,rangeChunkSize:params.rangeChunkSize,disableRange:params.disableRange,disableStream:params.disableStream})),resolve(networkStream)});return Promise.all([workerIdPromise,networkStreamPromise]).then(function([workerId,networkStream]){if(task.destroyed)throw new Error("Loading aborted");const messageHandler=new _message_handler.MessageHandler(docId,workerId,worker2.port),transport=new WorkerTransport(messageHandler,task,networkStream,params);task._transport=transport,messageHandler.send("Ready",null)})}).catch(task._capability.reject),task}function _fetchDocument(_x,_x2,_x3,_x4){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(function*(worker2,source,pdfDataRangeTransport,docId){if(worker2.destroyed)throw new Error("Worker was destroyed");pdfDataRangeTransport&&(source.length=pdfDataRangeTransport.length,source.initialData=pdfDataRangeTransport.initialData,source.progressiveDone=pdfDataRangeTransport.progressiveDone,source.contentDispositionFilename=pdfDataRangeTransport.contentDispositionFilename);const workerId=yield worker2.messageHandler.sendWithPromise("GetDocRequest",{docId,apiVersion:"2.16.105",source:{data:source.data,url:source.url,password:source.password,disableAutoFetch:source.disableAutoFetch,rangeChunkSize:source.rangeChunkSize,length:source.length},maxImageSize:source.maxImageSize,disableFontFace:source.disableFontFace,docBaseUrl:source.docBaseUrl,ignoreErrors:source.ignoreErrors,isEvalSupported:source.isEvalSupported,fontExtraProperties:source.fontExtraProperties,enableXfa:source.enableXfa,useSystemFonts:source.useSystemFonts,cMapUrl:source.useWorkerFetch?source.cMapUrl:null,standardFontDataUrl:source.useWorkerFetch?source.standardFontDataUrl:null});if(source.data&&(source.data=null),worker2.destroyed)throw new Error("Worker was destroyed");return workerId})).apply(this,arguments)}class PDFDocumentLoadingTask{static#docId=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#docId++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){var _this=this;return _asyncToGenerator(function*(){_this.destroyed=!0,yield _this._transport?.destroy(),_this._transport=null,_this._worker&&(_this._worker.destroy(),_this._worker=null)})()}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(length,initialData,progressiveDone=!1,contentDispositionFilename=null){this.length=length,this.initialData=initialData,this.progressiveDone=progressiveDone,this.contentDispositionFilename=contentDispositionFilename,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(listener){this._rangeListeners.push(listener)}addProgressListener(listener){this._progressListeners.push(listener)}addProgressiveReadListener(listener){this._progressiveReadListeners.push(listener)}addProgressiveDoneListener(listener){this._progressiveDoneListeners.push(listener)}onDataRange(begin,chunk){for(const listener of this._rangeListeners)listener(begin,chunk)}onDataProgress(loaded,total){this._readyCapability.promise.then(()=>{for(const listener of this._progressListeners)listener(loaded,total)})}onDataProgressiveRead(chunk){this._readyCapability.promise.then(()=>{for(const listener of this._progressiveReadListeners)listener(chunk)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const listener of this._progressiveDoneListeners)listener()})}transportReady(){this._readyCapability.resolve()}requestDataRange(begin,end){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(pdfInfo,transport){var _ref,_this2=this;this._pdfInfo=pdfInfo,this._transport=transport,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:(_ref=_asyncToGenerator(function*(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),_this2.stats||{streamTypes:{},fontTypes:{}}}),function(){return _ref.apply(this,arguments)})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(pageNumber){return this._transport.getPage(pageNumber)}getPageIndex(ref){return this._transport.getPageIndex(ref)}getDestinations(){return this._transport.getDestinations()}getDestination(id){return this._transport.getDestination(id)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(keepLoadedFonts=!1){return this._transport.startCleanup(keepLoadedFonts||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(pageIndex,pageInfo,transport,ownerDocument,pdfBug=!1){this._pageIndex=pageIndex,this._pageInfo=pageInfo,this._ownerDocument=ownerDocument,this._transport=transport,this._stats=pdfBug?new _display_utils.StatTimer:null,this._pdfBug=pdfBug,this.commonObjs=transport.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale,rotation=this.rotate,offsetX=0,offsetY=0,dontFlip=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale,rotation,offsetX,offsetY,dontFlip})}getAnnotations({intent="display"}={}){const intentArgs=this._transport.getRenderingIntent(intent);let promise=this._annotationPromises.get(intentArgs.cacheKey);return promise||(promise=this._transport.getAnnotations(this._pageIndex,intentArgs.renderingIntent),this._annotationPromises.set(intentArgs.cacheKey,promise),promise=promise.then(annotations=>{for(const annotation of annotations)void 0!==annotation.titleObj&&Object.defineProperty(annotation,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),annotation.titleObj.str)}),void 0!==annotation.contentsObj&&Object.defineProperty(annotation,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),annotation.contentsObj.str)});return annotations})),promise}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}getXfa(){var _this3=this;return _asyncToGenerator(function*(){return _this3._transport._htmlForXfa?.children[_this3._pageIndex]||null})()}render({canvasContext,viewport,intent="display",annotationMode=_util.AnnotationMode.ENABLE,transform=null,imageLayer=null,canvasFactory=null,background=null,optionalContentConfigPromise=null,annotationCanvasMap=null,pageColors=null,printAnnotationStorage=null}){void 0!==arguments[0]?.renderInteractiveForms&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&annotationMode===_util.AnnotationMode.ENABLE&&(annotationMode=_util.AnnotationMode.ENABLE_FORMS)),void 0!==arguments[0]?.includeAnnotationStorage&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&annotationMode===_util.AnnotationMode.ENABLE&&(annotationMode=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const intentArgs=this._transport.getRenderingIntent(intent,annotationMode,printAnnotationStorage);this.pendingCleanup=!1,optionalContentConfigPromise||(optionalContentConfigPromise=this._transport.getOptionalContentConfig());let intentState=this._intentStates.get(intentArgs.cacheKey);intentState||(intentState=Object.create(null),this._intentStates.set(intentArgs.cacheKey,intentState)),intentState.streamReaderCancelTimeout&&(clearTimeout(intentState.streamReaderCancelTimeout),intentState.streamReaderCancelTimeout=null);const canvasFactoryInstance=canvasFactory||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),intentPrint=!!(intentArgs.renderingIntent&_util.RenderingIntentFlag.PRINT);intentState.displayReadyCapability||(intentState.displayReadyCapability=(0,_util.createPromiseCapability)(),intentState.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(intentArgs));const complete=error=>{intentState.renderTasks.delete(internalRenderTask),(this.cleanupAfterRender||intentPrint)&&(this.pendingCleanup=!0),this._tryCleanup(),error?(internalRenderTask.capability.reject(error),this._abortOperatorList({intentState,reason:error instanceof Error?error:new Error(error)})):internalRenderTask.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},internalRenderTask=new InternalRenderTask({callback:complete,params:{canvasContext,viewport,transform,imageLayer,background},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap,operatorList:intentState.operatorList,pageIndex:this._pageIndex,canvasFactory:canvasFactoryInstance,useRequestAnimationFrame:!intentPrint,pdfBug:this._pdfBug,pageColors});(intentState.renderTasks||=new Set).add(internalRenderTask);const renderTask=internalRenderTask.task;return Promise.all([intentState.displayReadyCapability.promise,optionalContentConfigPromise]).then(([transparency,optionalContentConfig])=>{this.pendingCleanup?complete():(this._stats&&this._stats.time("Rendering"),internalRenderTask.initializeGraphics({transparency,optionalContentConfig}),internalRenderTask.operatorListChanged())}).catch(complete),renderTask}getOperatorList({intent="display",annotationMode=_util.AnnotationMode.ENABLE,printAnnotationStorage=null}={}){const intentArgs=this._transport.getRenderingIntent(intent,annotationMode,printAnnotationStorage,!0);let opListTask,intentState=this._intentStates.get(intentArgs.cacheKey);return intentState||(intentState=Object.create(null),this._intentStates.set(intentArgs.cacheKey,intentState)),intentState.opListReadCapability||(opListTask=Object.create(null),opListTask.operatorListChanged=function operatorListChanged(){intentState.operatorList.lastChunk&&(intentState.opListReadCapability.resolve(intentState.operatorList),intentState.renderTasks.delete(opListTask))},intentState.opListReadCapability=(0,_util.createPromiseCapability)(),(intentState.renderTasks||=new Set).add(opListTask),intentState.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(intentArgs)),intentState.opListReadCapability.promise}streamTextContent({disableCombineTextItems=!1,includeMarkedContent=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==disableCombineTextItems,includeMarkedContent:!0===includeMarkedContent},{highWaterMark:100,size:textContent=>textContent.items.length})}getTextContent(params={}){if(this._transport._htmlForXfa)return this.getXfa().then(xfa=>_xfa_text.XfaText.textContent(xfa));const readableStream=this.streamTextContent(params);return new Promise(function(resolve,reject){const reader=readableStream.getReader(),textContent={items:[],styles:Object.create(null)};!function pump(){reader.read().then(function({value,done}){done?resolve(textContent):(Object.assign(textContent.styles,value.styles),textContent.items.push(...value.items),pump())},reject)}()})}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const waitOn=[];for(const intentState of this._intentStates.values())if(this._abortOperatorList({intentState,reason:new Error("Page was destroyed."),force:!0}),!intentState.opListReadCapability)for(const internalRenderTask of intentState.renderTasks)waitOn.push(internalRenderTask.completed),internalRenderTask.cancel();this.objs.clear();for(const bitmap of this._bitmaps)bitmap.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(waitOn)}cleanup(resetStats=!1){return this.pendingCleanup=!0,this._tryCleanup(resetStats)}_tryCleanup(resetStats=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks,operatorList}of this._intentStates.values())if(renderTasks.size>0||!operatorList.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,resetStats&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const bitmap of this._bitmaps)bitmap.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(transparency,cacheKey){const intentState=this._intentStates.get(cacheKey);intentState&&(this._stats&&this._stats.timeEnd("Page Request"),intentState.displayReadyCapability&&intentState.displayReadyCapability.resolve(transparency))}_renderPageChunk(operatorListChunk,intentState){for(let i=0,ii=operatorListChunk.length;i<ii;i++)intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]),intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);intentState.operatorList.lastChunk=operatorListChunk.lastChunk,intentState.operatorList.separateAnnots=operatorListChunk.separateAnnots;for(const internalRenderTask of intentState.renderTasks)internalRenderTask.operatorListChanged();operatorListChunk.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent,cacheKey,annotationStorageMap}){const reader=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:renderingIntent,cacheKey,annotationStorage:annotationStorageMap}).getReader(),intentState=this._intentStates.get(cacheKey);intentState.streamReader=reader;const pump=()=>{reader.read().then(({value,done})=>{done?intentState.streamReader=null:this._transport.destroyed||(this._renderPageChunk(value,intentState),pump())},reason=>{if(intentState.streamReader=null,!this._transport.destroyed){if(intentState.operatorList){intentState.operatorList.lastChunk=!0;for(const internalRenderTask of intentState.renderTasks)internalRenderTask.operatorListChanged();this._tryCleanup()}if(intentState.displayReadyCapability)intentState.displayReadyCapability.reject(reason);else{if(!intentState.opListReadCapability)throw reason;intentState.opListReadCapability.reject(reason)}}})};pump()}_abortOperatorList({intentState,reason,force=!1}){if(intentState.streamReader){if(!force){if(intentState.renderTasks.size>0)return;if(reason instanceof _display_utils.RenderingCancelledException)return void(intentState.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState,reason,force:!0}),intentState.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(intentState.streamReader.cancel(new _util.AbortException(reason.message)).catch(()=>{}),intentState.streamReader=null,!this._transport.destroyed){for(const[curCacheKey,curIntentState]of this._intentStates)if(curIntentState===intentState){this._intentStates.delete(curCacheKey);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(obj,transfers){const event={data:structuredClone(obj,transfers)};this._deferred.then(()=>{for(const listener of this._listeners)listener.call(this,event)})}addEventListener(name,listener){this._listeners.push(listener)}removeEventListener(name,listener){const i=this._listeners.indexOf(listener);this._listeners.splice(i,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const pdfjsFilePath=document?.currentScript?.src;pdfjsFilePath&&(PDFWorkerUtil.fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(baseUrl,otherUrl){let base;try{if(base=new URL(baseUrl),!base.origin||"null"===base.origin)return!1}catch{return!1}const other=new URL(otherUrl,base);return base.origin===other.origin},PDFWorkerUtil.createCDNWrapper=function(url){return URL.createObjectURL(new Blob([`importScripts("${url}");`]))};class PDFWorker{static#workerPorts=new WeakMap;constructor({name=null,port=null,verbosity=(0,_util.getVerbosityLevel)()}={}){if(port&&PDFWorker.#workerPorts.has(port))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=name,this.destroyed=!1,this.verbosity=verbosity,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,port)return PDFWorker.#workerPorts.set(port,this),void this._initializeFromPort(port);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(port){this._port=port,this._messageHandler=new _message_handler.MessageHandler("main","worker",port),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,workerSrc)||(workerSrc=PDFWorkerUtil.createCDNWrapper(new URL(workerSrc,window.location).href));const worker2=new Worker(workerSrc),messageHandler=new _message_handler.MessageHandler("main","worker",worker2),terminateEarly=()=>{worker2.removeEventListener("error",onWorkerError),messageHandler.destroy(),worker2.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},onWorkerError=()=>{this._webWorker||terminateEarly()};worker2.addEventListener("error",onWorkerError),messageHandler.on("test",data=>{worker2.removeEventListener("error",onWorkerError),this.destroyed?terminateEarly():data?(this._messageHandler=messageHandler,this._port=worker2,this._webWorker=worker2,this._readyCapability.resolve(),messageHandler.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),messageHandler.destroy(),worker2.terminate())}),messageHandler.on("ready",data=>{if(worker2.removeEventListener("error",onWorkerError),this.destroyed)terminateEarly();else try{sendTest()}catch{this._setupFakeWorker()}});const sendTest=()=>{const testObj=new Uint8Array;messageHandler.send("test",testObj,[testObj.buffer])};return void sendTest()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(WorkerMessageHandler=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const port=new LoopbackPort;this._port=port;const id="fake"+PDFWorkerUtil.fakeWorkerId++,workerHandler=new _message_handler.MessageHandler(id+"_worker",id,port);WorkerMessageHandler.setup(workerHandler,port);const messageHandler=new _message_handler.MessageHandler(id,id+"_worker",port);this._messageHandler=messageHandler,this._readyCapability.resolve(),messageHandler.send("configure",{verbosity:this.verbosity})}).catch(reason=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${reason.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(params){if(!params?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#workerPorts.has(params.port)?this.#workerPorts.get(params.port):new PDFWorker(params)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){var _this4=this;const loader=function(){var _ref2=_asyncToGenerator(function*(){const mainWorkerMessageHandler=_this4._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(_this4.workerSrc);return worker.WorkerMessageHandler}return yield(0,_display_utils.loadScript)(_this4.workerSrc),window.pdfjsWorker.WorkerMessageHandler});return function loader2(){return _ref2.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#docStats=null;#pageCache=new Map;#pagePromises=new Map;#metadataPromise=null;constructor(messageHandler,loadingTask,networkStream,params){this.messageHandler=messageHandler,this.loadingTask=loadingTask,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:loadingTask.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:params.ownerDocument,styleElement:params.styleElement}),this._params=params,params.useWorkerFetch||(this.CMapReaderFactory=new params.CMapReaderFactory({baseUrl:params.cMapUrl,isCompressed:params.cMapPacked}),this.StandardFontDataFactory=new params.StandardFontDataFactory({baseUrl:params.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=networkStream,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#docStats}getRenderingIntent(intent,annotationMode=_util.AnnotationMode.ENABLE,printAnnotationStorage=null,isOpList=!1){let renderingIntent=_util.RenderingIntentFlag.DISPLAY,annotationMap=null;switch(intent){case"any":renderingIntent=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":renderingIntent=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${intent}`)}switch(annotationMode){case _util.AnnotationMode.DISABLE:renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,annotationMap=(renderingIntent&_util.RenderingIntentFlag.PRINT&&printAnnotationStorage instanceof _annotation_storage.PrintAnnotationStorage?printAnnotationStorage:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${annotationMode}`)}return isOpList&&(renderingIntent+=_util.RenderingIntentFlag.OPLIST),{renderingIntent,cacheKey:`${renderingIntent}_${_annotation_storage.AnnotationStorage.getHash(annotationMap)}`,annotationStorageMap:annotationMap}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const waitOn=[];for(const page of this.#pageCache.values())waitOn.push(page._destroy());this.#pageCache.clear(),this.#pagePromises.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const terminated=this.messageHandler.sendWithPromise("Terminate",null);return waitOn.push(terminated),Promise.all(waitOn).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#metadataPromise=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler,loadingTask}=this;messageHandler.on("GetReader",(data,sink)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=evt=>{this._lastProgress={loaded:evt.loaded,total:evt.total}},sink.onPull=()=>{this._fullReader.read().then(function({value,done}){done?sink.close():((0,_util.assert)((0,_util.isArrayBuffer)(value),"GetReader - expected an ArrayBuffer."),sink.enqueue(new Uint8Array(value),1,[value]))}).catch(reason=>{sink.error(reason)})},sink.onCancel=reason=>{this._fullReader.cancel(reason),sink.ready.catch(readyReason=>{if(!this.destroyed)throw readyReason})}}),messageHandler.on("ReaderHeadersReady",data=>{const headersCapability=(0,_util.createPromiseCapability)(),fullReader=this._fullReader;return fullReader.headersReady.then(()=>{(!fullReader.isStreamingSupported||!fullReader.isRangeSupported)&&(this._lastProgress&&loadingTask.onProgress?.(this._lastProgress),fullReader.onProgress=evt=>{loadingTask.onProgress?.({loaded:evt.loaded,total:evt.total})}),headersCapability.resolve({isStreamingSupported:fullReader.isStreamingSupported,isRangeSupported:fullReader.isRangeSupported,contentLength:fullReader.contentLength})},headersCapability.reject),headersCapability.promise}),messageHandler.on("GetRangeReader",(data,sink)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const rangeReader=this._networkStream.getRangeReader(data.begin,data.end);rangeReader?(sink.onPull=()=>{rangeReader.read().then(function({value,done}){done?sink.close():((0,_util.assert)((0,_util.isArrayBuffer)(value),"GetRangeReader - expected an ArrayBuffer."),sink.enqueue(new Uint8Array(value),1,[value]))}).catch(reason=>{sink.error(reason)})},sink.onCancel=reason=>{rangeReader.cancel(reason),sink.ready.catch(readyReason=>{if(!this.destroyed)throw readyReason})}):sink.close()}),messageHandler.on("GetDoc",({pdfInfo})=>{this._numPages=pdfInfo.numPages,this._htmlForXfa=pdfInfo.htmlForXfa,delete pdfInfo.htmlForXfa,loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo,this))}),messageHandler.on("DocException",function(ex){let reason;switch(ex.name){case"PasswordException":reason=new _util.PasswordException(ex.message,ex.code);break;case"InvalidPDFException":reason=new _util.InvalidPDFException(ex.message);break;case"MissingPDFException":reason=new _util.MissingPDFException(ex.message);break;case"UnexpectedResponseException":reason=new _util.UnexpectedResponseException(ex.message,ex.status);break;case"UnknownErrorException":reason=new _util.UnknownErrorException(ex.message,ex.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}loadingTask._capability.reject(reason)}),messageHandler.on("PasswordRequest",exception=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),loadingTask.onPassword){const updatePassword=password=>{password instanceof Error?this._passwordCapability.reject(password):this._passwordCapability.resolve({password})};try{loadingTask.onPassword(updatePassword,exception.code)}catch(ex){this._passwordCapability.reject(ex)}}else this._passwordCapability.reject(new _util.PasswordException(exception.message,exception.code));return this._passwordCapability.promise}),messageHandler.on("DataLoaded",data=>{loadingTask.onProgress?.({loaded:data.length,total:data.length}),this.downloadInfoCapability.resolve(data)}),messageHandler.on("StartRenderPage",data=>{this.destroyed||this.#pageCache.get(data.pageIndex)._startRenderPage(data.transparency,data.cacheKey)}),messageHandler.on("commonobj",([id,type,exportedData])=>{if(!this.destroyed&&!this.commonObjs.has(id))switch(type){case"Font":const params=this._params;if("error"in exportedData){const exportedError=exportedData.error;(0,_util.warn)(`Error during font loading: ${exportedError}`),this.commonObjs.resolve(id,exportedError);break}let fontRegistry=null;params.pdfBug&&globalThis.FontInspector?.enabled&&(fontRegistry={registerFont(font2,url){globalThis.FontInspector.fontAdded(font2,url)}});const font=new _font_loader.FontFaceObject(exportedData,{isEvalSupported:params.isEvalSupported,disableFontFace:params.disableFontFace,ignoreErrors:params.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry});this.fontLoader.bind(font).catch(reason=>messageHandler.sendWithPromise("FontFallback",{id})).finally(()=>{!params.fontExtraProperties&&font.data&&(font.data=null),this.commonObjs.resolve(id,font)});break;case"FontPath":case"Image":this.commonObjs.resolve(id,exportedData);break;default:throw new Error(`Got unknown common object type ${type}`)}}),messageHandler.on("obj",([id,pageIndex,type,imageData])=>{if(this.destroyed)return;const pageProxy=this.#pageCache.get(pageIndex);if(!pageProxy.objs.has(id))switch(type){case"Image":pageProxy.objs.resolve(id,imageData);const MAX_IMAGE_SIZE_TO_STORE=8e6;if(imageData){let length;if(imageData.bitmap){const{bitmap,width,height}=imageData;length=width*height*4,pageProxy._bitmaps.add(bitmap)}else length=imageData.data?.length||0;length>MAX_IMAGE_SIZE_TO_STORE&&(pageProxy.cleanupAfterRender=!0)}break;case"Pattern":pageProxy.objs.resolve(id,imageData);break;default:throw new Error(`Got unknown object type ${type}`)}}),messageHandler.on("DocProgress",data=>{this.destroyed||loadingTask.onProgress?.({loaded:data.loaded,total:data.total})}),messageHandler.on("DocStats",data=>{this.destroyed||(this.#docStats=Object.freeze({streamTypes:Object.freeze(data.streamTypes),fontTypes:Object.freeze(data.fontTypes)}))}),messageHandler.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),messageHandler.on("FetchBuiltInCMap",data=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(data):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),messageHandler.on("FetchStandardFontData",data=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(data):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(featureId)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(pageNumber){if(!Number.isInteger(pageNumber)||pageNumber<=0||pageNumber>this._numPages)return Promise.reject(new Error("Invalid page request."));const pageIndex=pageNumber-1,cachedPromise=this.#pagePromises.get(pageIndex);if(cachedPromise)return cachedPromise;const promise=this.messageHandler.sendWithPromise("GetPage",{pageIndex}).then(pageInfo=>{if(this.destroyed)throw new Error("Transport destroyed");const page=new PDFPageProxy(pageIndex,pageInfo,this,this._params.ownerDocument,this._params.pdfBug);return this.#pageCache.set(pageIndex,page),page});return this.#pagePromises.set(pageIndex,promise),promise}getPageIndex(ref){return"object"!=typeof ref||null===ref||!Number.isInteger(ref.num)||ref.num<0||!Number.isInteger(ref.gen)||ref.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:ref.num,gen:ref.gen})}getAnnotations(pageIndex,intent){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex,intent})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(id){return"string"!=typeof id?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(pageIndex){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex})}getStructTree(pageIndex){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(results=>new _optional_content_config.OptionalContentConfig(results))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#metadataPromise||=this.messageHandler.sendWithPromise("GetMetadata",null).then(results=>({info:results[0],metadata:results[1]?new _metadata.Metadata(results[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(keepLoadedFonts=!1){var _this5=this;return _asyncToGenerator(function*(){if(yield _this5.messageHandler.sendWithPromise("Cleanup",null),!_this5.destroyed){for(const page of _this5.#pageCache.values())if(!page.cleanup())throw new Error(`startCleanup: Page ${page.pageNumber} is currently rendering.`);_this5.commonObjs.clear(),keepLoadedFonts||_this5.fontLoader.clear(),_this5.#metadataPromise=null,_this5._getFieldObjectsPromise=null,_this5._hasJSActionsPromise=null}})()}get loadingParams(){const params=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:params.disableAutoFetch,enableXfa:params.enableXfa})}}class PDFObjects{#objs=Object.create(null);#ensureObj(objId){return this.#objs[objId]||(this.#objs[objId]={capability:(0,_util.createPromiseCapability)(),data:null})}get(objId,callback=null){if(callback){const obj2=this.#ensureObj(objId);return obj2.capability.promise.then(()=>callback(obj2.data)),null}const obj=this.#objs[objId];if(!obj?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${objId}.`);return obj.data}has(objId){return this.#objs[objId]?.capability.settled||!1}resolve(objId,data=null){const obj=this.#ensureObj(objId);obj.data=data,obj.capability.resolve()}clear(){this.#objs=Object.create(null)}}class RenderTask{#internalRenderTask=null;constructor(internalRenderTask){this.#internalRenderTask=internalRenderTask,this.onContinue=null}get promise(){return this.#internalRenderTask.capability.promise}cancel(){this.#internalRenderTask.cancel()}get separateAnnots(){const{separateAnnots}=this.#internalRenderTask.operatorList;if(!separateAnnots)return!1;const{annotationCanvasMap}=this.#internalRenderTask;return separateAnnots.form||separateAnnots.canvas&&annotationCanvasMap?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#canvasInUse=new WeakSet;constructor({callback,params,objs,commonObjs,annotationCanvasMap,operatorList,pageIndex,canvasFactory,useRequestAnimationFrame=!1,pdfBug=!1,pageColors=null}){this.callback=callback,this.params=params,this.objs=objs,this.commonObjs=commonObjs,this.annotationCanvasMap=annotationCanvasMap,this.operatorListIdx=null,this.operatorList=operatorList,this._pageIndex=pageIndex,this.canvasFactory=canvasFactory,this._pdfBug=pdfBug,this.pageColors=pageColors,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===useRequestAnimationFrame&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=params.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency=!1,optionalContentConfig}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#canvasInUse.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#canvasInUse.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext,viewport,transform,imageLayer,background}=this.params;this.gfx=new _canvas.CanvasGraphics(canvasContext,this.commonObjs,this.objs,this.canvasFactory,imageLayer,optionalContentConfig,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform,viewport,transparency,background}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(error=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#canvasInUse.delete(this._canvas),this.callback(error||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){var _this6=this;return _asyncToGenerator(function*(){_this6.cancelled||(_this6.operatorListIdx=_this6.gfx.executeOperatorList(_this6.operatorList,_this6.operatorListIdx,_this6._continueBound,_this6.stepper),_this6.operatorListIdx===_this6.operatorList.argsArray.length&&(_this6.running=!1,_this6.operatorList.lastChunk&&(_this6.gfx.endDrawing(),_this6._canvas&&InternalRenderTask.#canvasInUse.delete(_this6._canvas),_this6.callback())))})()}}const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PrintAnnotationStorage=exports2.AnnotationStorage=void 0;var _util2=__w_pdfjs_require__2(1),_editor=__w_pdfjs_require__2(6),_murmurhash=__w_pdfjs_require__2(10);class AnnotationStorage{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(key,defaultValue){const value=this._storage.get(key);return void 0===value?defaultValue:Object.assign(defaultValue,value)}getRawValue(key){return this._storage.get(key)}remove(key){if(this._storage.delete(key),0===this._storage.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const value of this._storage.values())if(value instanceof _editor.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(key,value){const obj=this._storage.get(key);let modified=!1;if(void 0!==obj)for(const[entry,val]of Object.entries(value))obj[entry]!==val&&(modified=!0,obj[entry]=val);else modified=!0,this._storage.set(key,value);modified&&this.#setModified(),value instanceof _editor.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(value.constructor._type)}has(key){return this._storage.has(key)}getAll(){return this._storage.size>0?(0,_util2.objectFromMap)(this._storage):null}get size(){return this._storage.size}#setModified(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new PrintAnnotationStorage(this)}get serializable(){if(0===this._storage.size)return null;const clone=new Map;for(const[key,val]of this._storage){const serialized=val instanceof _editor.AnnotationEditor?val.serialize():val;serialized&&clone.set(key,serialized)}return clone}static getHash(map){if(!map)return"";const hash=new _murmurhash.MurmurHash3_64;for(const[key,val]of map)hash.update(`${key}:${JSON.stringify(val)}`);return hash.hexdigest()}}exports2.AnnotationStorage=AnnotationStorage;class PrintAnnotationStorage extends AnnotationStorage{#serializable=null;constructor(parent){super(),this.#serializable=structuredClone(parent.serializable)}get print(){(0,_util2.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#serializable}}exports2.PrintAnnotationStorage=PrintAnnotationStorage},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.AnnotationEditor=void 0;var _tools=__w_pdfjs_require__2(7),_util2=__w_pdfjs_require__2(1);class AnnotationEditor{#boundFocusin=this.focusin.bind(this);#boundFocusout=this.focusout.bind(this);#hasBeenSelected=!1;#isEditing=!1;#isInEditMode=!1;#zIndex=AnnotationEditor._zIndex++;static _colorManager=new _tools.ColorManager;static _zIndex=1;constructor(parameters){this.constructor===AnnotationEditor&&(0,_util2.unreachable)("Cannot initialize AnnotationEditor."),this.parent=parameters.parent,this.id=parameters.id,this.width=this.height=null,this.pageIndex=parameters.parent.pageIndex,this.name=parameters.name,this.div=null;const[width,height]=this.parent.viewportBaseDimensions;this.x=parameters.x/width,this.y=parameters.y/height,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,_util2.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#zIndex}focusin(event){this.#hasBeenSelected?this.#hasBeenSelected=!1:this.parent.setSelected(this)}focusout(event){!this.isAttachedToDOM||event.relatedTarget?.closest(`#${this.id}`)||(event.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(event){const rect=this.parent.div.getBoundingClientRect();this.startX=event.clientX-rect.x,this.startY=event.clientY-rect.y,event.dataTransfer.setData("text/plain",this.id),event.dataTransfer.effectAllowed="move"}setAt(x,y,tx,ty){const[width,height]=this.parent.viewportBaseDimensions;[tx,ty]=this.screenToPageTranslation(tx,ty),this.x=(x+tx)/width,this.y=(y+ty)/height,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(x,y){const[width,height]=this.parent.viewportBaseDimensions;[x,y]=this.screenToPageTranslation(x,y),this.x+=x/width,this.y+=y/height,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(x,y){const{rotation}=this.parent.viewport;switch(rotation){case 90:return[y,-x];case 180:return[-x,-y];case 270:return[-y,x];default:return[x,y]}}setDims(width,height){const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.div.style.width=100*width/parentWidth+"%",this.div.style.height=100*height/parentHeight+"%"}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#boundFocusin),this.div.addEventListener("focusout",this.#boundFocusout);const[tx,ty]=this.getInitialTranslation();return this.translate(tx,ty),(0,_tools.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(event){const isMac=_tools.KeyboardManager.platform.isMac;0!==event.button||event.ctrlKey&&isMac?event.preventDefault():(event.ctrlKey&&!isMac||event.shiftKey||event.metaKey&&isMac?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#hasBeenSelected=!0)}getRect(tx,ty){const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions,[pageWidth,pageHeight]=this.parent.pageDimensions,shiftX=pageWidth*tx/parentWidth,shiftY=pageHeight*ty/parentHeight,x=this.x*pageWidth,y=this.y*pageHeight,width=this.width*pageWidth,height=this.height*pageHeight;switch(this.rotation){case 0:return[x+shiftX,pageHeight-y-shiftY-height,x+shiftX+width,pageHeight-y-shiftY];case 90:return[x+shiftY,pageHeight-y+shiftX,x+shiftY+height,pageHeight-y+shiftX+width];case 180:return[x-shiftX-width,pageHeight-y+shiftY,x-shiftX,pageHeight-y+shiftY+height];case 270:return[x-shiftY-height,pageHeight-y-shiftX-width,x-shiftY,pageHeight-y-shiftX];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(rect,pageHeight){const[x1,y1,x2,y2]=rect,width=x2-x1,height=y2-y1;switch(this.rotation){case 0:return[x1,pageHeight-y2,width,height];case 90:return[x1,pageHeight-y1,height,width];case 180:return[x2,pageHeight-y1,width,height];case 270:return[x2,pageHeight-y2,height,width];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#isInEditMode=!0}disableEditMode(){this.#isInEditMode=!1}isInEditMode(){return this.#isInEditMode}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#boundFocusin)}serialize(){(0,_util2.unreachable)("An editor must be serializable")}static deserialize(data,parent){const editor=new this.prototype.constructor({parent,id:parent.getNextId()});editor.rotation=data.rotation;const[pageWidth,pageHeight]=parent.pageDimensions,[x,y,width,height]=editor.getRectInCurrentCoords(data.rect,pageHeight);return editor.x=x/pageWidth,editor.y=y/pageHeight,editor.width=width/pageWidth,editor.height=height/pageHeight,editor}remove(){this.div.removeEventListener("focusin",this.#boundFocusin),this.div.removeEventListener("focusout",this.#boundFocusout),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(type,value){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#isEditing}set isEditing(value){this.#isEditing=value,value?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}exports2.AnnotationEditor=AnnotationEditor},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.KeyboardManager=exports2.CommandManager=exports2.ColorManager=exports2.AnnotationEditorUIManager=void 0,exports2.bindEvents=function bindEvents(obj,element,names){for(const name of names)element.addEventListener(name,obj[name].bind(obj))},exports2.opacityToHex=function opacityToHex(opacity){return Math.round(Math.min(255,Math.max(1,255*opacity))).toString(16).padStart(2,"0")};var _util2=__w_pdfjs_require__2(1),_display_utils2=__w_pdfjs_require__2(8);class IdManager{#id=0;getId(){return`${_util2.AnnotationEditorPrefix}${this.#id++}`}}class CommandManager{#commands=[];#locked=!1;#maxSize;#position=-1;constructor(maxSize=128){this.#maxSize=maxSize}add({cmd,undo,mustExec,type=NaN,overwriteIfSameType=!1,keepUndo=!1}){if(mustExec&&cmd(),this.#locked)return;const save={cmd,undo,type};if(-1===this.#position)return this.#commands.length>0&&(this.#commands.length=0),this.#position=0,void this.#commands.push(save);if(overwriteIfSameType&&this.#commands[this.#position].type===type)return keepUndo&&(save.undo=this.#commands[this.#position].undo),void(this.#commands[this.#position]=save);const next=this.#position+1;next===this.#maxSize?this.#commands.splice(0,1):(this.#position=next,next<this.#commands.length&&this.#commands.splice(next)),this.#commands.push(save)}undo(){-1!==this.#position&&(this.#locked=!0,this.#commands[this.#position].undo(),this.#locked=!1,this.#position-=1)}redo(){this.#position<this.#commands.length-1&&(this.#position+=1,this.#locked=!0,this.#commands[this.#position].cmd(),this.#locked=!1)}hasSomethingToUndo(){return-1!==this.#position}hasSomethingToRedo(){return this.#position<this.#commands.length-1}destroy(){this.#commands=null}}exports2.CommandManager=CommandManager;class KeyboardManager{constructor(callbacks){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const isMac=KeyboardManager.platform.isMac;for(const[keys,callback]of callbacks)for(const key of keys){const isMacKey=key.startsWith("mac+");isMac&&isMacKey?(this.callbacks.set(key.slice(4),callback),this.allKeys.add(key.split("+").at(-1))):!isMac&&!isMacKey&&(this.callbacks.set(key,callback),this.allKeys.add(key.split("+").at(-1)))}}static get platform(){const platform=typeof navigator<"u"?navigator.platform:"";return(0,_util2.shadow)(this,"platform",{isWin:platform.includes("Win"),isMac:platform.includes("Mac")})}#serialize(event){event.altKey&&this.buffer.push("alt"),event.ctrlKey&&this.buffer.push("ctrl"),event.metaKey&&this.buffer.push("meta"),event.shiftKey&&this.buffer.push("shift"),this.buffer.push(event.key);const str=this.buffer.join("+");return this.buffer.length=0,str}exec(self,event){if(!this.allKeys.has(event.key))return;const callback=this.callbacks.get(this.#serialize(event));callback&&(callback.bind(self)(),event.stopPropagation(),event.preventDefault())}}exports2.KeyboardManager=KeyboardManager;class ClipboardManager{#elements=null;copy(element){element&&(Array.isArray(element)?this.#elements=element.map(el=>el.serialize()):this.#elements=[element.serialize()],this.#elements=this.#elements.filter(el=>!!el),0===this.#elements.length&&(this.#elements=null))}paste(){return this.#elements}isEmpty(){return null===this.#elements}destroy(){this.#elements=null}}class ColorManager{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const colors=new Map([["CanvasText",null],["Canvas",null]]);return(0,_display_utils2.getColorValues)(colors),(0,_util2.shadow)(this,"_colors",colors)}convert(color){const rgb=(0,_display_utils2.getRGB)(color);if(!window.matchMedia("(forced-colors: active)").matches)return rgb;for(const[name,RGB]of this._colors)if(RGB.every((x,i)=>x===rgb[i]))return ColorManager._colorsMapping.get(name);return rgb}getHexCode(name){const rgb=this._colors.get(name);return rgb?_util2.Util.makeHexColor(...rgb):name}}exports2.ColorManager=ColorManager;class AnnotationEditorUIManager{#activeEditor=null;#allEditors=new Map;#allLayers=new Map;#clipboardManager=new ClipboardManager;#commandManager=new CommandManager;#currentPageIndex=0;#editorTypes=null;#eventBus=null;#idManager=new IdManager;#isEnabled=!1;#mode=_util2.AnnotationEditorType.NONE;#selectedEditors=new Set;#boundKeydown=this.keydown.bind(this);#boundOnEditingAction=this.onEditingAction.bind(this);#boundOnPageChanging=this.onPageChanging.bind(this);#previousStates={isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#container=null;static _keyboardManager=new KeyboardManager([[["ctrl+a","mac+meta+a"],AnnotationEditorUIManager.prototype.selectAll],[["ctrl+c","mac+meta+c"],AnnotationEditorUIManager.prototype.copy],[["ctrl+v","mac+meta+v"],AnnotationEditorUIManager.prototype.paste],[["ctrl+x","mac+meta+x"],AnnotationEditorUIManager.prototype.cut],[["ctrl+z","mac+meta+z"],AnnotationEditorUIManager.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],AnnotationEditorUIManager.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],AnnotationEditorUIManager.prototype.delete],[["Escape","mac+Escape"],AnnotationEditorUIManager.prototype.unselectAll]]);constructor(container,eventBus){this.#container=container,this.#eventBus=eventBus,this.#eventBus._on("editingaction",this.#boundOnEditingAction),this.#eventBus._on("pagechanging",this.#boundOnPageChanging)}destroy(){this.#removeKeyboardManager(),this.#eventBus._off("editingaction",this.#boundOnEditingAction),this.#eventBus._off("pagechanging",this.#boundOnPageChanging);for(const layer of this.#allLayers.values())layer.destroy();this.#allLayers.clear(),this.#allEditors.clear(),this.#activeEditor=null,this.#selectedEditors.clear(),this.#clipboardManager.destroy(),this.#commandManager.destroy()}onPageChanging({pageNumber}){this.#currentPageIndex=pageNumber-1}focusMainContainer(){this.#container.focus()}#addKeyboardManager(){this.#container.addEventListener("keydown",this.#boundKeydown)}#removeKeyboardManager(){this.#container.removeEventListener("keydown",this.#boundKeydown)}keydown(event){this.getActive()?.shouldGetKeyboardEvents()||AnnotationEditorUIManager._keyboardManager.exec(this,event)}onEditingAction(details){["undo","redo","cut","copy","paste","delete","selectAll"].includes(details.name)&&this[details.name]()}#dispatchUpdateStates(details){Object.entries(details).some(([key,value])=>this.#previousStates[key]!==value)&&this.#eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#previousStates,details)})}#dispatchUpdateUI(details){this.#eventBus.dispatch("annotationeditorparamschanged",{source:this,details})}setEditingState(isEditing){isEditing?(this.#addKeyboardManager(),this.#dispatchUpdateStates({isEditing:this.#mode!==_util2.AnnotationEditorType.NONE,isEmpty:this.#isEmpty(),hasSomethingToUndo:this.#commandManager.hasSomethingToUndo(),hasSomethingToRedo:this.#commandManager.hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:this.#clipboardManager.isEmpty()})):(this.#removeKeyboardManager(),this.#dispatchUpdateStates({isEditing:!1}))}registerEditorTypes(types){this.#editorTypes=types;for(const editorType of this.#editorTypes)this.#dispatchUpdateUI(editorType.defaultPropertiesToUpdate)}getId(){return this.#idManager.getId()}addLayer(layer){this.#allLayers.set(layer.pageIndex,layer),this.#isEnabled?layer.enable():layer.disable()}removeLayer(layer){this.#allLayers.delete(layer.pageIndex)}updateMode(mode){if(this.#mode=mode,mode===_util2.AnnotationEditorType.NONE)this.setEditingState(!1),this.#disableAll();else{this.setEditingState(!0),this.#enableAll();for(const layer of this.#allLayers.values())layer.updateMode(mode)}}updateToolbar(mode){mode!==this.#mode&&this.#eventBus.dispatch("switchannotationeditormode",{source:this,mode})}updateParams(type,value){for(const editor of this.#selectedEditors)editor.updateParams(type,value);for(const editorType of this.#editorTypes)editorType.updateDefaultParams(type,value)}#enableAll(){if(!this.#isEnabled){this.#isEnabled=!0;for(const layer of this.#allLayers.values())layer.enable()}}#disableAll(){if(this.unselectAll(),this.#isEnabled){this.#isEnabled=!1;for(const layer of this.#allLayers.values())layer.disable()}}getEditors(pageIndex){const editors=[];for(const editor of this.#allEditors.values())editor.pageIndex===pageIndex&&editors.push(editor);return editors}getEditor(id){return this.#allEditors.get(id)}addEditor(editor){this.#allEditors.set(editor.id,editor)}removeEditor(editor){this.#allEditors.delete(editor.id),this.unselect(editor)}#addEditorToLayer(editor){const layer=this.#allLayers.get(editor.pageIndex);layer?layer.addOrRebuild(editor):this.addEditor(editor)}setActiveEditor(editor){this.#activeEditor!==editor&&(this.#activeEditor=editor,editor&&this.#dispatchUpdateUI(editor.propertiesToUpdate))}toggleSelected(editor){if(this.#selectedEditors.has(editor))return this.#selectedEditors.delete(editor),editor.unselect(),void this.#dispatchUpdateStates({hasSelectedEditor:this.hasSelection});this.#selectedEditors.add(editor),editor.select(),this.#dispatchUpdateUI(editor.propertiesToUpdate),this.#dispatchUpdateStates({hasSelectedEditor:!0})}setSelected(editor){for(const ed of this.#selectedEditors)ed!==editor&&ed.unselect();this.#selectedEditors.clear(),this.#selectedEditors.add(editor),editor.select(),this.#dispatchUpdateUI(editor.propertiesToUpdate),this.#dispatchUpdateStates({hasSelectedEditor:!0})}isSelected(editor){return this.#selectedEditors.has(editor)}unselect(editor){editor.unselect(),this.#selectedEditors.delete(editor),this.#dispatchUpdateStates({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#selectedEditors.size}undo(){this.#commandManager.undo(),this.#dispatchUpdateStates({hasSomethingToUndo:this.#commandManager.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#isEmpty()})}redo(){this.#commandManager.redo(),this.#dispatchUpdateStates({hasSomethingToUndo:!0,hasSomethingToRedo:this.#commandManager.hasSomethingToRedo(),isEmpty:this.#isEmpty()})}addCommands(params){this.#commandManager.add(params),this.#dispatchUpdateStates({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#isEmpty()})}#isEmpty(){if(0===this.#allEditors.size)return!0;if(1===this.#allEditors.size)for(const editor of this.#allEditors.values())return editor.isEmpty();return!1}delete(){if(this.#activeEditor&&this.#activeEditor.commitOrRemove(),!this.hasSelection)return;const editors=[...this.#selectedEditors];this.addCommands({cmd:()=>{for(const editor of editors)editor.remove()},undo:()=>{for(const editor of editors)this.#addEditorToLayer(editor)},mustExec:!0})}copy(){if(this.#activeEditor&&this.#activeEditor.commitOrRemove(),this.hasSelection){const editors=[];for(const editor of this.#selectedEditors)editor.isEmpty()||editors.push(editor);if(0===editors.length)return;this.#clipboardManager.copy(editors),this.#dispatchUpdateStates({hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(this.#clipboardManager.isEmpty())return;this.unselectAll();const layer=this.#allLayers.get(this.#currentPageIndex),newEditors=this.#clipboardManager.paste().map(data=>layer.deserialize(data));this.addCommands({cmd:()=>{for(const editor of newEditors)this.#addEditorToLayer(editor);this.#selectEditors(newEditors)},undo:()=>{for(const editor of newEditors)editor.remove()},mustExec:!0})}#selectEditors(editors){this.#selectedEditors.clear();for(const editor of editors)editor.isEmpty()||(this.#selectedEditors.add(editor),editor.select());this.#dispatchUpdateStates({hasSelectedEditor:!0})}selectAll(){for(const editor of this.#selectedEditors)editor.commit();this.#selectEditors(this.#allEditors.values())}unselectAll(){if(this.#activeEditor)this.#activeEditor.commitOrRemove();else if(0!==this.#selectEditors.size){for(const editor of this.#selectedEditors)editor.unselect();this.#selectedEditors.clear(),this.#dispatchUpdateStates({hasSelectedEditor:!1})}}isActive(editor){return this.#activeEditor===editor}getActive(){return this.#activeEditor}getMode(){return this.#mode}}exports2.AnnotationEditorUIManager=AnnotationEditorUIManager},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.StatTimer=exports2.RenderingCancelledException=exports2.PixelsPerInch=exports2.PageViewport=exports2.PDFDateString=exports2.DOMStandardFontDataFactory=exports2.DOMSVGFactory=exports2.DOMCanvasFactory=exports2.DOMCMapReaderFactory=exports2.AnnotationPrefix=void 0,exports2.deprecated=function deprecated(details){console.log("Deprecated API usage: "+details)},exports2.getColorValues=function getColorValues(colors){const span=document.createElement("span");span.style.visibility="hidden",document.body.append(span);for(const name of colors.keys()){span.style.color=name;const computedColor=window.getComputedStyle(span).color;colors.set(name,getRGB(computedColor))}span.remove()},exports2.getCurrentTransform=function getCurrentTransform(ctx){const{a,b,c,d,e,f}=ctx.getTransform();return[a,b,c,d,e,f]},exports2.getCurrentTransformInverse=function getCurrentTransformInverse(ctx){const{a,b,c,d,e,f}=ctx.getTransform().invertSelf();return[a,b,c,d,e,f]},exports2.getFilenameFromUrl=function getFilenameFromUrl(url){const anchor=url.indexOf("#"),query=url.indexOf("?"),end=Math.min(anchor>0?anchor:url.length,query>0?query:url.length);return url.substring(url.lastIndexOf("/",end)+1,end)},exports2.getPdfFilenameFromUrl=function getPdfFilenameFromUrl(url,defaultFilename="document.pdf"){if("string"!=typeof url)return defaultFilename;if(isDataScheme(url))return(0,_util2.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),defaultFilename;const reFilename=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,splitURI=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(url);let suggestedFilename=reFilename.exec(splitURI[1])||reFilename.exec(splitURI[2])||reFilename.exec(splitURI[3]);if(suggestedFilename&&(suggestedFilename=suggestedFilename[0],suggestedFilename.includes("%")))try{suggestedFilename=reFilename.exec(decodeURIComponent(suggestedFilename))[0]}catch{}return suggestedFilename||defaultFilename},exports2.getRGB=getRGB,exports2.getXfaPageViewport=function getXfaPageViewport(xfaPage,{scale=1,rotation=0}){const{width,height}=xfaPage.attributes.style,viewBox=[0,0,parseInt(width),parseInt(height)];return new PageViewport({viewBox,scale,rotation})},exports2.isDataScheme=isDataScheme,exports2.isPdfFile=function isPdfFile(filename){return"string"==typeof filename&&/\.pdf$/i.test(filename)},exports2.isValidFetchUrl=isValidFetchUrl,exports2.loadScript=function loadScript(src,removeScriptElement=!1){return new Promise((resolve,reject)=>{const script=document.createElement("script");script.src=src,script.onload=function(evt){removeScriptElement&&script.remove(),resolve(evt)},script.onerror=function(){reject(new Error(`Cannot load script at: ${script.src}`))},(document.head||document.documentElement).append(script)})};var _base_factory=__w_pdfjs_require__2(9),_util2=__w_pdfjs_require__2(1);function fetchData(_x5){return _fetchData.apply(this,arguments)}function _fetchData(){return(_fetchData=_asyncToGenerator(function*(url,asTypedArray=!1){if(isValidFetchUrl(url,document.baseURI)){const response=yield fetch(url);if(!response.ok)throw new Error(response.statusText);return asTypedArray?new Uint8Array(yield response.arrayBuffer()):(0,_util2.stringToBytes)(yield response.text())}return new Promise((resolve,reject)=>{const request=new XMLHttpRequest;request.open("GET",url,!0),asTypedArray&&(request.responseType="arraybuffer"),request.onreadystatechange=()=>{if(request.readyState===XMLHttpRequest.DONE){if(200===request.status||0===request.status){let data;if(asTypedArray&&request.response?data=new Uint8Array(request.response):!asTypedArray&&request.responseText&&(data=(0,_util2.stringToBytes)(request.responseText)),data)return void resolve(data)}reject(new Error(request.statusText))}},request.send(null)})})).apply(this,arguments)}exports2.AnnotationPrefix="pdfjs_internal_id_",exports2.PixelsPerInch=class PixelsPerInch{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF},exports2.DOMCanvasFactory=class DOMCanvasFactory extends _base_factory.BaseCanvasFactory{constructor({ownerDocument=globalThis.document}={}){super(),this._document=ownerDocument}_createCanvas(width,height){const canvas=this._document.createElement("canvas");return canvas.width=width,canvas.height=height,canvas}},exports2.DOMCMapReaderFactory=class DOMCMapReaderFactory extends _base_factory.BaseCMapReaderFactory{_fetchData(url,compressionType){return fetchData(url,this.isCompressed).then(data=>({cMapData:data,compressionType}))}},exports2.DOMStandardFontDataFactory=class DOMStandardFontDataFactory extends _base_factory.BaseStandardFontDataFactory{_fetchData(url){return fetchData(url,!0)}},exports2.DOMSVGFactory=class DOMSVGFactory extends _base_factory.BaseSVGFactory{_createSVG(type){return document.createElementNS("http://www.w3.org/2000/svg",type)}};class PageViewport{constructor({viewBox,scale,rotation,offsetX=0,offsetY=0,dontFlip=!1}){this.viewBox=viewBox,this.scale=scale,this.rotation=rotation,this.offsetX=offsetX,this.offsetY=offsetY;const centerX=(viewBox[2]+viewBox[0])/2,centerY=(viewBox[3]+viewBox[1])/2;let rotateA,rotateB,rotateC,rotateD,offsetCanvasX,offsetCanvasY,width,height;switch((rotation%=360)<0&&(rotation+=360),rotation){case 180:rotateA=-1,rotateB=0,rotateC=0,rotateD=1;break;case 90:rotateA=0,rotateB=1,rotateC=1,rotateD=0;break;case 270:rotateA=0,rotateB=-1,rotateC=-1,rotateD=0;break;case 0:rotateA=1,rotateB=0,rotateC=0,rotateD=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}dontFlip&&(rotateC=-rotateC,rotateD=-rotateD),0===rotateA?(offsetCanvasX=Math.abs(centerY-viewBox[1])*scale+offsetX,offsetCanvasY=Math.abs(centerX-viewBox[0])*scale+offsetY,width=Math.abs(viewBox[3]-viewBox[1])*scale,height=Math.abs(viewBox[2]-viewBox[0])*scale):(offsetCanvasX=Math.abs(centerX-viewBox[0])*scale+offsetX,offsetCanvasY=Math.abs(centerY-viewBox[1])*scale+offsetY,width=Math.abs(viewBox[2]-viewBox[0])*scale,height=Math.abs(viewBox[3]-viewBox[1])*scale),this.transform=[rotateA*scale,rotateB*scale,rotateC*scale,rotateD*scale,offsetCanvasX-rotateA*scale*centerX-rotateC*scale*centerY,offsetCanvasY-rotateB*scale*centerX-rotateD*scale*centerY],this.width=width,this.height=height}clone({scale=this.scale,rotation=this.rotation,offsetX=this.offsetX,offsetY=this.offsetY,dontFlip=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),scale,rotation,offsetX,offsetY,dontFlip})}convertToViewportPoint(x,y){return _util2.Util.applyTransform([x,y],this.transform)}convertToViewportRectangle(rect){const topLeft=_util2.Util.applyTransform([rect[0],rect[1]],this.transform),bottomRight=_util2.Util.applyTransform([rect[2],rect[3]],this.transform);return[topLeft[0],topLeft[1],bottomRight[0],bottomRight[1]]}convertToPdfPoint(x,y){return _util2.Util.applyInverseTransform([x,y],this.transform)}}function isDataScheme(url){const ii=url.length;let i=0;for(;i<ii&&""===url[i].trim();)i++;return"data:"===url.substring(i,i+5).toLowerCase()}function isValidFetchUrl(url,baseUrl){try{const{protocol}=baseUrl?new URL(url,baseUrl):new URL(url);return"http:"===protocol||"https:"===protocol}catch{return!1}}let pdfDateStringRegex;function getRGB(color){if(color.startsWith("#")){const colorRGB=parseInt(color.slice(1),16);return[(16711680&colorRGB)>>16,(65280&colorRGB)>>8,255&colorRGB]}return color.startsWith("rgb(")?color.slice(4,-1).split(",").map(x=>parseInt(x)):color.startsWith("rgba(")?color.slice(5,-1).split(",").map(x=>parseInt(x)).slice(0,3):((0,_util2.warn)(`Not a valid color format: "${color}"`),[0,0,0])}exports2.PageViewport=PageViewport,exports2.RenderingCancelledException=class RenderingCancelledException extends _util2.BaseException{constructor(msg,type){super(msg,"RenderingCancelledException"),this.type=type}},exports2.StatTimer=class StatTimer{constructor(){this.started=Object.create(null),this.times=[]}time(name){name in this.started&&(0,_util2.warn)(`Timer is already running for ${name}`),this.started[name]=Date.now()}timeEnd(name){name in this.started||(0,_util2.warn)(`Timer has not been started for ${name}`),this.times.push({name,start:this.started[name],end:Date.now()}),delete this.started[name]}toString(){const outBuf=[];let longest=0;for(const time of this.times){const name=time.name;name.length>longest&&(longest=name.length)}for(const time of this.times){const duration=time.end-time.start;outBuf.push(`${time.name.padEnd(longest)} ${duration}ms\n`)}return outBuf.join("")}},exports2.PDFDateString=class PDFDateString{static toDateObject(input){if(!input||"string"!=typeof input)return null;pdfDateStringRegex||(pdfDateStringRegex=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const matches=pdfDateStringRegex.exec(input);if(!matches)return null;const year=parseInt(matches[1],10);let month=parseInt(matches[2],10);month=month>=1&&month<=12?month-1:0;let day=parseInt(matches[3],10);day=day>=1&&day<=31?day:1;let hour=parseInt(matches[4],10);hour=hour>=0&&hour<=23?hour:0;let minute=parseInt(matches[5],10);minute=minute>=0&&minute<=59?minute:0;let second=parseInt(matches[6],10);second=second>=0&&second<=59?second:0;const universalTimeRelation=matches[7]||"Z";let offsetHour=parseInt(matches[8],10);offsetHour=offsetHour>=0&&offsetHour<=23?offsetHour:0;let offsetMinute=parseInt(matches[9],10)||0;return offsetMinute=offsetMinute>=0&&offsetMinute<=59?offsetMinute:0,"-"===universalTimeRelation?(hour+=offsetHour,minute+=offsetMinute):"+"===universalTimeRelation&&(hour-=offsetHour,minute-=offsetMinute),new Date(Date.UTC(year,month,day,hour,minute,second))}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.BaseStandardFontDataFactory=exports2.BaseSVGFactory=exports2.BaseCanvasFactory=exports2.BaseCMapReaderFactory=void 0;var _util2=__w_pdfjs_require__2(1);class BaseCanvasFactory{constructor(){this.constructor===BaseCanvasFactory&&(0,_util2.unreachable)("Cannot initialize BaseCanvasFactory.")}create(width,height){if(width<=0||height<=0)throw new Error("Invalid canvas size");const canvas=this._createCanvas(width,height);return{canvas,context:canvas.getContext("2d")}}reset(canvasAndContext,width,height){if(!canvasAndContext.canvas)throw new Error("Canvas is not specified");if(width<=0||height<=0)throw new Error("Invalid canvas size");canvasAndContext.canvas.width=width,canvasAndContext.canvas.height=height}destroy(canvasAndContext){if(!canvasAndContext.canvas)throw new Error("Canvas is not specified");canvasAndContext.canvas.width=0,canvasAndContext.canvas.height=0,canvasAndContext.canvas=null,canvasAndContext.context=null}_createCanvas(width,height){(0,_util2.unreachable)("Abstract method `_createCanvas` called.")}}exports2.BaseCanvasFactory=BaseCanvasFactory;class BaseCMapReaderFactory{constructor({baseUrl=null,isCompressed=!1}){this.constructor===BaseCMapReaderFactory&&(0,_util2.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=baseUrl,this.isCompressed=isCompressed}fetch({name}){var _this7=this;return _asyncToGenerator(function*(){if(!_this7.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!name)throw new Error("CMap name must be specified.");const url=_this7.baseUrl+name+(_this7.isCompressed?".bcmap":"");return _this7._fetchData(url,_this7.isCompressed?_util2.CMapCompressionType.BINARY:_util2.CMapCompressionType.NONE).catch(reason=>{throw new Error(`Unable to load ${_this7.isCompressed?"binary ":""}CMap at: ${url}`)})})()}_fetchData(url,compressionType){(0,_util2.unreachable)("Abstract method `_fetchData` called.")}}exports2.BaseCMapReaderFactory=BaseCMapReaderFactory;class BaseStandardFontDataFactory{constructor({baseUrl=null}){this.constructor===BaseStandardFontDataFactory&&(0,_util2.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=baseUrl}fetch({filename}){var _this8=this;return _asyncToGenerator(function*(){if(!_this8.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!filename)throw new Error("Font filename must be specified.");const url=`${_this8.baseUrl}${filename}`;return _this8._fetchData(url).catch(reason=>{throw new Error(`Unable to load font data at: ${url}`)})})()}_fetchData(url){(0,_util2.unreachable)("Abstract method `_fetchData` called.")}}exports2.BaseStandardFontDataFactory=BaseStandardFontDataFactory;class BaseSVGFactory{constructor(){this.constructor===BaseSVGFactory&&(0,_util2.unreachable)("Cannot initialize BaseSVGFactory.")}create(width,height,skipDimensions=!1){if(width<=0||height<=0)throw new Error("Invalid SVG dimensions");const svg=this._createSVG("svg:svg");return svg.setAttribute("version","1.1"),skipDimensions||(svg.setAttribute("width",`${width}px`),svg.setAttribute("height",`${height}px`)),svg.setAttribute("preserveAspectRatio","none"),svg.setAttribute("viewBox",`0 0 ${width} ${height}`),svg}createElement(type){if("string"!=typeof type)throw new Error("Invalid SVG element type");return this._createSVG(type)}_createSVG(type){(0,_util2.unreachable)("Abstract method `_createSVG` called.")}}exports2.BaseSVGFactory=BaseSVGFactory},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.MurmurHash3_64=void 0;var _util2=__w_pdfjs_require__2(1);exports2.MurmurHash3_64=class MurmurHash3_64{constructor(seed){this.h1=seed?4294967295&seed:3285377520,this.h2=seed?4294967295&seed:3285377520}update(input){let data,length;if("string"==typeof input){data=new Uint8Array(2*input.length),length=0;for(let i=0,ii=input.length;i<ii;i++){const code=input.charCodeAt(i);code<=255?data[length++]=code:(data[length++]=code>>>8,data[length++]=255&code)}}else{if(!(0,_util2.isArrayBuffer)(input))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");data=input.slice(),length=data.byteLength}const blockCounts=length>>2,tailLength=length-4*blockCounts,dataUint32=new Uint32Array(data.buffer,0,blockCounts);let k1=0,k2=0,h1=this.h1,h2=this.h2;const C1=3432918353,C2=461845907;for(let i=0;i<blockCounts;i++)1&i?(k1=dataUint32[i],k1=k1*C1&4294901760|11601*k1&65535,k1=k1<<15|k1>>>17,k1=k1*C2&4294901760|13715*k1&65535,h1^=k1,h1=h1<<13|h1>>>19,h1=5*h1+3864292196):(k2=dataUint32[i],k2=k2*C1&4294901760|11601*k2&65535,k2=k2<<15|k2>>>17,k2=k2*C2&4294901760|13715*k2&65535,h2^=k2,h2=h2<<13|h2>>>19,h2=5*h2+3864292196);switch(k1=0,tailLength){case 3:k1^=data[4*blockCounts+2]<<16;case 2:k1^=data[4*blockCounts+1]<<8;case 1:k1^=data[4*blockCounts],k1=k1*C1&4294901760|11601*k1&65535,k1=k1<<15|k1>>>17,k1=k1*C2&4294901760|13715*k1&65535,1&blockCounts?h1^=k1:h2^=k1}this.h1=h1,this.h2=h2}hexdigest(){let h1=this.h1,h2=this.h2;h1^=h2>>>1,h1=3981806797*h1&4294901760|36045*h1&65535,h2=4283543511*h2&4294901760|(2950163797*(h2<<16|h1>>>16)&4294901760)>>>16,h1^=h2>>>1,h1=444984403*h1&4294901760|60499*h1&65535,h2=3301882366*h2&4294901760|(3120437893*(h2<<16|h1>>>16)&4294901760)>>>16,h1^=h2>>>1;const hex1=(h1>>>0).toString(16),hex2=(h2>>>0).toString(16);return hex1.padStart(8,"0")+hex2.padStart(8,"0")}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.FontLoader=exports2.FontFaceObject=void 0;var _util2=__w_pdfjs_require__2(1);class BaseFontLoader{constructor({docId,onUnsupportedFeature,ownerDocument=globalThis.document,styleElement=null}){this.constructor===BaseFontLoader&&(0,_util2.unreachable)("Cannot initialize BaseFontLoader."),this.docId=docId,this._onUnsupportedFeature=onUnsupportedFeature,this._document=ownerDocument,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(nativeFontFace){this.nativeFontFaces.push(nativeFontFace),this._document.fonts.add(nativeFontFace)}insertRule(rule){let styleElement=this.styleElement;styleElement||(styleElement=this.styleElement=this._document.createElement("style"),styleElement.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(styleElement));const styleSheet=styleElement.sheet;styleSheet.insertRule(rule,styleSheet.cssRules.length)}clear(){for(const nativeFontFace of this.nativeFontFaces)this._document.fonts.delete(nativeFontFace);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}bind(font){var _this9=this;return _asyncToGenerator(function*(){if(font.attached||font.missingFile)return;if(font.attached=!0,_this9.isFontLoadingAPISupported){const nativeFontFace=font.createNativeFontFace();if(nativeFontFace){_this9.addNativeFontFace(nativeFontFace);try{yield nativeFontFace.loaded}catch(ex){throw _this9._onUnsupportedFeature({featureId:_util2.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,_util2.warn)(`Failed to load font '${nativeFontFace.family}': '${ex}'.`),font.disableFontFace=!0,ex}}return}const rule=font.createFontFaceRule();if(rule){if(_this9.insertRule(rule),_this9.isSyncFontLoadingSupported)return;yield new Promise(resolve=>{const request=_this9._queueLoadingCallback(resolve);_this9._prepareFontLoadEvent([rule],[font],request)})}})()}_queueLoadingCallback(callback){(0,_util2.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){return(0,_util2.shadow)(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){(0,_util2.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,_util2.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(rules,fontsToLoad,request){(0,_util2.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let FontLoader;exports2.FontLoader=FontLoader,exports2.FontLoader=FontLoader=class extends BaseFontLoader{constructor(params){super(params),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let supported=!1;return(typeof navigator>"u"||/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent)?.[1]>=14)&&(supported=!0),(0,_util2.shadow)(this,"isSyncFontLoadingSupported",supported)}_queueLoadingCallback(callback){const context=this.loadingContext,request={id:"pdfjs-font-loading-"+context.nextRequestId++,done:!1,complete:function completeRequest(){for((0,_util2.assert)(!request.done,"completeRequest() cannot be called twice."),request.done=!0;context.requests.length>0&&context.requests[0].done;){const otherRequest=context.requests.shift();setTimeout(otherRequest.callback,0)}},callback};return context.requests.push(request),request}get _loadTestFont(){return(0,_util2.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(rules,fonts,request){function int32(data2,offset){return data2.charCodeAt(offset)<<24|data2.charCodeAt(offset+1)<<16|data2.charCodeAt(offset+2)<<8|255&data2.charCodeAt(offset+3)}function spliceString(s,offset,remove,insert){return s.substring(0,offset)+insert+s.substring(offset+remove)}let i,ii;const canvas=this._document.createElement("canvas");canvas.width=1,canvas.height=1;const ctx=canvas.getContext("2d");let called=0;const loadTestFontId=`lt${Date.now()}${this.loadTestFontId++}`;let data=this._loadTestFont;data=spliceString(data,976,loadTestFontId.length,loadTestFontId);let checksum=int32(data,16);for(i=0,ii=loadTestFontId.length-3;i<ii;i+=4)checksum=checksum-1482184792+int32(loadTestFontId,i)|0;i<loadTestFontId.length&&(checksum=checksum-1482184792+int32(loadTestFontId+"XXX",i)|0),data=spliceString(data,16,4,(0,_util2.string32)(checksum));const url=`url(data:font/opentype;base64,${btoa(data)});`;this.insertRule(`@font-face {font-family:"${loadTestFontId}";src:${url}}`);const names=[];for(const font of fonts)names.push(font.loadedName);names.push(loadTestFontId);const div=this._document.createElement("div");div.style.visibility="hidden",div.style.width=div.style.height="10px",div.style.position="absolute",div.style.top=div.style.left="0px";for(const name of names){const span=this._document.createElement("span");span.textContent="Hi",span.style.fontFamily=name,div.append(span)}this._document.body.append(div),function isFontReady(name,callback){if(called++,called>30)return(0,_util2.warn)("Load test font never loaded."),void callback();ctx.font="30px "+name,ctx.fillText(".",0,20),ctx.getImageData(0,0,1,1).data[3]>0?callback():setTimeout(isFontReady.bind(null,name,callback))}(loadTestFontId,()=>{div.remove(),request.complete()})}},exports2.FontFaceObject=class FontFaceObject{constructor(translatedData,{isEvalSupported=!0,disableFontFace=!1,ignoreErrors=!1,onUnsupportedFeature,fontRegistry=null}){this.compiledGlyphs=Object.create(null);for(const i in translatedData)this[i]=translatedData[i];this.isEvalSupported=!1!==isEvalSupported,this.disableFontFace=!0===disableFontFace,this.ignoreErrors=!0===ignoreErrors,this._onUnsupportedFeature=onUnsupportedFeature,this.fontRegistry=fontRegistry}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let nativeFontFace;if(this.cssFontInfo){const css={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(css.style=`oblique ${this.cssFontInfo.italicAngle}deg`),nativeFontFace=new FontFace(this.cssFontInfo.fontFamily,this.data,css)}else nativeFontFace=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),nativeFontFace}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const data=(0,_util2.bytesToString)(this.data),url=`url(data:${this.mimetype};base64,${btoa(data)});`;let rule;if(this.cssFontInfo){let css=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(css+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),rule=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${css}src:${url}}`}else rule=`@font-face {font-family:"${this.loadedName}";src:${url}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,url),rule}getPathGenerator(objs,character){if(void 0!==this.compiledGlyphs[character])return this.compiledGlyphs[character];let cmds;try{cmds=objs.get(this.loadedName+"_path_"+character)}catch(ex){if(!this.ignoreErrors)throw ex;return this._onUnsupportedFeature({featureId:_util2.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,_util2.warn)(`getPathGenerator - ignoring character: "${ex}".`),this.compiledGlyphs[character]=function(c,size){}}if(this.isEvalSupported&&_util2.FeatureTest.isEvalSupported){const jsBuf=[];for(const current of cmds){const args=void 0!==current.args?current.args.join(","):"";jsBuf.push("c.",current.cmd,"(",args,");\n")}return this.compiledGlyphs[character]=new Function("c","size",jsBuf.join(""))}return this.compiledGlyphs[character]=function(c,size){for(const current of cmds)"scale"===current.cmd&&(current.args=[size,-size]),c[current.cmd].apply(c,current.args)}}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.CanvasGraphics=void 0;var _display_utils2=__w_pdfjs_require__2(8),_util2=__w_pdfjs_require__2(1),_pattern_helper=__w_pdfjs_require__2(13),_image_utils=__w_pdfjs_require__2(14);const MAX_SIZE_TO_COMPILE=__w_pdfjs_require__2(3).isNodeJS&&typeof Path2D>"u"?-1:1e3;class CachedCanvases{constructor(canvasFactory){this.canvasFactory=canvasFactory,this.cache=Object.create(null)}getCanvas(id,width,height){let canvasEntry;return void 0!==this.cache[id]?(canvasEntry=this.cache[id],this.canvasFactory.reset(canvasEntry,width,height)):(canvasEntry=this.canvasFactory.create(width,height),this.cache[id]=canvasEntry),canvasEntry}delete(id){delete this.cache[id]}clear(){for(const id in this.cache)this.canvasFactory.destroy(this.cache[id]),delete this.cache[id]}}function drawImageAtIntegerCoords(ctx,srcImg,srcX,srcY,srcW,srcH,destX,destY,destW,destH){const[a,b,c,d,tx,ty]=(0,_display_utils2.getCurrentTransform)(ctx);if(0===b&&0===c){const rTlX=Math.round(destX*a+tx),rTlY=Math.round(destY*d+ty),rWidth=Math.abs(Math.round((destX+destW)*a+tx)-rTlX)||1,rHeight=Math.abs(Math.round((destY+destH)*d+ty)-rTlY)||1;return ctx.setTransform(Math.sign(a),0,0,Math.sign(d),rTlX,rTlY),ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,0,0,rWidth,rHeight),ctx.setTransform(a,b,c,d,tx,ty),[rWidth,rHeight]}if(0===a&&0===d){const rTlX=Math.round(destY*c+tx),rTlY=Math.round(destX*b+ty),rWidth=Math.abs(Math.round((destY+destH)*c+tx)-rTlX)||1,rHeight=Math.abs(Math.round((destX+destW)*b+ty)-rTlY)||1;return ctx.setTransform(0,Math.sign(b),Math.sign(c),0,rTlX,rTlY),ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,0,0,rHeight,rWidth),ctx.setTransform(a,b,c,d,tx,ty),[rHeight,rWidth]}return ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,destX,destY,destW,destH),[Math.hypot(a,b)*destW,Math.hypot(c,d)*destH]}class CanvasExtraState{constructor(width,height){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_util2.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=_util2.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=_util2.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,width,height])}clone(){const clone=Object.create(this);return clone.clipBox=this.clipBox.slice(),clone}setCurrentPoint(x,y){this.x=x,this.y=y}updatePathMinMax(transform,x,y){[x,y]=_util2.Util.applyTransform([x,y],transform),this.minX=Math.min(this.minX,x),this.minY=Math.min(this.minY,y),this.maxX=Math.max(this.maxX,x),this.maxY=Math.max(this.maxY,y)}updateRectMinMax(transform,rect){const p1=_util2.Util.applyTransform(rect,transform),p2=_util2.Util.applyTransform(rect.slice(2),transform);this.minX=Math.min(this.minX,p1[0],p2[0]),this.minY=Math.min(this.minY,p1[1],p2[1]),this.maxX=Math.max(this.maxX,p1[0],p2[0]),this.maxY=Math.max(this.maxY,p1[1],p2[1])}updateScalingPathMinMax(transform,minMax){_util2.Util.scaleMinMax(transform,minMax),this.minX=Math.min(this.minX,minMax[0]),this.maxX=Math.max(this.maxX,minMax[1]),this.minY=Math.min(this.minY,minMax[2]),this.maxY=Math.max(this.maxY,minMax[3])}updateCurvePathMinMax(transform,x0,y0,x1,y1,x2,y2,x3,y3,minMax){const box=_util2.Util.bezierBoundingBox(x0,y0,x1,y1,x2,y2,x3,y3);if(minMax)return minMax[0]=Math.min(minMax[0],box[0],box[2]),minMax[1]=Math.max(minMax[1],box[0],box[2]),minMax[2]=Math.min(minMax[2],box[1],box[3]),void(minMax[3]=Math.max(minMax[3],box[1],box[3]));this.updateRectMinMax(transform,box)}getPathBoundingBox(pathType=_pattern_helper.PathType.FILL,transform=null){const box=[this.minX,this.minY,this.maxX,this.maxY];if(pathType===_pattern_helper.PathType.STROKE){transform||(0,_util2.unreachable)("Stroke bounding box must include transform.");const scale=_util2.Util.singularValueDecompose2dScale(transform),xStrokePad=scale[0]*this.lineWidth/2,yStrokePad=scale[1]*this.lineWidth/2;box[0]-=xStrokePad,box[1]-=yStrokePad,box[2]+=xStrokePad,box[3]+=yStrokePad}return box}updateClipFromPath(){const intersect=_util2.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(intersect||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(box){this.clipBox=box,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(pathType=_pattern_helper.PathType.FILL,transform=null){return _util2.Util.intersect(this.clipBox,this.getPathBoundingBox(pathType,transform))}}function putBinaryImageData(ctx,imgData,transferMaps=null){if(typeof ImageData<"u"&&imgData instanceof ImageData)return void ctx.putImageData(imgData,0,0);const height=imgData.height,width=imgData.width,partialChunkHeight=height%16,fullChunks=(height-partialChunkHeight)/16,totalChunks=0===partialChunkHeight?fullChunks:fullChunks+1,chunkImgData=ctx.createImageData(width,16);let destPos,srcPos=0;const src=imgData.data,dest=chunkImgData.data;let i,j,thisChunkHeight,elemsInThisChunk,transferMapRed,transferMapGreen,transferMapBlue,transferMapGray;if(transferMaps)switch(transferMaps.length){case 1:transferMapRed=transferMaps[0],transferMapGreen=transferMaps[0],transferMapBlue=transferMaps[0],transferMapGray=transferMaps[0];break;case 4:transferMapRed=transferMaps[0],transferMapGreen=transferMaps[1],transferMapBlue=transferMaps[2],transferMapGray=transferMaps[3]}if(imgData.kind===_util2.ImageKind.GRAYSCALE_1BPP){const srcLength=src.byteLength,dest32=new Uint32Array(dest.buffer,0,dest.byteLength>>2),dest32DataLength=dest32.length,fullSrcDiff=width+7>>3;let white=4294967295,black=_util2.FeatureTest.isLittleEndian?4278190080:255;for(transferMapGray&&255===transferMapGray[0]&&0===transferMapGray[255]&&([white,black]=[black,white]),i=0;i<totalChunks;i++){for(thisChunkHeight=i<fullChunks?16:partialChunkHeight,destPos=0,j=0;j<thisChunkHeight;j++){const srcDiff=srcLength-srcPos;let k=0;const kEnd=srcDiff>fullSrcDiff?width:8*srcDiff-7,kEndUnrolled=-8&kEnd;let mask=0,srcByte=0;for(;k<kEndUnrolled;k+=8)srcByte=src[srcPos++],dest32[destPos++]=128&srcByte?white:black,dest32[destPos++]=64&srcByte?white:black,dest32[destPos++]=32&srcByte?white:black,dest32[destPos++]=16&srcByte?white:black,dest32[destPos++]=8&srcByte?white:black,dest32[destPos++]=4&srcByte?white:black,dest32[destPos++]=2&srcByte?white:black,dest32[destPos++]=1&srcByte?white:black;for(;k<kEnd;k++)0===mask&&(srcByte=src[srcPos++],mask=128),dest32[destPos++]=srcByte&mask?white:black,mask>>=1}for(;destPos<dest32DataLength;)dest32[destPos++]=0;ctx.putImageData(chunkImgData,0,16*i)}}else if(imgData.kind===_util2.ImageKind.RGBA_32BPP){const hasTransferMaps=!!(transferMapRed||transferMapGreen||transferMapBlue);for(j=0,elemsInThisChunk=16*width*4,i=0;i<fullChunks;i++){if(dest.set(src.subarray(srcPos,srcPos+elemsInThisChunk)),srcPos+=elemsInThisChunk,hasTransferMaps)for(let k=0;k<elemsInThisChunk;k+=4)transferMapRed&&(dest[k+0]=transferMapRed[dest[k+0]]),transferMapGreen&&(dest[k+1]=transferMapGreen[dest[k+1]]),transferMapBlue&&(dest[k+2]=transferMapBlue[dest[k+2]]);ctx.putImageData(chunkImgData,0,j),j+=16}if(i<totalChunks){if(elemsInThisChunk=width*partialChunkHeight*4,dest.set(src.subarray(srcPos,srcPos+elemsInThisChunk)),hasTransferMaps)for(let k=0;k<elemsInThisChunk;k+=4)transferMapRed&&(dest[k+0]=transferMapRed[dest[k+0]]),transferMapGreen&&(dest[k+1]=transferMapGreen[dest[k+1]]),transferMapBlue&&(dest[k+2]=transferMapBlue[dest[k+2]]);ctx.putImageData(chunkImgData,0,j)}}else{if(imgData.kind!==_util2.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${imgData.kind}`);{const hasTransferMaps=!!(transferMapRed||transferMapGreen||transferMapBlue);for(thisChunkHeight=16,elemsInThisChunk=width*thisChunkHeight,i=0;i<totalChunks;i++){for(i>=fullChunks&&(thisChunkHeight=partialChunkHeight,elemsInThisChunk=width*thisChunkHeight),destPos=0,j=elemsInThisChunk;j--;)dest[destPos++]=src[srcPos++],dest[destPos++]=src[srcPos++],dest[destPos++]=src[srcPos++],dest[destPos++]=255;if(hasTransferMaps)for(let k=0;k<destPos;k+=4)transferMapRed&&(dest[k+0]=transferMapRed[dest[k+0]]),transferMapGreen&&(dest[k+1]=transferMapGreen[dest[k+1]]),transferMapBlue&&(dest[k+2]=transferMapBlue[dest[k+2]]);ctx.putImageData(chunkImgData,0,16*i)}}}}function putBinaryImageMask(ctx,imgData){if(imgData.bitmap)return void ctx.drawImage(imgData.bitmap,0,0);const height=imgData.height,width=imgData.width,partialChunkHeight=height%16,fullChunks=(height-partialChunkHeight)/16,totalChunks=0===partialChunkHeight?fullChunks:fullChunks+1,chunkImgData=ctx.createImageData(width,16);let srcPos=0;const src=imgData.data,dest=chunkImgData.data;for(let i=0;i<totalChunks;i++){const thisChunkHeight=i<fullChunks?16:partialChunkHeight;({srcPos}=(0,_image_utils.applyMaskImageData)({src,srcPos,dest,width,height:thisChunkHeight})),ctx.putImageData(chunkImgData,0,16*i)}}function copyCtxState(sourceCtx,destCtx){const properties=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let i=0,ii=properties.length;i<ii;i++){const property=properties[i];void 0!==sourceCtx[property]&&(destCtx[property]=sourceCtx[property])}void 0!==sourceCtx.setLineDash&&(destCtx.setLineDash(sourceCtx.getLineDash()),destCtx.lineDashOffset=sourceCtx.lineDashOffset)}function resetCtxToDefault(ctx,foregroundColor){ctx.strokeStyle=ctx.fillStyle=foregroundColor||"#000000",ctx.fillRule="nonzero",ctx.globalAlpha=1,ctx.lineWidth=1,ctx.lineCap="butt",ctx.lineJoin="miter",ctx.miterLimit=10,ctx.globalCompositeOperation="source-over",ctx.font="10px sans-serif",void 0!==ctx.setLineDash&&(ctx.setLineDash([]),ctx.lineDashOffset=0)}function composeSMaskBackdrop(bytes,r0,g0,b0){const length=bytes.length;for(let i=3;i<length;i+=4){const alpha=bytes[i];if(0===alpha)bytes[i-3]=r0,bytes[i-2]=g0,bytes[i-1]=b0;else if(alpha<255){const alpha_=255-alpha;bytes[i-3]=bytes[i-3]*alpha+r0*alpha_>>8,bytes[i-2]=bytes[i-2]*alpha+g0*alpha_>>8,bytes[i-1]=bytes[i-1]*alpha+b0*alpha_>>8}}}function composeSMaskAlpha(maskData,layerData,transferMap){const length=maskData.length;for(let i=3;i<length;i+=4)layerData[i]=layerData[i]*(transferMap?transferMap[maskData[i]]:maskData[i])*.00392156862745098|0}function composeSMaskLuminosity(maskData,layerData,transferMap){const length=maskData.length;for(let i=3;i<length;i+=4){const y=77*maskData[i-3]+152*maskData[i-2]+28*maskData[i-1];layerData[i]=transferMap?layerData[i]*transferMap[y>>8]>>8:layerData[i]*y>>16}}function getImageSmoothingEnabled(transform,interpolate){const scale=_util2.Util.singularValueDecompose2dScale(transform);scale[0]=Math.fround(scale[0]),scale[1]=Math.fround(scale[1]);const actualScale=Math.fround((globalThis.devicePixelRatio||1)*_display_utils2.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==interpolate?interpolate:scale[0]<=actualScale||scale[1]<=actualScale}const LINE_CAP_STYLES=["butt","round","square"],LINE_JOIN_STYLES=["miter","round","bevel"],NORMAL_CLIP={},EO_CLIP={};class CanvasGraphics{constructor(canvasCtx,commonObjs,objs,canvasFactory,imageLayer,optionalContentConfig,annotationCanvasMap,pageColors){this.ctx=canvasCtx,this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=commonObjs,this.objs=objs,this.canvasFactory=canvasFactory,this.imageLayer=imageLayer,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=optionalContentConfig,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=annotationCanvasMap,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=pageColors?.background||null,this.foregroundColor=pageColors?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(data,fallback=null){return"string"==typeof data?data.startsWith("g_")?this.commonObjs.get(data):this.objs.get(data):fallback}beginDrawing({transform,viewport,transparency=!1,background=null}){const width=this.ctx.canvas.width,height=this.ctx.canvas.height,defaultBackgroundColor=background||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const fg=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const bg=this.backgroundColor=this.ctx.fillStyle;let isValidDefaultBg=!0,defaultBg=defaultBackgroundColor;if(this.ctx.fillStyle=defaultBackgroundColor,defaultBg=this.ctx.fillStyle,isValidDefaultBg="string"==typeof defaultBg&&/^#[0-9A-Fa-f]{6}$/.test(defaultBg),"#000000"===fg&&"#ffffff"===bg||fg===bg||!isValidDefaultBg)this.foregroundColor=this.backgroundColor=null;else{const[rB,gB,bB]=(0,_display_utils2.getRGB)(defaultBg),newComp=x=>(x/=255)<=.03928?x/12.92:((x+.055)/1.055)**2.4,lumB=Math.round(.2126*newComp(rB)+.7152*newComp(gB)+.0722*newComp(bB));this.selectColor=(r,g,b)=>{const lumC=.2126*newComp(r)+.7152*newComp(g)+.0722*newComp(b);return Math.round(lumC)===lumB?bg:fg}}}if(this.ctx.fillStyle=this.backgroundColor||defaultBackgroundColor,this.ctx.fillRect(0,0,width,height),this.ctx.restore(),transparency){const transparentCanvas=this.cachedCanvases.getCanvas("transparent",width,height);this.compositeCtx=this.ctx,this.transparentCanvas=transparentCanvas.canvas,this.ctx=transparentCanvas.context,this.ctx.save(),this.ctx.transform(...(0,_display_utils2.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),resetCtxToDefault(this.ctx,this.foregroundColor),transform&&(this.ctx.transform(...transform),this.outputScaleX=transform[0],this.outputScaleY=transform[0]),this.ctx.transform(...viewport.transform),this.viewportScale=viewport.scale,this.baseTransform=(0,_display_utils2.getCurrentTransform)(this.ctx),this.imageLayer&&((0,_display_utils2.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(operatorList,executionStartIdx,continueCallback,stepper){const argsArray=operatorList.argsArray,fnArray=operatorList.fnArray;let i=executionStartIdx||0;const argsArrayLen=argsArray.length;if(argsArrayLen===i)return i;const chunkOperations=argsArrayLen-i>10&&"function"==typeof continueCallback,endTime=chunkOperations?Date.now()+15:0;let steps=0;const commonObjs=this.commonObjs,objs=this.objs;let fnId;for(;;){if(void 0!==stepper&&i===stepper.nextBreakPoint)return stepper.breakIt(i,continueCallback),i;if(fnId=fnArray[i],fnId!==_util2.OPS.dependency)this[fnId].apply(this,argsArray[i]);else for(const depObjId of argsArray[i]){const objsPool=depObjId.startsWith("g_")?commonObjs:objs;if(!objsPool.has(depObjId))return objsPool.get(depObjId,continueCallback),i}if(i++,i===argsArrayLen)return i;if(chunkOperations&&++steps>10){if(Date.now()>endTime)return continueCallback(),i;steps=0}}}#restoreInitialState(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#restoreInitialState(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const cache of this._cachedBitmapsMap.values()){for(const canvas of cache.values())typeof HTMLCanvasElement<"u"&&canvas instanceof HTMLCanvasElement&&(canvas.width=canvas.height=0);cache.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(img,inverseTransform){const width=img.width,height=img.height;let tmpCanvas,tmpCtx,widthScale=Math.max(Math.hypot(inverseTransform[0],inverseTransform[1]),1),heightScale=Math.max(Math.hypot(inverseTransform[2],inverseTransform[3]),1),paintWidth=width,paintHeight=height,tmpCanvasId="prescale1";for(;widthScale>2&&paintWidth>1||heightScale>2&&paintHeight>1;){let newWidth=paintWidth,newHeight=paintHeight;widthScale>2&&paintWidth>1&&(newWidth=Math.ceil(paintWidth/2),widthScale/=paintWidth/newWidth),heightScale>2&&paintHeight>1&&(newHeight=Math.ceil(paintHeight/2),heightScale/=paintHeight/newHeight),tmpCanvas=this.cachedCanvases.getCanvas(tmpCanvasId,newWidth,newHeight),tmpCtx=tmpCanvas.context,tmpCtx.clearRect(0,0,newWidth,newHeight),tmpCtx.drawImage(img,0,0,paintWidth,paintHeight,0,0,newWidth,newHeight),img=tmpCanvas.canvas,paintWidth=newWidth,paintHeight=newHeight,tmpCanvasId="prescale1"===tmpCanvasId?"prescale2":"prescale1"}return{img,paintWidth,paintHeight}}_createMaskCanvas(img){const ctx=this.ctx,{width,height}=img,fillColor=this.current.fillColor,isPatternFill=this.current.patternFill,currentTransform=(0,_display_utils2.getCurrentTransform)(ctx);let cache,cacheKey,scaled,maskCanvas;if((img.bitmap||img.data)&&img.count>1){const mainKey=img.bitmap||img.data.buffer,withoutTranslation=currentTransform.slice(0,4);cacheKey=JSON.stringify(isPatternFill?withoutTranslation:[withoutTranslation,fillColor]),cache=this._cachedBitmapsMap.get(mainKey),cache||(cache=new Map,this._cachedBitmapsMap.set(mainKey,cache));const cachedImage=cache.get(cacheKey);if(cachedImage&&!isPatternFill)return{canvas:cachedImage,offsetX:Math.round(Math.min(currentTransform[0],currentTransform[2])+currentTransform[4]),offsetY:Math.round(Math.min(currentTransform[1],currentTransform[3])+currentTransform[5])};scaled=cachedImage}scaled||(maskCanvas=this.cachedCanvases.getCanvas("maskCanvas",width,height),putBinaryImageMask(maskCanvas.context,img));let maskToCanvas=_util2.Util.transform(currentTransform,[1/width,0,0,-1/height,0,0]);maskToCanvas=_util2.Util.transform(maskToCanvas,[1,0,0,1,0,-height]);const cord1=_util2.Util.applyTransform([0,0],maskToCanvas),cord2=_util2.Util.applyTransform([width,height],maskToCanvas),rect=_util2.Util.normalizeRect([cord1[0],cord1[1],cord2[0],cord2[1]]),drawnWidth=Math.round(rect[2]-rect[0])||1,drawnHeight=Math.round(rect[3]-rect[1])||1,fillCanvas=this.cachedCanvases.getCanvas("fillCanvas",drawnWidth,drawnHeight),fillCtx=fillCanvas.context,offsetX=Math.min(cord1[0],cord2[0]),offsetY=Math.min(cord1[1],cord2[1]);fillCtx.translate(-offsetX,-offsetY),fillCtx.transform(...maskToCanvas),scaled||(scaled=this._scaleImage(maskCanvas.canvas,(0,_display_utils2.getCurrentTransformInverse)(fillCtx)),scaled=scaled.img,cache&&isPatternFill&&cache.set(cacheKey,scaled)),fillCtx.imageSmoothingEnabled=getImageSmoothingEnabled((0,_display_utils2.getCurrentTransform)(fillCtx),img.interpolate),drawImageAtIntegerCoords(fillCtx,scaled,0,0,scaled.width,scaled.height,0,0,width,height),fillCtx.globalCompositeOperation="source-in";const inverse=_util2.Util.transform((0,_display_utils2.getCurrentTransformInverse)(fillCtx),[1,0,0,1,-offsetX,-offsetY]);return fillCtx.fillStyle=isPatternFill?fillColor.getPattern(ctx,this,inverse,_pattern_helper.PathType.FILL):fillColor,fillCtx.fillRect(0,0,width,height),cache&&!isPatternFill&&(this.cachedCanvases.delete("fillCanvas"),cache.set(cacheKey,fillCanvas.canvas)),{canvas:fillCanvas.canvas,offsetX:Math.round(offsetX),offsetY:Math.round(offsetY)}}setLineWidth(width){width!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=width,this.ctx.lineWidth=width}setLineCap(style){this.ctx.lineCap=LINE_CAP_STYLES[style]}setLineJoin(style){this.ctx.lineJoin=LINE_JOIN_STYLES[style]}setMiterLimit(limit){this.ctx.miterLimit=limit}setDash(dashArray,dashPhase){const ctx=this.ctx;void 0!==ctx.setLineDash&&(ctx.setLineDash(dashArray),ctx.lineDashOffset=dashPhase)}setRenderingIntent(intent){}setFlatness(flatness){}setGState(states){for(let i=0,ii=states.length;i<ii;i++){const state=states[i],value=state[1];switch(state[0]){case"LW":this.setLineWidth(value);break;case"LC":this.setLineCap(value);break;case"LJ":this.setLineJoin(value);break;case"ML":this.setMiterLimit(value);break;case"D":this.setDash(value[0],value[1]);break;case"RI":this.setRenderingIntent(value);break;case"FL":this.setFlatness(value);break;case"Font":this.setFont(value[0],value[1]);break;case"CA":this.current.strokeAlpha=state[1];break;case"ca":this.current.fillAlpha=state[1],this.ctx.globalAlpha=state[1];break;case"BM":this.ctx.globalCompositeOperation=value;break;case"SMask":this.current.activeSMask=value?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=value}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const inSMaskMode=this.inSMaskMode;this.current.activeSMask&&!inSMaskMode?this.beginSMaskMode():!this.current.activeSMask&&inSMaskMode&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const scratchCanvas=this.cachedCanvases.getCanvas("smaskGroupAt"+this.groupLevel,this.ctx.canvas.width,this.ctx.canvas.height);this.suspendedCtx=this.ctx,this.ctx=scratchCanvas.context;const ctx=this.ctx;ctx.setTransform(...(0,_display_utils2.getCurrentTransform)(this.suspendedCtx)),copyCtxState(this.suspendedCtx,ctx),function mirrorContextOperations(ctx,destCtx){if(ctx._removeMirroring)throw new Error("Context is already forwarding operations.");ctx.__originalSave=ctx.save,ctx.__originalRestore=ctx.restore,ctx.__originalRotate=ctx.rotate,ctx.__originalScale=ctx.scale,ctx.__originalTranslate=ctx.translate,ctx.__originalTransform=ctx.transform,ctx.__originalSetTransform=ctx.setTransform,ctx.__originalResetTransform=ctx.resetTransform,ctx.__originalClip=ctx.clip,ctx.__originalMoveTo=ctx.moveTo,ctx.__originalLineTo=ctx.lineTo,ctx.__originalBezierCurveTo=ctx.bezierCurveTo,ctx.__originalRect=ctx.rect,ctx.__originalClosePath=ctx.closePath,ctx.__originalBeginPath=ctx.beginPath,ctx._removeMirroring=()=>{ctx.save=ctx.__originalSave,ctx.restore=ctx.__originalRestore,ctx.rotate=ctx.__originalRotate,ctx.scale=ctx.__originalScale,ctx.translate=ctx.__originalTranslate,ctx.transform=ctx.__originalTransform,ctx.setTransform=ctx.__originalSetTransform,ctx.resetTransform=ctx.__originalResetTransform,ctx.clip=ctx.__originalClip,ctx.moveTo=ctx.__originalMoveTo,ctx.lineTo=ctx.__originalLineTo,ctx.bezierCurveTo=ctx.__originalBezierCurveTo,ctx.rect=ctx.__originalRect,ctx.closePath=ctx.__originalClosePath,ctx.beginPath=ctx.__originalBeginPath,delete ctx._removeMirroring},ctx.save=function(){destCtx.save(),this.__originalSave()},ctx.restore=function(){destCtx.restore(),this.__originalRestore()},ctx.translate=function(x,y){destCtx.translate(x,y),this.__originalTranslate(x,y)},ctx.scale=function(x,y){destCtx.scale(x,y),this.__originalScale(x,y)},ctx.transform=function(a,b,c,d,e,f){destCtx.transform(a,b,c,d,e,f),this.__originalTransform(a,b,c,d,e,f)},ctx.setTransform=function(a,b,c,d,e,f){destCtx.setTransform(a,b,c,d,e,f),this.__originalSetTransform(a,b,c,d,e,f)},ctx.resetTransform=function(){destCtx.resetTransform(),this.__originalResetTransform()},ctx.rotate=function(angle){destCtx.rotate(angle),this.__originalRotate(angle)},ctx.clip=function(rule){destCtx.clip(rule),this.__originalClip(rule)},ctx.moveTo=function(x,y){destCtx.moveTo(x,y),this.__originalMoveTo(x,y)},ctx.lineTo=function(x,y){destCtx.lineTo(x,y),this.__originalLineTo(x,y)},ctx.bezierCurveTo=function(cp1x,cp1y,cp2x,cp2y,x,y){destCtx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y),this.__originalBezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)},ctx.rect=function(x,y,width,height){destCtx.rect(x,y,width,height),this.__originalRect(x,y,width,height)},ctx.closePath=function(){destCtx.closePath(),this.__originalClosePath()},ctx.beginPath=function(){destCtx.beginPath(),this.__originalBeginPath()}}(ctx,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),copyCtxState(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(dirtyBox){this.current.activeSMask&&(dirtyBox?(dirtyBox[0]=Math.floor(dirtyBox[0]),dirtyBox[1]=Math.floor(dirtyBox[1]),dirtyBox[2]=Math.ceil(dirtyBox[2]),dirtyBox[3]=Math.ceil(dirtyBox[3])):dirtyBox=[0,0,this.ctx.canvas.width,this.ctx.canvas.height],function composeSMask(ctx,smask,layerCtx,layerBox){const layerOffsetX=layerBox[0],layerOffsetY=layerBox[1],layerWidth=layerBox[2]-layerOffsetX,layerHeight=layerBox[3]-layerOffsetY;0===layerWidth||0===layerHeight||(function genericComposeSMask(maskCtx,layerCtx,width,height,subtype,backdrop,transferMap,layerOffsetX,layerOffsetY,maskOffsetX,maskOffsetY){const hasBackdrop=!!backdrop,r0=hasBackdrop?backdrop[0]:0,g0=hasBackdrop?backdrop[1]:0,b0=hasBackdrop?backdrop[2]:0;let composeFn;composeFn="Luminosity"===subtype?composeSMaskLuminosity:composeSMaskAlpha;const chunkSize=Math.min(height,Math.ceil(1048576/width));for(let row=0;row<height;row+=chunkSize){const chunkHeight=Math.min(chunkSize,height-row),maskData=maskCtx.getImageData(layerOffsetX-maskOffsetX,row+(layerOffsetY-maskOffsetY),width,chunkHeight),layerData=layerCtx.getImageData(layerOffsetX,row+layerOffsetY,width,chunkHeight);hasBackdrop&&composeSMaskBackdrop(maskData.data,r0,g0,b0),composeFn(maskData.data,layerData.data,transferMap),layerCtx.putImageData(layerData,layerOffsetX,row+layerOffsetY)}}(smask.context,layerCtx,layerWidth,layerHeight,smask.subtype,smask.backdrop,smask.transferMap,layerOffsetX,layerOffsetY,smask.offsetX,smask.offsetY),ctx.save(),ctx.globalAlpha=1,ctx.globalCompositeOperation="source-over",ctx.setTransform(1,0,0,1,0,0),ctx.drawImage(layerCtx.canvas,0,0),ctx.restore())}(this.suspendedCtx,this.current.activeSMask,this.ctx,dirtyBox),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore())}save(){this.inSMaskMode?(copyCtxState(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const old=this.current;this.stateStack.push(old),this.current=old.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),copyCtxState(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(a,b,c,d,e,f){this.ctx.transform(a,b,c,d,e,f),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(ops,args,minMax){const ctx=this.ctx,current=this.current;let startX,startY,x=current.x,y=current.y;const currentTransform=(0,_display_utils2.getCurrentTransform)(ctx),isScalingMatrix=0===currentTransform[0]&&0===currentTransform[3]||0===currentTransform[1]&&0===currentTransform[2],minMaxForBezier=isScalingMatrix?minMax.slice(0):null;for(let i=0,j=0,ii=ops.length;i<ii;i++)switch(0|ops[i]){case _util2.OPS.rectangle:x=args[j++],y=args[j++];const width=args[j++],height=args[j++],xw=x+width,yh=y+height;ctx.moveTo(x,y),0===width||0===height?ctx.lineTo(xw,yh):(ctx.lineTo(xw,y),ctx.lineTo(xw,yh),ctx.lineTo(x,yh)),isScalingMatrix||current.updateRectMinMax(currentTransform,[x,y,xw,yh]),ctx.closePath();break;case _util2.OPS.moveTo:x=args[j++],y=args[j++],ctx.moveTo(x,y),isScalingMatrix||current.updatePathMinMax(currentTransform,x,y);break;case _util2.OPS.lineTo:x=args[j++],y=args[j++],ctx.lineTo(x,y),isScalingMatrix||current.updatePathMinMax(currentTransform,x,y);break;case _util2.OPS.curveTo:startX=x,startY=y,x=args[j+4],y=args[j+5],ctx.bezierCurveTo(args[j],args[j+1],args[j+2],args[j+3],x,y),current.updateCurvePathMinMax(currentTransform,startX,startY,args[j],args[j+1],args[j+2],args[j+3],x,y,minMaxForBezier),j+=6;break;case _util2.OPS.curveTo2:startX=x,startY=y,ctx.bezierCurveTo(x,y,args[j],args[j+1],args[j+2],args[j+3]),current.updateCurvePathMinMax(currentTransform,startX,startY,x,y,args[j],args[j+1],args[j+2],args[j+3],minMaxForBezier),x=args[j+2],y=args[j+3],j+=4;break;case _util2.OPS.curveTo3:startX=x,startY=y,x=args[j+2],y=args[j+3],ctx.bezierCurveTo(args[j],args[j+1],x,y,x,y),current.updateCurvePathMinMax(currentTransform,startX,startY,args[j],args[j+1],x,y,x,y,minMaxForBezier),j+=4;break;case _util2.OPS.closePath:ctx.closePath()}isScalingMatrix&&current.updateScalingPathMinMax(currentTransform,minMaxForBezier),current.setCurrentPoint(x,y)}closePath(){this.ctx.closePath()}stroke(consumePath){consumePath=!(typeof consumePath<"u")||consumePath;const ctx=this.ctx,strokeColor=this.current.strokeColor;ctx.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof strokeColor&&strokeColor?.getPattern?(ctx.save(),ctx.strokeStyle=strokeColor.getPattern(ctx,this,(0,_display_utils2.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.STROKE),this.rescaleAndStroke(!1),ctx.restore()):this.rescaleAndStroke(!0)),consumePath&&this.consumePath(this.current.getClippedPathBoundingBox()),ctx.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(consumePath){consumePath=!(typeof consumePath<"u")||consumePath;const ctx=this.ctx,fillColor=this.current.fillColor;let needRestore=!1;this.current.patternFill&&(ctx.save(),ctx.fillStyle=fillColor.getPattern(ctx,this,(0,_display_utils2.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL),needRestore=!0);const intersect=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==intersect&&(this.pendingEOFill?(ctx.fill("evenodd"),this.pendingEOFill=!1):ctx.fill()),needRestore&&ctx.restore(),consumePath&&this.consumePath(intersect)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=NORMAL_CLIP}eoClip(){this.pendingClip=EO_CLIP}beginText(){this.current.textMatrix=_util2.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const paths=this.pendingTextPaths,ctx=this.ctx;if(void 0!==paths){ctx.save(),ctx.beginPath();for(const path of paths)ctx.setTransform(...path.transform),ctx.translate(path.x,path.y),path.addToPath(ctx,path.fontSize);ctx.restore(),ctx.clip(),ctx.beginPath(),delete this.pendingTextPaths}else ctx.beginPath()}setCharSpacing(spacing){this.current.charSpacing=spacing}setWordSpacing(spacing){this.current.wordSpacing=spacing}setHScale(scale){this.current.textHScale=scale/100}setLeading(leading){this.current.leading=-leading}setFont(fontRefName,size){const fontObj=this.commonObjs.get(fontRefName),current=this.current;if(!fontObj)throw new Error(`Can't find font for ${fontRefName}`);if(current.fontMatrix=fontObj.fontMatrix||_util2.FONT_IDENTITY_MATRIX,(0===current.fontMatrix[0]||0===current.fontMatrix[3])&&(0,_util2.warn)("Invalid font matrix for font "+fontRefName),size<0?(size=-size,current.fontDirection=-1):current.fontDirection=1,this.current.font=fontObj,this.current.fontSize=size,fontObj.isType3Font)return;let bold="normal";fontObj.black?bold="900":fontObj.bold&&(bold="bold");const italic=fontObj.italic?"italic":"normal",typeface=`"${fontObj.loadedName||"sans-serif"}", ${fontObj.fallbackName}`;let browserFontSize=size;size<16?browserFontSize=16:size>100&&(browserFontSize=100),this.current.fontSizeScale=size/browserFontSize,this.ctx.font=`${italic} ${bold} ${browserFontSize}px ${typeface}`}setTextRenderingMode(mode){this.current.textRenderingMode=mode}setTextRise(rise){this.current.textRise=rise}moveText(x,y){this.current.x=this.current.lineX+=x,this.current.y=this.current.lineY+=y}setLeadingMoveText(x,y){this.setLeading(-y),this.moveText(x,y)}setTextMatrix(a,b,c,d,e,f){this.current.textMatrix=[a,b,c,d,e,f],this.current.textMatrixScale=Math.hypot(a,b),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(character,x,y,patternTransform){const ctx=this.ctx,current=this.current,font=current.font,textRenderingMode=current.textRenderingMode,fontSize=current.fontSize/current.fontSizeScale,fillStrokeMode=textRenderingMode&_util2.TextRenderingMode.FILL_STROKE_MASK,isAddToPathSet=!!(textRenderingMode&_util2.TextRenderingMode.ADD_TO_PATH_FLAG),patternFill=current.patternFill&&!font.missingFile;let addToPath;(font.disableFontFace||isAddToPathSet||patternFill)&&(addToPath=font.getPathGenerator(this.commonObjs,character)),font.disableFontFace||patternFill?(ctx.save(),ctx.translate(x,y),ctx.beginPath(),addToPath(ctx,fontSize),patternTransform&&ctx.setTransform(...patternTransform),(fillStrokeMode===_util2.TextRenderingMode.FILL||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&ctx.fill(),(fillStrokeMode===_util2.TextRenderingMode.STROKE||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&ctx.stroke(),ctx.restore()):((fillStrokeMode===_util2.TextRenderingMode.FILL||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&ctx.fillText(character,x,y),(fillStrokeMode===_util2.TextRenderingMode.STROKE||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&ctx.strokeText(character,x,y)),isAddToPathSet&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_display_utils2.getCurrentTransform)(ctx),x,y,fontSize,addToPath})}get isFontSubpixelAAEnabled(){const{context:ctx}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ctx.scale(1.5,1),ctx.fillText("I",0,10);const data=ctx.getImageData(0,0,10,10).data;let enabled=!1;for(let i=3;i<data.length;i+=4)if(data[i]>0&&data[i]<255){enabled=!0;break}return(0,_util2.shadow)(this,"isFontSubpixelAAEnabled",enabled)}showText(glyphs){const current=this.current,font=current.font;if(font.isType3Font)return this.showType3Text(glyphs);const fontSize=current.fontSize;if(0===fontSize)return;const ctx=this.ctx,fontSizeScale=current.fontSizeScale,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,fontDirection=current.fontDirection,textHScale=current.textHScale*fontDirection,glyphsLength=glyphs.length,vertical=font.vertical,spacingDir=vertical?1:-1,defaultVMetrics=font.defaultVMetrics,widthAdvanceScale=fontSize*current.fontMatrix[0],simpleFillText=current.textRenderingMode===_util2.TextRenderingMode.FILL&&!font.disableFontFace&&!current.patternFill;let patternTransform;if(ctx.save(),ctx.transform(...current.textMatrix),ctx.translate(current.x,current.y+current.textRise),ctx.scale(textHScale,fontDirection>0?-1:1),current.patternFill){ctx.save();const pattern=current.fillColor.getPattern(ctx,this,(0,_display_utils2.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL);patternTransform=(0,_display_utils2.getCurrentTransform)(ctx),ctx.restore(),ctx.fillStyle=pattern}let lineWidth=current.lineWidth;const scale=current.textMatrixScale;if(0===scale||0===lineWidth){const fillStrokeMode=current.textRenderingMode&_util2.TextRenderingMode.FILL_STROKE_MASK;(fillStrokeMode===_util2.TextRenderingMode.STROKE||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&(lineWidth=this.getSinglePixelWidth())}else lineWidth/=scale;1!==fontSizeScale&&(ctx.scale(fontSizeScale,fontSizeScale),lineWidth/=fontSizeScale),ctx.lineWidth=lineWidth;let i,x=0;for(i=0;i<glyphsLength;++i){const glyph=glyphs[i];if("number"==typeof glyph){x+=spacingDir*glyph*fontSize/1e3;continue}let restoreNeeded=!1;const spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,character=glyph.fontChar,accent=glyph.accent;let scaledX,scaledY,charWidth,width=glyph.width;if(vertical){const vmetric=glyph.vmetric||defaultVMetrics,vx=-(glyph.vmetric?vmetric[1]:.5*width)*widthAdvanceScale;width=vmetric?-vmetric[0]:width,scaledX=vx/fontSizeScale,scaledY=(x+vmetric[2]*widthAdvanceScale)/fontSizeScale}else scaledX=x/fontSizeScale,scaledY=0;if(font.remeasure&&width>0){const measuredWidth=1e3*ctx.measureText(character).width/fontSize*fontSizeScale;if(width<measuredWidth&&this.isFontSubpixelAAEnabled){const characterScaleX=width/measuredWidth;restoreNeeded=!0,ctx.save(),ctx.scale(characterScaleX,1),scaledX/=characterScaleX}else width!==measuredWidth&&(scaledX+=(width-measuredWidth)/2e3*fontSize/fontSizeScale)}this.contentVisible&&(glyph.isInFont||font.missingFile)&&(simpleFillText&&!accent?ctx.fillText(character,scaledX,scaledY):(this.paintChar(character,scaledX,scaledY,patternTransform),accent&&this.paintChar(accent.fontChar,scaledX+fontSize*accent.offset.x/fontSizeScale,scaledY-fontSize*accent.offset.y/fontSizeScale,patternTransform))),charWidth=vertical?width*widthAdvanceScale-spacing*fontDirection:width*widthAdvanceScale+spacing*fontDirection,x+=charWidth,restoreNeeded&&ctx.restore()}vertical?current.y-=x:current.x+=x*textHScale,ctx.restore(),this.compose()}showType3Text(glyphs){const ctx=this.ctx,current=this.current,font=current.font,fontSize=current.fontSize,fontDirection=current.fontDirection,spacingDir=font.vertical?1:-1,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,textHScale=current.textHScale*fontDirection,fontMatrix=current.fontMatrix||_util2.FONT_IDENTITY_MATRIX,glyphsLength=glyphs.length;let i,glyph,width,spacingLength;if(current.textRenderingMode!==_util2.TextRenderingMode.INVISIBLE&&0!==fontSize){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,ctx.save(),ctx.transform(...current.textMatrix),ctx.translate(current.x,current.y),ctx.scale(textHScale,fontDirection),i=0;i<glyphsLength;++i){if(glyph=glyphs[i],"number"==typeof glyph){spacingLength=spacingDir*glyph*fontSize/1e3,this.ctx.translate(spacingLength,0),current.x+=spacingLength*textHScale;continue}const spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,operatorList=font.charProcOperatorList[glyph.operatorListId];operatorList?(this.contentVisible&&(this.processingType3=glyph,this.save(),ctx.scale(fontSize,fontSize),ctx.transform(...fontMatrix),this.executeOperatorList(operatorList),this.restore()),width=_util2.Util.applyTransform([glyph.width,0],fontMatrix)[0]*fontSize+spacing,ctx.translate(width,0),current.x+=width*textHScale):(0,_util2.warn)(`Type3 character "${glyph.operatorListId}" is not available.`)}ctx.restore(),this.processingType3=null}}setCharWidth(xWidth,yWidth){}setCharWidthAndBounds(xWidth,yWidth,llx,lly,urx,ury){this.ctx.rect(llx,lly,urx-llx,ury-lly),this.ctx.clip(),this.endPath()}getColorN_Pattern(IR){let pattern;if("TilingPattern"===IR[0]){const color=IR[1],baseTransform=this.baseTransform||(0,_display_utils2.getCurrentTransform)(this.ctx);pattern=new _pattern_helper.TilingPattern(IR,color,this.ctx,{createCanvasGraphics:ctx=>new CanvasGraphics(ctx,this.commonObjs,this.objs,this.canvasFactory)},baseTransform)}else pattern=this._getPattern(IR[1],IR[2]);return pattern}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(r,g,b){const color=this.selectColor?.(r,g,b)||_util2.Util.makeHexColor(r,g,b);this.ctx.strokeStyle=color,this.current.strokeColor=color}setFillRGBColor(r,g,b){const color=this.selectColor?.(r,g,b)||_util2.Util.makeHexColor(r,g,b);this.ctx.fillStyle=color,this.current.fillColor=color,this.current.patternFill=!1}_getPattern(objId,matrix=null){let pattern;return this.cachedPatterns.has(objId)?pattern=this.cachedPatterns.get(objId):(pattern=(0,_pattern_helper.getShadingPattern)(this.objs.get(objId)),this.cachedPatterns.set(objId,pattern)),matrix&&(pattern.matrix=matrix),pattern}shadingFill(objId){if(!this.contentVisible)return;const ctx=this.ctx;this.save();const pattern=this._getPattern(objId);ctx.fillStyle=pattern.getPattern(ctx,this,(0,_display_utils2.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.SHADING);const inv=(0,_display_utils2.getCurrentTransformInverse)(ctx);if(inv){const canvas=ctx.canvas,width=canvas.width,height=canvas.height,bl=_util2.Util.applyTransform([0,0],inv),br=_util2.Util.applyTransform([0,height],inv),ul=_util2.Util.applyTransform([width,0],inv),ur=_util2.Util.applyTransform([width,height],inv),x0=Math.min(bl[0],br[0],ul[0],ur[0]),y0=Math.min(bl[1],br[1],ul[1],ur[1]),x1=Math.max(bl[0],br[0],ul[0],ur[0]),y1=Math.max(bl[1],br[1],ul[1],ur[1]);this.ctx.fillRect(x0,y0,x1-x0,y1-y0)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,_util2.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,_util2.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(matrix,bbox){this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(matrix)&&6===matrix.length&&this.transform(...matrix),this.baseTransform=(0,_display_utils2.getCurrentTransform)(this.ctx),bbox)&&(this.ctx.rect(bbox[0],bbox[1],bbox[2]-bbox[0],bbox[3]-bbox[1]),this.current.updateRectMinMax((0,_display_utils2.getCurrentTransform)(this.ctx),bbox),this.clip(),this.endPath())}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(group){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const currentCtx=this.ctx;group.isolated||(0,_util2.info)("TODO: Support non-isolated groups."),group.knockout&&(0,_util2.warn)("Knockout groups not supported.");const currentTransform=(0,_display_utils2.getCurrentTransform)(currentCtx);if(group.matrix&&currentCtx.transform(...group.matrix),!group.bbox)throw new Error("Bounding box is required.");let bounds=_util2.Util.getAxialAlignedBoundingBox(group.bbox,(0,_display_utils2.getCurrentTransform)(currentCtx));bounds=_util2.Util.intersect(bounds,[0,0,currentCtx.canvas.width,currentCtx.canvas.height])||[0,0,0,0];const offsetX=Math.floor(bounds[0]),offsetY=Math.floor(bounds[1]);let drawnWidth=Math.max(Math.ceil(bounds[2])-offsetX,1),drawnHeight=Math.max(Math.ceil(bounds[3])-offsetY,1),scaleX=1,scaleY=1;drawnWidth>4096&&(scaleX=drawnWidth/4096,drawnWidth=4096),drawnHeight>4096&&(scaleY=drawnHeight/4096,drawnHeight=4096),this.current.startNewPathAndClipBox([0,0,drawnWidth,drawnHeight]);let cacheId="groupAt"+this.groupLevel;group.smask&&(cacheId+="_smask_"+this.smaskCounter++%2);const scratchCanvas=this.cachedCanvases.getCanvas(cacheId,drawnWidth,drawnHeight),groupCtx=scratchCanvas.context;groupCtx.scale(1/scaleX,1/scaleY),groupCtx.translate(-offsetX,-offsetY),groupCtx.transform(...currentTransform),group.smask?this.smaskStack.push({canvas:scratchCanvas.canvas,context:groupCtx,offsetX,offsetY,scaleX,scaleY,subtype:group.smask.subtype,backdrop:group.smask.backdrop,transferMap:group.smask.transferMap||null,startTransformInverse:null}):(currentCtx.setTransform(1,0,0,1,0,0),currentCtx.translate(offsetX,offsetY),currentCtx.scale(scaleX,scaleY),currentCtx.save()),copyCtxState(currentCtx,groupCtx),this.ctx=groupCtx,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(currentCtx),this.groupLevel++}endGroup(group){if(!this.contentVisible)return;this.groupLevel--;const groupCtx=this.ctx,ctx=this.groupStack.pop();if(this.ctx=ctx,this.ctx.imageSmoothingEnabled=!1,group.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const currentMtx=(0,_display_utils2.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...currentMtx);const dirtyBox=_util2.Util.getAxialAlignedBoundingBox([0,0,groupCtx.canvas.width,groupCtx.canvas.height],currentMtx);this.ctx.drawImage(groupCtx.canvas,0,0),this.ctx.restore(),this.compose(dirtyBox)}}beginAnnotation(id,rect,transform,matrix,hasOwnCanvas){if(this.#restoreInitialState(),resetCtxToDefault(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(rect)&&4===rect.length){const width=rect[2]-rect[0],height=rect[3]-rect[1];if(hasOwnCanvas&&this.annotationCanvasMap){(transform=transform.slice())[4]-=rect[0],transform[5]-=rect[1],(rect=rect.slice())[0]=rect[1]=0,rect[2]=width,rect[3]=height;const[scaleX,scaleY]=_util2.Util.singularValueDecompose2dScale((0,_display_utils2.getCurrentTransform)(this.ctx)),{viewportScale}=this,canvasWidth=Math.ceil(width*this.outputScaleX*viewportScale),canvasHeight=Math.ceil(height*this.outputScaleY*viewportScale);this.annotationCanvas=this.canvasFactory.create(canvasWidth,canvasHeight);const{canvas,context}=this.annotationCanvas;this.annotationCanvasMap.set(id,canvas),this.annotationCanvas.savedCtx=this.ctx,this.ctx=context,this.ctx.setTransform(scaleX,0,0,-scaleY,0,height*scaleY),resetCtxToDefault(this.ctx,this.foregroundColor)}else resetCtxToDefault(this.ctx,this.foregroundColor),this.ctx.rect(rect[0],rect[1],width,height),this.ctx.clip(),this.endPath()}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...transform),this.transform(...matrix)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(img){if(!this.contentVisible)return;const count=img.count;(img=this.getObject(img.data,img)).count=count;const ctx=this.ctx,glyph=this.processingType3;if(glyph&&(void 0===glyph.compiled&&(glyph.compiled=function compileType3Glyph(imgData){const{width,height}=imgData;if(width>MAX_SIZE_TO_COMPILE||height>MAX_SIZE_TO_COMPILE)return null;const POINT_TYPES=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),width1=width+1;let i,j,j0,points=new Uint8Array(width1*(height+1));const lineSize=width+7&-8;let data=new Uint8Array(lineSize*height),pos=0;for(const elem of imgData.data){let mask=128;for(;mask>0;)data[pos++]=elem&mask?0:255,mask>>=1}let count=0;for(pos=0,0!==data[pos]&&(points[0]=1,++count),j=1;j<width;j++)data[pos]!==data[pos+1]&&(points[j]=data[pos]?2:1,++count),pos++;for(0!==data[pos]&&(points[j]=2,++count),i=1;i<height;i++){pos=i*lineSize,j0=i*width1,data[pos-lineSize]!==data[pos]&&(points[j0]=data[pos]?1:8,++count);let sum=(data[pos]?4:0)+(data[pos-lineSize]?8:0);for(j=1;j<width;j++)sum=(sum>>2)+(data[pos+1]?4:0)+(data[pos-lineSize+1]?8:0),POINT_TYPES[sum]&&(points[j0+j]=POINT_TYPES[sum],++count),pos++;if(data[pos-lineSize]!==data[pos]&&(points[j0+j]=data[pos]?2:4,++count),count>1e3)return null}for(pos=lineSize*(height-1),j0=i*width1,0!==data[pos]&&(points[j0]=8,++count),j=1;j<width;j++)data[pos]!==data[pos+1]&&(points[j0+j]=data[pos]?4:8,++count),pos++;if(0!==data[pos]&&(points[j0+j]=4,++count),count>1e3)return null;const steps=new Int32Array([0,width1,-1,0,-width1,0,0,0,1]),path=new Path2D;for(i=0;count&&i<=height;i++){let p=i*width1;const end=p+width;for(;p<end&&!points[p];)p++;if(p===end)continue;path.moveTo(p%width1,i);const p0=p;let type=points[p];do{const step=steps[type];do{p+=step}while(!points[p]);const pp=points[p];5!==pp&&10!==pp?(type=pp,points[p]=0):(type=pp&51*type>>4,points[p]&=type>>2|type<<2),path.lineTo(p%width1,p/width1|0),points[p]||--count}while(p0!==p);--i}return data=null,points=null,function(c){c.save(),c.scale(1/width,-1/height),c.translate(0,-height),c.fill(path),c.beginPath(),c.restore()}}(img)),glyph.compiled))return void glyph.compiled(ctx);const mask=this._createMaskCanvas(img),maskCanvas=mask.canvas;ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.drawImage(maskCanvas,mask.offsetX,mask.offsetY),ctx.restore(),this.compose()}paintImageMaskXObjectRepeat(img,scaleX,skewX=0,skewY=0,scaleY,positions){if(!this.contentVisible)return;img=this.getObject(img.data,img);const ctx=this.ctx;ctx.save();const currentTransform=(0,_display_utils2.getCurrentTransform)(ctx);ctx.transform(scaleX,skewX,skewY,scaleY,0,0);const mask=this._createMaskCanvas(img);ctx.setTransform(1,0,0,1,0,0);for(let i=0,ii=positions.length;i<ii;i+=2){const trans=_util2.Util.transform(currentTransform,[scaleX,skewX,skewY,scaleY,positions[i],positions[i+1]]),[x,y]=_util2.Util.applyTransform([0,0],trans);ctx.drawImage(mask.canvas,x,y)}ctx.restore(),this.compose()}paintImageMaskXObjectGroup(images){if(!this.contentVisible)return;const ctx=this.ctx,fillColor=this.current.fillColor,isPatternFill=this.current.patternFill;for(const image of images){const{data,width,height,transform}=image,maskCanvas=this.cachedCanvases.getCanvas("maskCanvas",width,height),maskCtx=maskCanvas.context;maskCtx.save(),putBinaryImageMask(maskCtx,this.getObject(data,image)),maskCtx.globalCompositeOperation="source-in",maskCtx.fillStyle=isPatternFill?fillColor.getPattern(maskCtx,this,(0,_display_utils2.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL):fillColor,maskCtx.fillRect(0,0,width,height),maskCtx.restore(),ctx.save(),ctx.transform(...transform),ctx.scale(1,-1),drawImageAtIntegerCoords(ctx,maskCanvas.canvas,0,0,width,height,0,-1,1,1),ctx.restore()}this.compose()}paintImageXObject(objId){if(!this.contentVisible)return;const imgData=this.getObject(objId);imgData?this.paintInlineImageXObject(imgData):(0,_util2.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(objId,scaleX,scaleY,positions){if(!this.contentVisible)return;const imgData=this.getObject(objId);if(!imgData)return void(0,_util2.warn)("Dependent image isn't ready yet");const width=imgData.width,height=imgData.height,map=[];for(let i=0,ii=positions.length;i<ii;i+=2)map.push({transform:[scaleX,0,0,scaleY,positions[i],positions[i+1]],x:0,y:0,w:width,h:height});this.paintInlineImageXObjectGroup(imgData,map)}paintInlineImageXObject(imgData){if(!this.contentVisible)return;const width=imgData.width,height=imgData.height,ctx=this.ctx;let imgToPaint;if(this.save(),ctx.scale(1/width,-1/height),"function"==typeof HTMLElement&&imgData instanceof HTMLElement||!imgData.data)imgToPaint=imgData;else{const tmpCanvas=this.cachedCanvases.getCanvas("inlineImage",width,height);putBinaryImageData(tmpCanvas.context,imgData,this.current.transferMaps),imgToPaint=tmpCanvas.canvas}const scaled=this._scaleImage(imgToPaint,(0,_display_utils2.getCurrentTransformInverse)(ctx));ctx.imageSmoothingEnabled=getImageSmoothingEnabled((0,_display_utils2.getCurrentTransform)(ctx),imgData.interpolate);const[rWidth,rHeight]=drawImageAtIntegerCoords(ctx,scaled.img,0,0,scaled.paintWidth,scaled.paintHeight,0,-height,width,height);if(this.imageLayer){const[left,top]=_util2.Util.applyTransform([0,-height],(0,_display_utils2.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData,left,top,width:rWidth,height:rHeight})}this.compose(),this.restore()}paintInlineImageXObjectGroup(imgData,map){if(!this.contentVisible)return;const ctx=this.ctx,w=imgData.width,h=imgData.height,tmpCanvas=this.cachedCanvases.getCanvas("inlineImage",w,h);putBinaryImageData(tmpCanvas.context,imgData,this.current.transferMaps);for(const entry of map){if(ctx.save(),ctx.transform(...entry.transform),ctx.scale(1,-1),drawImageAtIntegerCoords(ctx,tmpCanvas.canvas,entry.x,entry.y,entry.w,entry.h,0,-1,1,1),this.imageLayer){const[left,top]=_util2.Util.applyTransform([entry.x,entry.y],(0,_display_utils2.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData,left,top,width:w,height:h})}ctx.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(tag){}markPointProps(tag,properties){}beginMarkedContent(tag){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(tag,properties){this.markedContentStack.push("OC"===tag?{visible:this.optionalContentConfig.isVisible(properties)}:{visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(clipBox){const isEmpty=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(clipBox);const ctx=this.ctx;this.pendingClip&&(isEmpty||(this.pendingClip===EO_CLIP?ctx.clip("evenodd"):ctx.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),ctx.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const m=(0,_display_utils2.getCurrentTransform)(this.ctx);if(0===m[1]&&0===m[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(m[0]),Math.abs(m[3]));else{const absDet=Math.abs(m[0]*m[3]-m[2]*m[1]),normX=Math.hypot(m[0],m[2]),normY=Math.hypot(m[1],m[3]);this._cachedGetSinglePixelWidth=Math.max(normX,normY)/absDet}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth}=this.current,m=(0,_display_utils2.getCurrentTransform)(this.ctx);let scaleX,scaleY;if(0===m[1]&&0===m[2]){const normX=Math.abs(m[0]),normY=Math.abs(m[3]);if(0===lineWidth)scaleX=1/normX,scaleY=1/normY;else{const scaledXLineWidth=normX*lineWidth,scaledYLineWidth=normY*lineWidth;scaleX=scaledXLineWidth<1?1/scaledXLineWidth:1,scaleY=scaledYLineWidth<1?1/scaledYLineWidth:1}}else{const absDet=Math.abs(m[0]*m[3]-m[2]*m[1]),normX=Math.hypot(m[0],m[1]),normY=Math.hypot(m[2],m[3]);if(0===lineWidth)scaleX=normY/absDet,scaleY=normX/absDet;else{const baseArea=lineWidth*absDet;scaleX=normY>baseArea?normY/baseArea:1,scaleY=normX>baseArea?normX/baseArea:1}}this._cachedScaleForStroking=[scaleX,scaleY]}return this._cachedScaleForStroking}rescaleAndStroke(saveRestore){const{ctx}=this,{lineWidth}=this.current,[scaleX,scaleY]=this.getScaleForStroking();if(ctx.lineWidth=lineWidth||1,1===scaleX&&1===scaleY)return void ctx.stroke();let savedMatrix,savedDashes,savedDashOffset;saveRestore&&(savedMatrix=(0,_display_utils2.getCurrentTransform)(ctx),savedDashes=ctx.getLineDash().slice(),savedDashOffset=ctx.lineDashOffset),ctx.scale(scaleX,scaleY);const scale=Math.max(scaleX,scaleY);ctx.setLineDash(ctx.getLineDash().map(x=>x/scale)),ctx.lineDashOffset/=scale,ctx.stroke(),saveRestore&&(ctx.setTransform(...savedMatrix),ctx.setLineDash(savedDashes),ctx.lineDashOffset=savedDashOffset)}isContentVisible(){for(let i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}}exports2.CanvasGraphics=CanvasGraphics;for(const op in _util2.OPS)void 0!==CanvasGraphics.prototype[op]&&(CanvasGraphics.prototype[_util2.OPS[op]]=CanvasGraphics.prototype[op])},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.TilingPattern=exports2.PathType=void 0,exports2.getShadingPattern=function getShadingPattern(IR){switch(IR[0]){case"RadialAxial":return new RadialAxialShadingPattern(IR);case"Mesh":return new MeshShadingPattern(IR);case"Dummy":return new DummyShadingPattern}throw new Error(`Unknown IR type: ${IR[0]}`)};var _util2=__w_pdfjs_require__2(1),_display_utils2=__w_pdfjs_require__2(8),_is_node2=__w_pdfjs_require__2(3);const PathType={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function applyBoundingBox(ctx,bbox){if(!bbox||_is_node2.isNodeJS)return;const width=bbox[2]-bbox[0],height=bbox[3]-bbox[1],region=new Path2D;region.rect(bbox[0],bbox[1],width,height),ctx.clip(region)}exports2.PathType=PathType;class BaseShadingPattern{constructor(){this.constructor===BaseShadingPattern&&(0,_util2.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,_util2.unreachable)("Abstract method `getPattern` called.")}}class RadialAxialShadingPattern extends BaseShadingPattern{constructor(IR){super(),this._type=IR[1],this._bbox=IR[2],this._colorStops=IR[3],this._p0=IR[4],this._p1=IR[5],this._r0=IR[6],this._r1=IR[7],this.matrix=null}_createGradient(ctx){let grad;"axial"===this._type?grad=ctx.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(grad=ctx.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const colorStop of this._colorStops)grad.addColorStop(colorStop[0],colorStop[1]);return grad}getPattern(ctx,owner,inverse,pathType){let pattern;if(pathType===PathType.STROKE||pathType===PathType.FILL){const ownerBBox=owner.current.getClippedPathBoundingBox(pathType,(0,_display_utils2.getCurrentTransform)(ctx))||[0,0,0,0],width=Math.ceil(ownerBBox[2]-ownerBBox[0])||1,height=Math.ceil(ownerBBox[3]-ownerBBox[1])||1,tmpCanvas=owner.cachedCanvases.getCanvas("pattern",width,height,!0),tmpCtx=tmpCanvas.context;tmpCtx.clearRect(0,0,tmpCtx.canvas.width,tmpCtx.canvas.height),tmpCtx.beginPath(),tmpCtx.rect(0,0,tmpCtx.canvas.width,tmpCtx.canvas.height),tmpCtx.translate(-ownerBBox[0],-ownerBBox[1]),inverse=_util2.Util.transform(inverse,[1,0,0,1,ownerBBox[0],ownerBBox[1]]),tmpCtx.transform(...owner.baseTransform),this.matrix&&tmpCtx.transform(...this.matrix),applyBoundingBox(tmpCtx,this._bbox),tmpCtx.fillStyle=this._createGradient(tmpCtx),tmpCtx.fill(),pattern=ctx.createPattern(tmpCanvas.canvas,"no-repeat");const domMatrix=new DOMMatrix(inverse);try{pattern.setTransform(domMatrix)}catch(ex){(0,_util2.warn)(`RadialAxialShadingPattern.getPattern: "${ex?.message}".`)}}else applyBoundingBox(ctx,this._bbox),pattern=this._createGradient(ctx);return pattern}}function drawTriangle(data,context,p1,p2,p3,c1,c2,c3){const coords=context.coords,colors=context.colors,bytes=data.data,rowSize=4*data.width;let tmp;coords[p1+1]>coords[p2+1]&&(tmp=p1,p1=p2,p2=tmp,tmp=c1,c1=c2,c2=tmp),coords[p2+1]>coords[p3+1]&&(tmp=p2,p2=p3,p3=tmp,tmp=c2,c2=c3,c3=tmp),coords[p1+1]>coords[p2+1]&&(tmp=p1,p1=p2,p2=tmp,tmp=c1,c1=c2,c2=tmp);const x1=(coords[p1]+context.offsetX)*context.scaleX,y1=(coords[p1+1]+context.offsetY)*context.scaleY,x2=(coords[p2]+context.offsetX)*context.scaleX,y2=(coords[p2+1]+context.offsetY)*context.scaleY,x3=(coords[p3]+context.offsetX)*context.scaleX,y3=(coords[p3+1]+context.offsetY)*context.scaleY;if(y1>=y3)return;const c1r=colors[c1],c1g=colors[c1+1],c1b=colors[c1+2],c2r=colors[c2],c2g=colors[c2+1],c2b=colors[c2+2],c3r=colors[c3],c3g=colors[c3+1],c3b=colors[c3+2],minY=Math.round(y1),maxY=Math.round(y3);let xa,car,cag,cab,xb,cbr,cbg,cbb;for(let y=minY;y<=maxY;y++){if(y<y2){let k2;k2=y<y1?0:(y1-y)/(y1-y2),xa=x1-(x1-x2)*k2,car=c1r-(c1r-c2r)*k2,cag=c1g-(c1g-c2g)*k2,cab=c1b-(c1b-c2b)*k2}else{let k2;k2=y>y3?1:y2===y3?0:(y2-y)/(y2-y3),xa=x2-(x2-x3)*k2,car=c2r-(c2r-c3r)*k2,cag=c2g-(c2g-c3g)*k2,cab=c2b-(c2b-c3b)*k2}let k;k=y<y1?0:y>y3?1:(y1-y)/(y1-y3),xb=x1-(x1-x3)*k,cbr=c1r-(c1r-c3r)*k,cbg=c1g-(c1g-c3g)*k,cbb=c1b-(c1b-c3b)*k;const x1_=Math.round(Math.min(xa,xb)),x2_=Math.round(Math.max(xa,xb));let j=rowSize*y+4*x1_;for(let x=x1_;x<=x2_;x++)k=(xa-x)/(xa-xb),k<0?k=0:k>1&&(k=1),bytes[j++]=car-(car-cbr)*k|0,bytes[j++]=cag-(cag-cbg)*k|0,bytes[j++]=cab-(cab-cbb)*k|0,bytes[j++]=255}}function drawFigure(data,figure,context){const ps=figure.coords,cs=figure.colors;let i,ii;switch(figure.type){case"lattice":const verticesPerRow=figure.verticesPerRow,rows=Math.floor(ps.length/verticesPerRow)-1,cols=verticesPerRow-1;for(i=0;i<rows;i++){let q=i*verticesPerRow;for(let j=0;j<cols;j++,q++)drawTriangle(data,context,ps[q],ps[q+1],ps[q+verticesPerRow],cs[q],cs[q+1],cs[q+verticesPerRow]),drawTriangle(data,context,ps[q+verticesPerRow+1],ps[q+1],ps[q+verticesPerRow],cs[q+verticesPerRow+1],cs[q+1],cs[q+verticesPerRow])}break;case"triangles":for(i=0,ii=ps.length;i<ii;i+=3)drawTriangle(data,context,ps[i],ps[i+1],ps[i+2],cs[i],cs[i+1],cs[i+2]);break;default:throw new Error("illegal figure")}}class MeshShadingPattern extends BaseShadingPattern{constructor(IR){super(),this._coords=IR[2],this._colors=IR[3],this._figures=IR[4],this._bounds=IR[5],this._bbox=IR[7],this._background=IR[8],this.matrix=null}_createMeshCanvas(combinedScale,backgroundColor,cachedCanvases){const offsetX=Math.floor(this._bounds[0]),offsetY=Math.floor(this._bounds[1]),boundsWidth=Math.ceil(this._bounds[2])-offsetX,boundsHeight=Math.ceil(this._bounds[3])-offsetY,width=Math.min(Math.ceil(Math.abs(boundsWidth*combinedScale[0]*1.1)),3e3),height=Math.min(Math.ceil(Math.abs(boundsHeight*combinedScale[1]*1.1)),3e3),scaleX=boundsWidth/width,scaleY=boundsHeight/height,context={coords:this._coords,colors:this._colors,offsetX:-offsetX,offsetY:-offsetY,scaleX:1/scaleX,scaleY:1/scaleY},tmpCanvas=cachedCanvases.getCanvas("mesh",width+4,height+4,!1),tmpCtx=tmpCanvas.context,data=tmpCtx.createImageData(width,height);if(backgroundColor){const bytes=data.data;for(let i=0,ii=bytes.length;i<ii;i+=4)bytes[i]=backgroundColor[0],bytes[i+1]=backgroundColor[1],bytes[i+2]=backgroundColor[2],bytes[i+3]=255}for(const figure of this._figures)drawFigure(data,figure,context);return tmpCtx.putImageData(data,2,2),{canvas:tmpCanvas.canvas,offsetX:offsetX-2*scaleX,offsetY:offsetY-2*scaleY,scaleX,scaleY}}getPattern(ctx,owner,inverse,pathType){let scale;if(applyBoundingBox(ctx,this._bbox),pathType===PathType.SHADING)scale=_util2.Util.singularValueDecompose2dScale((0,_display_utils2.getCurrentTransform)(ctx));else if(scale=_util2.Util.singularValueDecompose2dScale(owner.baseTransform),this.matrix){const matrixScale=_util2.Util.singularValueDecompose2dScale(this.matrix);scale=[scale[0]*matrixScale[0],scale[1]*matrixScale[1]]}const temporaryPatternCanvas=this._createMeshCanvas(scale,pathType===PathType.SHADING?null:this._background,owner.cachedCanvases);return pathType!==PathType.SHADING&&(ctx.setTransform(...owner.baseTransform),this.matrix&&ctx.transform(...this.matrix)),ctx.translate(temporaryPatternCanvas.offsetX,temporaryPatternCanvas.offsetY),ctx.scale(temporaryPatternCanvas.scaleX,temporaryPatternCanvas.scaleY),ctx.createPattern(temporaryPatternCanvas.canvas,"no-repeat")}}class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}}class TilingPattern{static get MAX_PATTERN_SIZE(){return(0,_util2.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(IR,color,ctx,canvasGraphicsFactory,baseTransform){this.operatorList=IR[2],this.matrix=IR[3]||[1,0,0,1,0,0],this.bbox=IR[4],this.xstep=IR[5],this.ystep=IR[6],this.paintType=IR[7],this.tilingType=IR[8],this.color=color,this.ctx=ctx,this.canvasGraphicsFactory=canvasGraphicsFactory,this.baseTransform=baseTransform}createPatternCanvas(owner){const operatorList=this.operatorList,bbox=this.bbox,xstep=this.xstep,ystep=this.ystep,paintType=this.paintType,color=this.color,canvasGraphicsFactory=this.canvasGraphicsFactory;(0,_util2.info)("TilingType: "+this.tilingType);const x0=bbox[0],y0=bbox[1],x1=bbox[2],y1=bbox[3],matrixScale=_util2.Util.singularValueDecompose2dScale(this.matrix),curMatrixScale=_util2.Util.singularValueDecompose2dScale(this.baseTransform),combinedScale=[matrixScale[0]*curMatrixScale[0],matrixScale[1]*curMatrixScale[1]],dimx=this.getSizeAndScale(xstep,this.ctx.canvas.width,combinedScale[0]),dimy=this.getSizeAndScale(ystep,this.ctx.canvas.height,combinedScale[1]),tmpCanvas=owner.cachedCanvases.getCanvas("pattern",dimx.size,dimy.size,!0),tmpCtx=tmpCanvas.context,graphics=canvasGraphicsFactory.createCanvasGraphics(tmpCtx);graphics.groupLevel=owner.groupLevel,this.setFillAndStrokeStyleToContext(graphics,paintType,color);let adjustedX0=x0,adjustedY0=y0,adjustedX1=x1,adjustedY1=y1;return x0<0&&(adjustedX0=0,adjustedX1+=Math.abs(x0)),y0<0&&(adjustedY0=0,adjustedY1+=Math.abs(y0)),tmpCtx.translate(-dimx.scale*adjustedX0,-dimy.scale*adjustedY0),graphics.transform(dimx.scale,0,0,dimy.scale,0,0),tmpCtx.save(),this.clipBbox(graphics,adjustedX0,adjustedY0,adjustedX1,adjustedY1),graphics.baseTransform=(0,_display_utils2.getCurrentTransform)(graphics.ctx),graphics.executeOperatorList(operatorList),graphics.endDrawing(),{canvas:tmpCanvas.canvas,scaleX:dimx.scale,scaleY:dimy.scale,offsetX:adjustedX0,offsetY:adjustedY0}}getSizeAndScale(step,realOutputSize,scale){step=Math.abs(step);const maxSize=Math.max(TilingPattern.MAX_PATTERN_SIZE,realOutputSize);let size=Math.ceil(step*scale);return size>=maxSize?size=maxSize:scale=size/step,{scale,size}}clipBbox(graphics,x0,y0,x1,y1){graphics.ctx.rect(x0,y0,x1-x0,y1-y0),graphics.current.updateRectMinMax((0,_display_utils2.getCurrentTransform)(graphics.ctx),[x0,y0,x1,y1]),graphics.clip(),graphics.endPath()}setFillAndStrokeStyleToContext(graphics,paintType,color){const context=graphics.ctx,current=graphics.current;switch(paintType){case 1:const ctx=this.ctx;context.fillStyle=ctx.fillStyle,context.strokeStyle=ctx.strokeStyle,current.fillColor=ctx.fillStyle,current.strokeColor=ctx.strokeStyle;break;case 2:const cssColor=_util2.Util.makeHexColor(color[0],color[1],color[2]);context.fillStyle=cssColor,context.strokeStyle=cssColor,current.fillColor=cssColor,current.strokeColor=cssColor;break;default:throw new _util2.FormatError(`Unsupported paint type: ${paintType}`)}}getPattern(ctx,owner,inverse,pathType){let matrix=inverse;pathType!==PathType.SHADING&&(matrix=_util2.Util.transform(matrix,owner.baseTransform),this.matrix&&(matrix=_util2.Util.transform(matrix,this.matrix)));const temporaryPatternCanvas=this.createPatternCanvas(owner);let domMatrix=new DOMMatrix(matrix);domMatrix=domMatrix.translate(temporaryPatternCanvas.offsetX,temporaryPatternCanvas.offsetY),domMatrix=domMatrix.scale(1/temporaryPatternCanvas.scaleX,1/temporaryPatternCanvas.scaleY);const pattern=ctx.createPattern(temporaryPatternCanvas.canvas,"repeat");try{pattern.setTransform(domMatrix)}catch(ex){(0,_util2.warn)(`TilingPattern.getPattern: "${ex?.message}".`)}return pattern}}exports2.TilingPattern=TilingPattern},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.applyMaskImageData=function applyMaskImageData({src,srcPos=0,dest,destPos=0,width,height,inverseDecode=!1}){const opaque=_util2.FeatureTest.isLittleEndian?4278190080:255,[zeroMapping,oneMapping]=inverseDecode?[0,opaque]:[opaque,0],widthInSource=width>>3,widthRemainder=7&width,srcLength=src.length;dest=new Uint32Array(dest.buffer);for(let i=0;i<height;i++){for(const max=srcPos+widthInSource;srcPos<max;srcPos++){const elem2=srcPos<srcLength?src[srcPos]:255;dest[destPos++]=128&elem2?oneMapping:zeroMapping,dest[destPos++]=64&elem2?oneMapping:zeroMapping,dest[destPos++]=32&elem2?oneMapping:zeroMapping,dest[destPos++]=16&elem2?oneMapping:zeroMapping,dest[destPos++]=8&elem2?oneMapping:zeroMapping,dest[destPos++]=4&elem2?oneMapping:zeroMapping,dest[destPos++]=2&elem2?oneMapping:zeroMapping,dest[destPos++]=1&elem2?oneMapping:zeroMapping}if(0===widthRemainder)continue;const elem=srcPos<srcLength?src[srcPos++]:255;for(let j=0;j<widthRemainder;j++)dest[destPos++]=elem&1<<7-j?oneMapping:zeroMapping}return{srcPos,destPos}};var _util2=__w_pdfjs_require__2(1)},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.GlobalWorkerOptions=void 0;const GlobalWorkerOptions=Object.create(null);exports2.GlobalWorkerOptions=GlobalWorkerOptions,GlobalWorkerOptions.workerPort=void 0===GlobalWorkerOptions.workerPort?null:GlobalWorkerOptions.workerPort,GlobalWorkerOptions.workerSrc=void 0===GlobalWorkerOptions.workerSrc?"":GlobalWorkerOptions.workerSrc},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.MessageHandler=void 0;var _util2=__w_pdfjs_require__2(1);function wrapReason(reason){switch(reason instanceof Error||"object"==typeof reason&&null!==reason||(0,_util2.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),reason.name){case"AbortException":return new _util2.AbortException(reason.message);case"MissingPDFException":return new _util2.MissingPDFException(reason.message);case"PasswordException":return new _util2.PasswordException(reason.message,reason.code);case"UnexpectedResponseException":return new _util2.UnexpectedResponseException(reason.message,reason.status);case"UnknownErrorException":return new _util2.UnknownErrorException(reason.message,reason.details);default:return new _util2.UnknownErrorException(reason.message,reason.toString())}}exports2.MessageHandler=class MessageHandler{constructor(sourceName,targetName,comObj){this.sourceName=sourceName,this.targetName=targetName,this.comObj=comObj,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=event=>{const data=event.data;if(data.targetName!==this.sourceName)return;if(data.stream)return void this._processStreamMessage(data);if(data.callback){const callbackId=data.callbackId,capability=this.callbackCapabilities[callbackId];if(!capability)throw new Error(`Cannot resolve callback ${callbackId}`);if(delete this.callbackCapabilities[callbackId],1===data.callback)capability.resolve(data.data);else{if(2!==data.callback)throw new Error("Unexpected callback case");capability.reject(wrapReason(data.reason))}return}const action=this.actionHandler[data.action];if(!action)throw new Error(`Unknown action from worker: ${data.action}`);if(data.callbackId){const cbSourceName=this.sourceName,cbTargetName=data.sourceName;new Promise(function(resolve){resolve(action(data.data))}).then(function(result){comObj.postMessage({sourceName:cbSourceName,targetName:cbTargetName,callback:1,callbackId:data.callbackId,data:result})},function(reason){comObj.postMessage({sourceName:cbSourceName,targetName:cbTargetName,callback:2,callbackId:data.callbackId,reason:wrapReason(reason)})})}else data.streamId?this._createStreamSink(data):action(data.data)},comObj.addEventListener("message",this._onComObjOnMessage)}on(actionName,handler){const ah=this.actionHandler;if(ah[actionName])throw new Error(`There is already an actionName called "${actionName}"`);ah[actionName]=handler}send(actionName,data,transfers){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:actionName,data},transfers)}sendWithPromise(actionName,data,transfers){const callbackId=this.callbackId++,capability=(0,_util2.createPromiseCapability)();this.callbackCapabilities[callbackId]=capability;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:actionName,callbackId,data},transfers)}catch(ex){capability.reject(ex)}return capability.promise}sendWithStream(actionName,data,queueingStrategy,transfers){const streamId=this.streamId++,sourceName=this.sourceName,targetName=this.targetName,comObj=this.comObj;return new ReadableStream({start:controller=>{const startCapability=(0,_util2.createPromiseCapability)();return this.streamControllers[streamId]={controller,startCall:startCapability,pullCall:null,cancelCall:null,isClosed:!1},comObj.postMessage({sourceName,targetName,action:actionName,streamId,data,desiredSize:controller.desiredSize},transfers),startCapability.promise},pull:controller=>{const pullCapability=(0,_util2.createPromiseCapability)();return this.streamControllers[streamId].pullCall=pullCapability,comObj.postMessage({sourceName,targetName,stream:6,streamId,desiredSize:controller.desiredSize}),pullCapability.promise},cancel:reason=>{(0,_util2.assert)(reason instanceof Error,"cancel must have a valid reason");const cancelCapability=(0,_util2.createPromiseCapability)();return this.streamControllers[streamId].cancelCall=cancelCapability,this.streamControllers[streamId].isClosed=!0,comObj.postMessage({sourceName,targetName,stream:1,streamId,reason:wrapReason(reason)}),cancelCapability.promise}},queueingStrategy)}_createStreamSink(data){const streamId=data.streamId,sourceName=this.sourceName,targetName=data.sourceName,comObj=this.comObj,self=this,action=this.actionHandler[data.action],streamSink={enqueue(chunk,size=1,transfers){if(this.isCancelled)return;const lastDesiredSize=this.desiredSize;this.desiredSize-=size,lastDesiredSize>0&&this.desiredSize<=0&&(this.sinkCapability=(0,_util2.createPromiseCapability)(),this.ready=this.sinkCapability.promise),comObj.postMessage({sourceName,targetName,stream:4,streamId,chunk},transfers)},close(){this.isCancelled||(this.isCancelled=!0,comObj.postMessage({sourceName,targetName,stream:3,streamId}),delete self.streamSinks[streamId])},error(reason){(0,_util2.assert)(reason instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,comObj.postMessage({sourceName,targetName,stream:5,streamId,reason:wrapReason(reason)}))},sinkCapability:(0,_util2.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:data.desiredSize,ready:null};streamSink.sinkCapability.resolve(),streamSink.ready=streamSink.sinkCapability.promise,this.streamSinks[streamId]=streamSink,new Promise(function(resolve){resolve(action(data.data,streamSink))}).then(function(){comObj.postMessage({sourceName,targetName,stream:8,streamId,success:!0})},function(reason){comObj.postMessage({sourceName,targetName,stream:8,streamId,reason:wrapReason(reason)})})}_processStreamMessage(data){const streamId=data.streamId,sourceName=this.sourceName,targetName=data.sourceName,comObj=this.comObj,streamController=this.streamControllers[streamId],streamSink=this.streamSinks[streamId];switch(data.stream){case 8:data.success?streamController.startCall.resolve():streamController.startCall.reject(wrapReason(data.reason));break;case 7:data.success?streamController.pullCall.resolve():streamController.pullCall.reject(wrapReason(data.reason));break;case 6:if(!streamSink){comObj.postMessage({sourceName,targetName,stream:7,streamId,success:!0});break}streamSink.desiredSize<=0&&data.desiredSize>0&&streamSink.sinkCapability.resolve(),streamSink.desiredSize=data.desiredSize,new Promise(function(resolve){resolve(streamSink.onPull&&streamSink.onPull())}).then(function(){comObj.postMessage({sourceName,targetName,stream:7,streamId,success:!0})},function(reason){comObj.postMessage({sourceName,targetName,stream:7,streamId,reason:wrapReason(reason)})});break;case 4:if((0,_util2.assert)(streamController,"enqueue should have stream controller"),streamController.isClosed)break;streamController.controller.enqueue(data.chunk);break;case 3:if((0,_util2.assert)(streamController,"close should have stream controller"),streamController.isClosed)break;streamController.isClosed=!0,streamController.controller.close(),this._deleteStreamController(streamController,streamId);break;case 5:(0,_util2.assert)(streamController,"error should have stream controller"),streamController.controller.error(wrapReason(data.reason)),this._deleteStreamController(streamController,streamId);break;case 2:data.success?streamController.cancelCall.resolve():streamController.cancelCall.reject(wrapReason(data.reason)),this._deleteStreamController(streamController,streamId);break;case 1:if(!streamSink)break;new Promise(function(resolve){resolve(streamSink.onCancel&&streamSink.onCancel(wrapReason(data.reason)))}).then(function(){comObj.postMessage({sourceName,targetName,stream:2,streamId,success:!0})},function(reason){comObj.postMessage({sourceName,targetName,stream:2,streamId,reason:wrapReason(reason)})}),streamSink.sinkCapability.reject(wrapReason(data.reason)),streamSink.isCancelled=!0,delete this.streamSinks[streamId];break;default:throw new Error("Unexpected stream case")}}_deleteStreamController(streamController,streamId){var _this10=this;return _asyncToGenerator(function*(){yield Promise.allSettled([streamController.startCall&&streamController.startCall.promise,streamController.pullCall&&streamController.pullCall.promise,streamController.cancelCall&&streamController.cancelCall.promise]),delete _this10.streamControllers[streamId]})()}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.Metadata=void 0;var _util2=__w_pdfjs_require__2(1);exports2.Metadata=class Metadata{#metadataMap;#data;constructor({parsedData,rawData}){this.#metadataMap=parsedData,this.#data=rawData}getRaw(){return this.#data}get(name){return this.#metadataMap.get(name)??null}getAll(){return(0,_util2.objectFromMap)(this.#metadataMap)}has(name){return this.#metadataMap.has(name)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.OptionalContentConfig=void 0;var _util2=__w_pdfjs_require__2(1);const INTERNAL=Symbol("INTERNAL");class OptionalContentGroup{#visible=!0;constructor(name,intent){this.name=name,this.intent=intent}get visible(){return this.#visible}_setVisible(internal,visible){internal!==INTERNAL&&(0,_util2.unreachable)("Internal method `_setVisible` called."),this.#visible=visible}}exports2.OptionalContentConfig=class OptionalContentConfig{#cachedHasInitialVisibility=!0;#groups=new Map;#initialVisibility=null;#order=null;constructor(data){if(this.name=null,this.creator=null,null!==data){this.name=data.name,this.creator=data.creator,this.#order=data.order;for(const group of data.groups)this.#groups.set(group.id,new OptionalContentGroup(group.name,group.intent));if("OFF"===data.baseState)for(const group of this.#groups.values())group._setVisible(INTERNAL,!1);for(const on of data.on)this.#groups.get(on)._setVisible(INTERNAL,!0);for(const off of data.off)this.#groups.get(off)._setVisible(INTERNAL,!1);this.#initialVisibility=new Map;for(const[id,group]of this.#groups)this.#initialVisibility.set(id,group.visible)}}#evaluateVisibilityExpression(array){const length=array.length;if(length<2)return!0;const operator=array[0];for(let i=1;i<length;i++){const element=array[i];let state;if(Array.isArray(element))state=this.#evaluateVisibilityExpression(element);else{if(!this.#groups.has(element))return(0,_util2.warn)(`Optional content group not found: ${element}`),!0;state=this.#groups.get(element).visible}switch(operator){case"And":if(!state)return!1;break;case"Or":if(state)return!0;break;case"Not":return!state;default:return!0}}return"And"===operator}isVisible(group){if(0===this.#groups.size)return!0;if(!group)return(0,_util2.warn)("Optional content group not defined."),!0;if("OCG"===group.type)return this.#groups.has(group.id)?this.#groups.get(group.id).visible:((0,_util2.warn)(`Optional content group not found: ${group.id}`),!0);if("OCMD"===group.type){if(group.expression)return this.#evaluateVisibilityExpression(group.expression);if(!group.policy||"AnyOn"===group.policy){for(const id of group.ids){if(!this.#groups.has(id))return(0,_util2.warn)(`Optional content group not found: ${id}`),!0;if(this.#groups.get(id).visible)return!0}return!1}if("AllOn"===group.policy){for(const id of group.ids){if(!this.#groups.has(id))return(0,_util2.warn)(`Optional content group not found: ${id}`),!0;if(!this.#groups.get(id).visible)return!1}return!0}if("AnyOff"===group.policy){for(const id of group.ids){if(!this.#groups.has(id))return(0,_util2.warn)(`Optional content group not found: ${id}`),!0;if(!this.#groups.get(id).visible)return!0}return!1}if("AllOff"===group.policy){for(const id of group.ids){if(!this.#groups.has(id))return(0,_util2.warn)(`Optional content group not found: ${id}`),!0;if(this.#groups.get(id).visible)return!1}return!0}return(0,_util2.warn)(`Unknown optional content policy ${group.policy}.`),!0}return(0,_util2.warn)(`Unknown group type ${group.type}.`),!0}setVisibility(id,visible=!0){this.#groups.has(id)?(this.#groups.get(id)._setVisible(INTERNAL,!!visible),this.#cachedHasInitialVisibility=null):(0,_util2.warn)(`Optional content group not found: ${id}`)}get hasInitialVisibility(){if(null!==this.#cachedHasInitialVisibility)return this.#cachedHasInitialVisibility;for(const[id,group]of this.#groups){const visible=this.#initialVisibility.get(id);if(group.visible!==visible)return this.#cachedHasInitialVisibility=!1}return this.#cachedHasInitialVisibility=!0}getOrder(){return this.#groups.size?this.#order?this.#order.slice():[...this.#groups.keys()]:null}getGroups(){return this.#groups.size>0?(0,_util2.objectFromMap)(this.#groups):null}getGroup(id){return this.#groups.get(id)||null}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFDataTransportStream=void 0;var _util2=__w_pdfjs_require__2(1),_display_utils2=__w_pdfjs_require__2(8);exports2.PDFDataTransportStream=class PDFDataTransportStream{constructor(params,pdfDataRangeTransport){(0,_util2.assert)(pdfDataRangeTransport,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=params.progressiveDone||!1,this._contentDispositionFilename=params.contentDispositionFilename||null;const initialData=params.initialData;if(initialData?.length>0){const buffer=new Uint8Array(initialData).buffer;this._queuedChunks.push(buffer)}this._pdfDataRangeTransport=pdfDataRangeTransport,this._isStreamingSupported=!params.disableStream,this._isRangeSupported=!params.disableRange,this._contentLength=params.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((begin,chunk)=>{this._onReceiveData({begin,chunk})}),this._pdfDataRangeTransport.addProgressListener((loaded,total)=>{this._onProgress({loaded,total})}),this._pdfDataRangeTransport.addProgressiveReadListener(chunk=>{this._onReceiveData({chunk})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(args){const buffer=new Uint8Array(args.chunk).buffer;if(void 0===args.begin)this._fullRequestReader?this._fullRequestReader._enqueue(buffer):this._queuedChunks.push(buffer);else{const found=this._rangeReaders.some(function(rangeReader){return rangeReader._begin===args.begin&&(rangeReader._enqueue(buffer),!0)});(0,_util2.assert)(found,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(evt){if(void 0===evt.total){const firstReader=this._rangeReaders[0];firstReader?.onProgress&&firstReader.onProgress({loaded:evt.loaded})}else{const fullReader=this._fullRequestReader;fullReader?.onProgress&&fullReader.onProgress({loaded:evt.loaded,total:evt.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(reader){const i=this._rangeReaders.indexOf(reader);i>=0&&this._rangeReaders.splice(i,1)}getFullReader(){(0,_util2.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const queuedChunks=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,queuedChunks,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(begin,end){if(end<=this._progressiveDataLength)return null;const reader=new PDFDataTransportStreamRangeReader(this,begin,end);return this._pdfDataRangeTransport.requestDataRange(begin,end),this._rangeReaders.push(reader),reader}cancelAllRequests(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);for(const reader of this._rangeReaders.slice(0))reader.cancel(reason);this._pdfDataRangeTransport.abort()}};class PDFDataTransportStreamReader{constructor(stream,queuedChunks,progressiveDone=!1,contentDispositionFilename=null){this._stream=stream,this._done=progressiveDone||!1,this._filename=(0,_display_utils2.isPdfFile)(contentDispositionFilename)?contentDispositionFilename:null,this._queuedChunks=queuedChunks||[],this._loaded=0;for(const chunk of this._queuedChunks)this._loaded+=chunk.byteLength;this._requests=[],this._headersReady=Promise.resolve(),stream._fullRequestReader=this,this.onProgress=null}_enqueue(chunk){this._done||(this._requests.length>0?this._requests.shift().resolve({value:chunk,done:!1}):this._queuedChunks.push(chunk),this._loaded+=chunk.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){var _this11=this;return _asyncToGenerator(function*(){if(_this11._queuedChunks.length>0)return{value:_this11._queuedChunks.shift(),done:!1};if(_this11._done)return{value:void 0,done:!0};const requestCapability=(0,_util2.createPromiseCapability)();return _this11._requests.push(requestCapability),requestCapability.promise})()}cancel(reason){this._done=!0;for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PDFDataTransportStreamRangeReader{constructor(stream,begin,end){this._stream=stream,this._begin=begin,this._end=end,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(chunk){if(!this._done){if(0===this._requests.length)this._queuedChunk=chunk;else{this._requests.shift().resolve({value:chunk,done:!1});for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){var _this12=this;return _asyncToGenerator(function*(){if(_this12._queuedChunk){const chunk=_this12._queuedChunk;return _this12._queuedChunk=null,{value:chunk,done:!1}}if(_this12._done)return{value:void 0,done:!0};const requestCapability=(0,_util2.createPromiseCapability)();return _this12._requests.push(requestCapability),requestCapability.promise})()}cancel(reason){this._done=!0;for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.XfaText=void 0;class XfaText{static textContent(xfa){const items=[],output={items,styles:Object.create(null)};return function walk(node){if(!node)return;let str=null;const name=node.name;if("#text"===name)str=node.value;else{if(!XfaText.shouldBuildText(name))return;node?.attributes?.textContent?str=node.attributes.textContent:node.value&&(str=node.value)}if(null!==str&&items.push({str}),node.children)for(const child of node.children)walk(child)}(xfa),output}static shouldBuildText(name){return!("textarea"===name||"input"===name||"option"===name||"select"===name)}}exports2.XfaText=XfaText},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.NodeStandardFontDataFactory=exports2.NodeCanvasFactory=exports2.NodeCMapReaderFactory=void 0;var _base_factory=__w_pdfjs_require__2(9);const fetchData=function(url){return new Promise((resolve,reject)=>{__webpack_require__(7147).readFile(url,(error,data)=>{!error&&data?resolve(new Uint8Array(data)):reject(new Error(error))})})};exports2.NodeCanvasFactory=class NodeCanvasFactory extends _base_factory.BaseCanvasFactory{_createCanvas(width,height){return __webpack_require__(6718).createCanvas(width,height)}},exports2.NodeCMapReaderFactory=class NodeCMapReaderFactory extends _base_factory.BaseCMapReaderFactory{_fetchData(url,compressionType){return fetchData(url).then(data=>({cMapData:data,compressionType}))}},exports2.NodeStandardFontDataFactory=class NodeStandardFontDataFactory extends _base_factory.BaseStandardFontDataFactory{_fetchData(url){return fetchData(url)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.AnnotationEditorLayer=void 0;var _tools=__w_pdfjs_require__2(7),_util2=__w_pdfjs_require__2(1),_freetext=__w_pdfjs_require__2(23),_ink=__w_pdfjs_require__2(24);exports2.AnnotationEditorLayer=(()=>{class AnnotationEditorLayer2{#accessibilityManager;#allowClick=!1;#boundPointerup=this.pointerup.bind(this);#boundPointerdown=this.pointerdown.bind(this);#editors=new Map;#hadPointerDown=!1;#isCleaningUp=!1;#uiManager;static _initialized=!1;constructor(options){AnnotationEditorLayer2._initialized||(AnnotationEditorLayer2._initialized=!0,_freetext.FreeTextEditor.initialize(options.l10n),_ink.InkEditor.initialize(options.l10n),options.uiManager.registerEditorTypes([_freetext.FreeTextEditor,_ink.InkEditor])),this.#uiManager=options.uiManager,this.annotationStorage=options.annotationStorage,this.pageIndex=options.pageIndex,this.div=options.div,this.#accessibilityManager=options.accessibilityManager,this.#uiManager.addLayer(this)}updateToolbar(mode){this.#uiManager.updateToolbar(mode)}updateMode(mode=this.#uiManager.getMode()){this.#cleanup(),mode===_util2.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),this.#uiManager.unselectAll()}addInkEditorIfNeeded(isCommitting){if(isCommitting||this.#uiManager.getMode()===_util2.AnnotationEditorType.INK){if(!isCommitting)for(const editor2 of this.#editors.values())if(editor2.isEmpty())return void editor2.setInBackground();this.#createAndAddNewEditor({offsetX:0,offsetY:0}).setInBackground()}}setEditingState(isEditing){this.#uiManager.setEditingState(isEditing)}addCommands(params){this.#uiManager.addCommands(params)}enable(){this.div.style.pointerEvents="auto";for(const editor of this.#editors.values())editor.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const editor of this.#editors.values())editor.disableEditing()}setActiveEditor(editor){this.#uiManager.getActive()!==editor&&this.#uiManager.setActiveEditor(editor)}enableClick(){this.div.addEventListener("pointerdown",this.#boundPointerdown),this.div.addEventListener("pointerup",this.#boundPointerup)}disableClick(){this.div.removeEventListener("pointerdown",this.#boundPointerdown),this.div.removeEventListener("pointerup",this.#boundPointerup)}attach(editor){this.#editors.set(editor.id,editor)}detach(editor){this.#editors.delete(editor.id),this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv)}remove(editor){this.#uiManager.removeEditor(editor),this.detach(editor),this.annotationStorage.remove(editor.id),editor.div.style.display="none",setTimeout(()=>{editor.div.style.display="",editor.div.remove(),editor.isAttachedToDOM=!1,document.activeElement===document.body&&this.#uiManager.focusMainContainer()},0),this.#isCleaningUp||this.addInkEditorIfNeeded(!1)}#changeParent(editor){editor.parent!==this&&(this.attach(editor),editor.pageIndex=this.pageIndex,editor.parent?.detach(editor),editor.parent=this,editor.div&&editor.isAttachedToDOM&&(editor.div.remove(),this.div.append(editor.div)))}add(editor){if(this.#changeParent(editor),this.#uiManager.addEditor(editor),this.attach(editor),!editor.isAttachedToDOM){const div=editor.render();this.div.append(div),editor.isAttachedToDOM=!0}this.moveEditorInDOM(editor),editor.onceAdded(),this.addToAnnotationStorage(editor)}moveEditorInDOM(editor){this.#accessibilityManager?.moveElementInDOM(this.div,editor.div,editor.contentDiv,!0)}addToAnnotationStorage(editor){!editor.isEmpty()&&!this.annotationStorage.has(editor.id)&&this.annotationStorage.setValue(editor.id,editor)}addOrRebuild(editor){editor.needsToBeRebuilt()?editor.rebuild():this.add(editor)}addANewEditor(editor){this.addCommands({cmd:()=>{this.addOrRebuild(editor)},undo:()=>{editor.remove()},mustExec:!0})}addUndoableEditor(editor){this.addCommands({cmd:()=>{this.addOrRebuild(editor)},undo:()=>{editor.remove()},mustExec:!1})}getNextId(){return this.#uiManager.getId()}#createNewEditor(params){switch(this.#uiManager.getMode()){case _util2.AnnotationEditorType.FREETEXT:return new _freetext.FreeTextEditor(params);case _util2.AnnotationEditorType.INK:return new _ink.InkEditor(params)}return null}deserialize(data){switch(data.annotationType){case _util2.AnnotationEditorType.FREETEXT:return _freetext.FreeTextEditor.deserialize(data,this);case _util2.AnnotationEditorType.INK:return _ink.InkEditor.deserialize(data,this)}return null}#createAndAddNewEditor(event){const id=this.getNextId(),editor=this.#createNewEditor({parent:this,id,x:event.offsetX,y:event.offsetY});return editor&&this.add(editor),editor}setSelected(editor){this.#uiManager.setSelected(editor)}toggleSelected(editor){this.#uiManager.toggleSelected(editor)}isSelected(editor){return this.#uiManager.isSelected(editor)}unselect(editor){this.#uiManager.unselect(editor)}pointerup(event){if(!(0!==event.button||event.ctrlKey&&_tools.KeyboardManager.platform.isMac)&&event.target===this.div&&this.#hadPointerDown){if(this.#hadPointerDown=!1,!this.#allowClick)return void(this.#allowClick=!0);this.#createAndAddNewEditor(event)}}pointerdown(event){if(0!==event.button||event.ctrlKey&&_tools.KeyboardManager.platform.isMac||event.target!==this.div)return;this.#hadPointerDown=!0;const editor=this.#uiManager.getActive();this.#allowClick=!editor||editor.isEmpty()}drop(event){const id=event.dataTransfer.getData("text/plain"),editor=this.#uiManager.getEditor(id);if(!editor)return;event.preventDefault(),event.dataTransfer.dropEffect="move",this.#changeParent(editor);const rect=this.div.getBoundingClientRect();editor.translate(event.clientX-rect.x-editor.startX,event.clientY-rect.y-editor.startY),this.moveEditorInDOM(editor),editor.div.focus()}dragover(event){event.preventDefault()}destroy(){this.#uiManager.getActive()?.parent===this&&this.#uiManager.setActiveEditor(null);for(const editor of this.#editors.values())this.#accessibilityManager?.removePointerInTextLayer(editor.contentDiv),editor.isAttachedToDOM=!1,editor.div.remove(),editor.parent=null;this.div=null,this.#editors.clear(),this.#uiManager.removeLayer(this)}#cleanup(){this.#isCleaningUp=!0;for(const editor of this.#editors.values())editor.isEmpty()&&editor.remove();this.#isCleaningUp=!1}render(parameters){this.viewport=parameters.viewport,(0,_tools.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const editor of this.#uiManager.getEditors(this.pageIndex))this.add(editor);this.updateMode()}update(parameters){this.viewport=parameters.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[pageLLx,pageLLy,pageURx,pageURy]=this.viewport.viewBox;return[pageURx-pageLLx,pageURy-pageLLy]}get viewportBaseDimensions(){const{width,height,rotation}=this.viewport;return rotation%180==0?[width,height]:[height,width]}setDimensions(){const{width,height,rotation}=this.viewport,flipOrientation=rotation%180!=0,widthStr=Math.floor(width)+"px",heightStr=Math.floor(height)+"px";this.div.style.width=flipOrientation?heightStr:widthStr,this.div.style.height=flipOrientation?widthStr:heightStr,this.div.setAttribute("data-main-rotation",rotation)}}return AnnotationEditorLayer2})()},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.FreeTextEditor=void 0;var _util2=__w_pdfjs_require__2(1),_tools=__w_pdfjs_require__2(7),_editor=__w_pdfjs_require__2(6);class FreeTextEditor extends _editor.AnnotationEditor{#boundEditorDivBlur=this.editorDivBlur.bind(this);#boundEditorDivFocus=this.editorDivFocus.bind(this);#boundEditorDivKeydown=this.editorDivKeydown.bind(this);#color;#content="";#hasAlreadyBeenCommitted=!1;#fontSize;static _freeTextDefaultContent="";static _l10nPromise;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static _keyboardManager=new _tools.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],FreeTextEditor.prototype.commitOrRemove]]);static _type="freetext";constructor(params){super({...params,name:"freeTextEditor"}),this.#color=params.color||FreeTextEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor,this.#fontSize=params.fontSize||FreeTextEditor._defaultFontSize}static initialize(l10n){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(str=>[str,l10n.get(str)]));const style=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(style.getPropertyValue("--freetext-padding"))}static updateDefaultParams(type,value){switch(type){case _util2.AnnotationEditorParamsType.FREETEXT_SIZE:FreeTextEditor._defaultFontSize=value;break;case _util2.AnnotationEditorParamsType.FREETEXT_COLOR:FreeTextEditor._defaultColor=value}}updateParams(type,value){switch(type){case _util2.AnnotationEditorParamsType.FREETEXT_SIZE:this.#updateFontSize(value);break;case _util2.AnnotationEditorParamsType.FREETEXT_COLOR:this.#updateColor(value)}}static get defaultPropertiesToUpdate(){return[[_util2.AnnotationEditorParamsType.FREETEXT_SIZE,FreeTextEditor._defaultFontSize],[_util2.AnnotationEditorParamsType.FREETEXT_COLOR,FreeTextEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[_util2.AnnotationEditorParamsType.FREETEXT_SIZE,this.#fontSize],[_util2.AnnotationEditorParamsType.FREETEXT_COLOR,this.#color]]}#updateFontSize(fontSize){const setFontsize=size=>{this.editorDiv.style.fontSize=`calc(${size}px * var(--scale-factor))`,this.translate(0,-(size-this.#fontSize)*this.parent.scaleFactor),this.#fontSize=size,this.#setEditorDimensions()},savedFontsize=this.#fontSize;this.parent.addCommands({cmd:()=>{setFontsize(fontSize)},undo:()=>{setFontsize(savedFontsize)},mustExec:!0,type:_util2.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#updateColor(color){const savedColor=this.#color;this.parent.addCommands({cmd:()=>{this.#color=color,this.editorDiv.style.color=color},undo:()=>{this.#color=savedColor,this.editorDiv.style.color=savedColor},mustExec:!0,type:_util2.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}getInitialTranslation(){return[-FreeTextEditor._internalPadding*this.parent.scaleFactor,-(FreeTextEditor._internalPadding+this.#fontSize)*this.parent.scaleFactor]}rebuild(){super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(_util2.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",this.#boundEditorDivKeydown),this.editorDiv.addEventListener("focus",this.#boundEditorDivFocus),this.editorDiv.addEventListener("blur",this.#boundEditorDivBlur))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",this.#boundEditorDivKeydown),this.editorDiv.removeEventListener("focus",this.#boundEditorDivFocus),this.editorDiv.removeEventListener("blur",this.#boundEditorDivBlur),this.div.focus(),this.isEditing=!1)}focusin(event){super.focusin(event),event.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}#extractText(){const divs=this.editorDiv.getElementsByTagName("div");if(0===divs.length)return this.editorDiv.innerText;const buffer=[];for(let i=0,ii=divs.length;i<ii;i++){const first=divs[i].firstChild;buffer.push("#text"===first?.nodeName?first.data:"")}return buffer.join("\n")}#setEditorDimensions(){const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions,rect=this.div.getBoundingClientRect();this.width=rect.width/parentWidth,this.height=rect.height/parentHeight}commit(){super.commit(),this.#hasAlreadyBeenCommitted||(this.#hasAlreadyBeenCommitted=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),this.#content=this.#extractText().trimEnd(),this.#setEditorDimensions()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(event){this.enableEditMode(),this.editorDiv.focus()}keydown(event){event.target===this.div&&"Enter"===event.key&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(event){FreeTextEditor._keyboardManager.exec(this,event)}editorDivFocus(event){this.isEditing=!0}editorDivBlur(event){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let baseX,baseY;this.width&&(baseX=this.x,baseY=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),FreeTextEditor._l10nPromise.get("editor_free_text_aria_label").then(msg=>this.editorDiv?.setAttribute("aria-label",msg)),FreeTextEditor._l10nPromise.get("free_text_default_content").then(msg=>this.editorDiv?.setAttribute("default-content",msg)),this.editorDiv.contentEditable=!0;const{style}=this.editorDiv;if(style.fontSize=`calc(${this.#fontSize}px * var(--scale-factor))`,style.color=this.#color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_tools.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.setAt(baseX*parentWidth,baseY*parentHeight,this.width*parentWidth,this.height*parentHeight);for(const line of this.#content.split("\n")){const div=document.createElement("div");div.append(line?document.createTextNode(line):document.createElement("br")),this.editorDiv.append(div)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(data,parent){const editor=super.deserialize(data,parent);return editor.#fontSize=data.fontSize,editor.#color=_util2.Util.makeHexColor(...data.color),editor.#content=data.value,editor}serialize(){if(this.isEmpty())return null;const padding=FreeTextEditor._internalPadding*this.parent.scaleFactor,rect=this.getRect(padding,padding),color=_editor.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:_util2.AnnotationEditorType.FREETEXT,color,fontSize:this.#fontSize,value:this.#content,pageIndex:this.parent.pageIndex,rect,rotation:this.rotation}}}exports2.FreeTextEditor=FreeTextEditor},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.InkEditor=void 0,Object.defineProperty(exports2,"fitCurve",{enumerable:!0,get:function(){return _pdfjsFitCurve.fitCurve}});var _util2=__w_pdfjs_require__2(1),_editor=__w_pdfjs_require__2(6),_pdfjsFitCurve=__w_pdfjs_require__2(25),_tools=__w_pdfjs_require__2(7);exports2.InkEditor=(()=>{class InkEditor2 extends _editor.AnnotationEditor{#aspectRatio=0;#baseHeight=0;#baseWidth=0;#boundCanvasPointermove=this.canvasPointermove.bind(this);#boundCanvasPointerleave=this.canvasPointerleave.bind(this);#boundCanvasPointerup=this.canvasPointerup.bind(this);#boundCanvasPointerdown=this.canvasPointerdown.bind(this);#disableEditing=!1;#isCanvasInitialized=!1;#lastPoint=null;#observer=null;#realWidth=0;#realHeight=0;#requestFrameCallback=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _l10nPromise;static _type="ink";constructor(params){super({...params,name:"inkEditor"}),this.color=params.color||null,this.thickness=params.thickness||null,this.opacity=params.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(l10n){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(str=>[str,l10n.get(str)]))}static updateDefaultParams(type,value){switch(type){case _util2.AnnotationEditorParamsType.INK_THICKNESS:InkEditor2._defaultThickness=value;break;case _util2.AnnotationEditorParamsType.INK_COLOR:InkEditor2._defaultColor=value;break;case _util2.AnnotationEditorParamsType.INK_OPACITY:InkEditor2._defaultOpacity=value/100}}updateParams(type,value){switch(type){case _util2.AnnotationEditorParamsType.INK_THICKNESS:this.#updateThickness(value);break;case _util2.AnnotationEditorParamsType.INK_COLOR:this.#updateColor(value);break;case _util2.AnnotationEditorParamsType.INK_OPACITY:this.#updateOpacity(value)}}static get defaultPropertiesToUpdate(){return[[_util2.AnnotationEditorParamsType.INK_THICKNESS,InkEditor2._defaultThickness],[_util2.AnnotationEditorParamsType.INK_COLOR,InkEditor2._defaultColor||_editor.AnnotationEditor._defaultLineColor],[_util2.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*InkEditor2._defaultOpacity)]]}get propertiesToUpdate(){return[[_util2.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||InkEditor2._defaultThickness],[_util2.AnnotationEditorParamsType.INK_COLOR,this.color||InkEditor2._defaultColor||_editor.AnnotationEditor._defaultLineColor],[_util2.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??InkEditor2._defaultOpacity))]]}#updateThickness(thickness){const savedThickness=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=thickness,this.#fitToContent()},undo:()=>{this.thickness=savedThickness,this.#fitToContent()},mustExec:!0,type:_util2.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#updateColor(color){const savedColor=this.color;this.parent.addCommands({cmd:()=>{this.color=color,this.#redraw()},undo:()=>{this.color=savedColor,this.#redraw()},mustExec:!0,type:_util2.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#updateOpacity(opacity){opacity/=100;const savedOpacity=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=opacity,this.#redraw()},undo:()=>{this.opacity=savedOpacity,this.#redraw()},mustExec:!0,type:_util2.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){super.rebuild(),null!==this.div&&(this.canvas||(this.#createCanvas(),this.#createObserver()),this.isAttachedToDOM||(this.parent.add(this),this.#setCanvasDims()),this.#fitToContent())}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#observer.disconnect(),this.#observer=null,super.remove())}enableEditMode(){this.#disableEditing||null===this.canvas||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",this.#boundCanvasPointerdown),this.canvas.addEventListener("pointerup",this.#boundCanvasPointerup))}disableEditMode(){!this.isInEditMode()||null===this.canvas||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#boundCanvasPointerdown),this.canvas.removeEventListener("pointerup",this.#boundCanvasPointerup))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#getInitialBBox(){const{width,height,rotation}=this.parent.viewport;switch(rotation){case 90:return[0,width,width,height];case 180:return[width,height,width,height];case 270:return[height,0,width,height];default:return[0,0,width,height]}}#setStroke(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,_tools.opacityToHex)(this.opacity)}`}#startDrawing(x,y){this.isEditing=!0,this.#isCanvasInitialized||(this.#isCanvasInitialized=!0,this.#setCanvasDims(),this.thickness||=InkEditor2._defaultThickness,this.color||=InkEditor2._defaultColor||_editor.AnnotationEditor._defaultLineColor,this.opacity??=InkEditor2._defaultOpacity),this.currentPath.push([x,y]),this.#lastPoint=null,this.#setStroke(),this.ctx.beginPath(),this.ctx.moveTo(x,y),this.#requestFrameCallback=()=>{this.#requestFrameCallback&&(this.#lastPoint&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):this.#redraw(),this.ctx.lineTo(...this.#lastPoint),this.#lastPoint=null,this.ctx.stroke()),window.requestAnimationFrame(this.#requestFrameCallback))},window.requestAnimationFrame(this.#requestFrameCallback)}#draw(x,y){const[lastX,lastY]=this.currentPath.at(-1);x===lastX&&y===lastY||(this.currentPath.push([x,y]),this.#lastPoint=[x,y])}#stopDrawing(x,y){this.ctx.closePath(),this.#requestFrameCallback=null,x=Math.min(Math.max(x,0),this.canvas.width),y=Math.min(Math.max(y,0),this.canvas.height);const[lastX,lastY]=this.currentPath.at(-1);let bezier;if((x!==lastX||y!==lastY)&&this.currentPath.push([x,y]),1!==this.currentPath.length)bezier=(0,_pdfjsFitCurve.fitCurve)(this.currentPath,30,null);else{const xy=[x,y];bezier=[[xy,xy.slice(),xy.slice(),xy]]}const path2D=InkEditor2.#buildPath2D(bezier);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(bezier),this.bezierPath2D.push(path2D),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#createCanvas(),this.#createObserver()),this.#fitToContent())},mustExec:!0})}#redraw(){if(this.isEmpty())return void this.#updateTransform();this.#setStroke();const{canvas,ctx}=this;ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),this.#updateTransform();for(const path of this.bezierPath2D)ctx.stroke(path)}commit(){this.#disableEditing||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#disableEditing=!0,this.div.classList.add("disabled"),this.#fitToContent(!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(event){super.focusin(event),this.enableEditMode()}canvasPointerdown(event){0!==event.button||!this.isInEditMode()||this.#disableEditing||(this.setInForeground(),"mouse"!==event.type&&this.div.focus(),event.stopPropagation(),this.canvas.addEventListener("pointerleave",this.#boundCanvasPointerleave),this.canvas.addEventListener("pointermove",this.#boundCanvasPointermove),this.#startDrawing(event.offsetX,event.offsetY))}canvasPointermove(event){event.stopPropagation(),this.#draw(event.offsetX,event.offsetY)}canvasPointerup(event){0===event.button&&this.isInEditMode()&&0!==this.currentPath.length&&(event.stopPropagation(),this.#endDrawing(event),this.setInBackground())}canvasPointerleave(event){this.#endDrawing(event),this.setInBackground()}#endDrawing(event){this.#stopDrawing(event.offsetX,event.offsetY),this.canvas.removeEventListener("pointerleave",this.#boundCanvasPointerleave),this.canvas.removeEventListener("pointermove",this.#boundCanvasPointermove),this.parent.addToAnnotationStorage(this)}#createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",InkEditor2._l10nPromise.get("editor_ink_canvas_aria_label").then(msg=>this.canvas?.setAttribute("aria-label",msg)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#createObserver(){this.#observer=new ResizeObserver(entries=>{const rect=entries[0].contentRect;rect.width&&rect.height&&this.setDimensions(rect.width,rect.height)}),this.#observer.observe(this.div)}render(){if(this.div)return this.div;let baseX,baseY;this.width&&(baseX=this.x,baseY=this.y),super.render(),InkEditor2._l10nPromise.get("editor_ink_aria_label").then(msg=>this.div?.setAttribute("aria-label",msg));const[x,y,w,h]=this.#getInitialBBox();if(this.setAt(x,y,0,0),this.setDims(w,h),this.#createCanvas(),this.width){const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.setAt(baseX*parentWidth,baseY*parentHeight,this.width*parentWidth,this.height*parentHeight),this.#isCanvasInitialized=!0,this.#setCanvasDims(),this.setDims(this.width*parentWidth,this.height*parentHeight),this.#redraw(),this.#setMinDims(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#createObserver(),this.div}#setCanvasDims(){if(!this.#isCanvasInitialized)return;const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*parentWidth),this.canvas.height=Math.ceil(this.height*parentHeight),this.#updateTransform()}setDimensions(width,height){const roundedWidth=Math.round(width),roundedHeight=Math.round(height);if(this.#realWidth===roundedWidth&&this.#realHeight===roundedHeight)return;this.#realWidth=roundedWidth,this.#realHeight=roundedHeight,this.canvas.style.visibility="hidden",this.#aspectRatio&&Math.abs(this.#aspectRatio-width/height)>.01&&(height=Math.ceil(width/this.#aspectRatio),this.setDims(width,height));const[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.width=width/parentWidth,this.height=height/parentHeight,this.#disableEditing&&this.#setScaleFactor(width,height),this.#setCanvasDims(),this.#redraw(),this.canvas.style.visibility="visible"}#setScaleFactor(width,height){const padding=this.#getPadding(),scaleFactorW=(width-padding)/this.#baseWidth,scaleFactorH=(height-padding)/this.#baseHeight;this.scaleFactor=Math.min(scaleFactorW,scaleFactorH)}#updateTransform(){const padding=this.#getPadding()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+padding,this.translationY*this.scaleFactor+padding)}static#buildPath2D(bezier){const path2D=new Path2D;for(let i=0,ii=bezier.length;i<ii;i++){const[first,control1,control2,second]=bezier[i];0===i&&path2D.moveTo(...first),path2D.bezierCurveTo(control1[0],control1[1],control2[0],control2[1],second[0],second[1])}return path2D}#serializePaths(s,tx,ty,h){const paths=[],padding=this.thickness/2;let buffer,points;for(const bezier of this.paths){buffer=[],points=[];for(let i=0,ii=bezier.length;i<ii;i++){const[first,control1,control2,second]=bezier[i],p10=s*(first[0]+tx)+padding,p11=h-s*(first[1]+ty)-padding,p20=s*(control1[0]+tx)+padding,p21=h-s*(control1[1]+ty)-padding,p30=s*(control2[0]+tx)+padding,p31=h-s*(control2[1]+ty)-padding,p40=s*(second[0]+tx)+padding,p41=h-s*(second[1]+ty)-padding;0===i&&(buffer.push(p10,p11),points.push(p10,p11)),buffer.push(p20,p21,p30,p31,p40,p41),this.#extractPointsOnBezier(p10,p11,p20,p21,p30,p31,p40,p41,4,points)}paths.push({bezier:buffer,points})}return paths}#extractPointsOnBezier(p10,p11,p20,p21,p30,p31,p40,p41,n,points){if(this.#isAlmostFlat(p10,p11,p20,p21,p30,p31,p40,p41))points.push(p40,p41);else{for(let i=1;i<n-1;i++){const t=i/n,mt=1-t;let q10=t*p10+mt*p20,q11=t*p11+mt*p21,q20=t*p20+mt*p30,q21=t*p21+mt*p31;q10=t*q10+mt*q20,q11=t*q11+mt*q21,q20=t*q20+mt*(t*p30+mt*p40),q21=t*q21+mt*(t*p31+mt*p41),q10=t*q10+mt*q20,q11=t*q11+mt*q21,points.push(q10,q11)}points.push(p40,p41)}}#isAlmostFlat(p10,p11,p20,p21,p30,p31,p40,p41){const ay=(3*p21-2*p11-p41)**2,by=(3*p31-p11-2*p41)**2;return Math.max((3*p20-2*p10-p40)**2,(3*p30-p10-2*p40)**2)+Math.max(ay,by)<=10}#getBbox(){let xMin=1/0,xMax=-1/0,yMin=1/0,yMax=-1/0;for(const path of this.paths)for(const[first,control1,control2,second]of path){const bbox=_util2.Util.bezierBoundingBox(...first,...control1,...control2,...second);xMin=Math.min(xMin,bbox[0]),yMin=Math.min(yMin,bbox[1]),xMax=Math.max(xMax,bbox[2]),yMax=Math.max(yMax,bbox[3])}return[xMin,yMin,xMax,yMax]}#getPadding(){return this.#disableEditing?Math.ceil(this.thickness*this.parent.scaleFactor):0}#fitToContent(firstTime=!1){if(this.isEmpty())return;if(!this.#disableEditing)return void this.#redraw();const bbox=this.#getBbox(),padding=this.#getPadding();this.#baseWidth=Math.max(16,bbox[2]-bbox[0]),this.#baseHeight=Math.max(16,bbox[3]-bbox[1]);const width=Math.ceil(padding+this.#baseWidth*this.scaleFactor),height=Math.ceil(padding+this.#baseHeight*this.scaleFactor),[parentWidth,parentHeight]=this.parent.viewportBaseDimensions;this.width=width/parentWidth,this.height=height/parentHeight,this.#aspectRatio=width/height,this.#setMinDims();const prevTranslationX=this.translationX,prevTranslationY=this.translationY;this.translationX=-bbox[0],this.translationY=-bbox[1],this.#setCanvasDims(),this.#redraw(),this.#realWidth=width,this.#realHeight=height,this.setDims(width,height);const unscaledPadding=firstTime?padding/this.scaleFactor/2:0;this.translate(prevTranslationX-this.translationX-unscaledPadding,prevTranslationY-this.translationY-unscaledPadding)}#setMinDims(){const{style}=this.div;this.#aspectRatio>=1?(style.minHeight="16px",style.minWidth=`${Math.round(16*this.#aspectRatio)}px`):(style.minWidth="16px",style.minHeight=`${Math.round(16/this.#aspectRatio)}px`)}static deserialize(data,parent){const editor=super.deserialize(data,parent);editor.thickness=data.thickness,editor.color=_util2.Util.makeHexColor(...data.color),editor.opacity=data.opacity;const[pageWidth,pageHeight]=parent.pageDimensions,width=editor.width*pageWidth,height=editor.height*pageHeight,scaleFactor=parent.scaleFactor,padding=data.thickness/2;editor.#aspectRatio=width/height,editor.#disableEditing=!0,editor.#realWidth=Math.round(width),editor.#realHeight=Math.round(height);for(const{bezier}of data.paths){const path=[];editor.paths.push(path);let p0=scaleFactor*(bezier[0]-padding),p1=scaleFactor*(height-bezier[1]-padding);for(let i=2,ii=bezier.length;i<ii;i+=6){const p30=scaleFactor*(bezier[i+4]-padding),p31=scaleFactor*(height-bezier[i+5]-padding);path.push([[p0,p1],[scaleFactor*(bezier[i]-padding),scaleFactor*(height-bezier[i+1]-padding)],[scaleFactor*(bezier[i+2]-padding),scaleFactor*(height-bezier[i+3]-padding)],[p30,p31]]),p0=p30,p1=p31}const path2D=this.#buildPath2D(path);editor.bezierPath2D.push(path2D)}const bbox=editor.#getBbox();return editor.#baseWidth=Math.max(16,bbox[2]-bbox[0]),editor.#baseHeight=Math.max(16,bbox[3]-bbox[1]),editor.#setScaleFactor(width,height),editor}serialize(){if(this.isEmpty())return null;const rect=this.getRect(0,0),height=this.rotation%180==0?rect[3]-rect[1]:rect[2]-rect[0],color=_editor.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:_util2.AnnotationEditorType.INK,color,thickness:this.thickness,opacity:this.opacity,paths:this.#serializePaths(this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,height),pageIndex:this.parent.pageIndex,rect,rotation:this.rotation}}}return InkEditor2})()},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.fitCurve=void 0;const fitCurve=__w_pdfjs_require__2(26);exports2.fitCurve=fitCurve},module2=>{function fitCubic(points,leftTangent,rightTangent,error,progressCallback){var bezCurve,u,uPrime,maxError,prevErr,splitPoint,prevSplit,centerVector,toCenterTangent,fromCenterTangent,beziers,dist,i;if(2===points.length)return dist=maths.vectorLen(maths.subtract(points[0],points[1]))/3,[bezCurve=[points[0],maths.addArrays(points[0],maths.mulItems(leftTangent,dist)),maths.addArrays(points[1],maths.mulItems(rightTangent,dist)),points[1]]];if(u=function chordLengthParameterize(points){var currU,prevU,prevP,u=[];return points.forEach((p,i)=>{currU=i?prevU+maths.vectorLen(maths.subtract(p,prevP)):0,u.push(currU),prevU=currU,prevP=p}),u=u.map(x=>x/prevU)}(points),[bezCurve,maxError,splitPoint]=generateAndReport(points,u,u,leftTangent,rightTangent,progressCallback),0===maxError||maxError<error)return[bezCurve];if(maxError<error*error)for(uPrime=u,prevErr=maxError,prevSplit=splitPoint,i=0;i<20;i++){if(uPrime=reparameterize(bezCurve,points,uPrime),[bezCurve,maxError,splitPoint]=generateAndReport(points,u,uPrime,leftTangent,rightTangent,progressCallback),maxError<error)return[bezCurve];if(splitPoint===prevSplit){let errChange=maxError/prevErr;if(errChange>.9999&&errChange<1.0001)break}prevErr=maxError,prevSplit=splitPoint}return beziers=[],(centerVector=maths.subtract(points[splitPoint-1],points[splitPoint+1])).every(val=>0===val)&&(centerVector=maths.subtract(points[splitPoint-1],points[splitPoint]),[centerVector[0],centerVector[1]]=[-centerVector[1],centerVector[0]]),toCenterTangent=maths.normalize(centerVector),fromCenterTangent=maths.mulItems(toCenterTangent,-1),(beziers=beziers.concat(fitCubic(points.slice(0,splitPoint+1),leftTangent,toCenterTangent,error,progressCallback))).concat(fitCubic(points.slice(splitPoint),fromCenterTangent,rightTangent,error,progressCallback))}function generateAndReport(points,paramsOrig,paramsPrime,leftTangent,rightTangent,progressCallback){var bezCurve,maxError,splitPoint;return bezCurve=function generateBezier(points,parameters,leftTangent,rightTangent){var bezCurve,A,a,C,X,det_C0_C1,alpha_l,alpha_r,epsilon,segLength,i,len,tmp,u,ux,firstPoint=points[0],lastPoint=points[points.length-1];for(bezCurve=[firstPoint,null,null,lastPoint],A=maths.zeros_Xx2x2(parameters.length),i=0,len=parameters.length;i<len;i++)(a=A[i])[0]=maths.mulItems(leftTangent,3*(u=parameters[i])*((ux=1-u)*ux)),a[1]=maths.mulItems(rightTangent,3*ux*(u*u));for(C=[[0,0],[0,0]],X=[0,0],i=0,len=points.length;i<len;i++)u=parameters[i],C[0][0]+=maths.dot((a=A[i])[0],a[0]),C[0][1]+=maths.dot(a[0],a[1]),C[1][0]+=maths.dot(a[0],a[1]),C[1][1]+=maths.dot(a[1],a[1]),tmp=maths.subtract(points[i],bezier.q([firstPoint,firstPoint,lastPoint,lastPoint],u)),X[0]+=maths.dot(a[0],tmp),X[1]+=maths.dot(a[1],tmp);return alpha_l=0==(det_C0_C1=C[0][0]*C[1][1]-C[1][0]*C[0][1])?0:(X[0]*C[1][1]-X[1]*C[0][1])/det_C0_C1,alpha_r=0===det_C0_C1?0:(C[0][0]*X[1]-C[1][0]*X[0])/det_C0_C1,alpha_l<(epsilon=1e-6*(segLength=maths.vectorLen(maths.subtract(firstPoint,lastPoint))))||alpha_r<epsilon?(bezCurve[1]=maths.addArrays(firstPoint,maths.mulItems(leftTangent,segLength/3)),bezCurve[2]=maths.addArrays(lastPoint,maths.mulItems(rightTangent,segLength/3))):(bezCurve[1]=maths.addArrays(firstPoint,maths.mulItems(leftTangent,alpha_l)),bezCurve[2]=maths.addArrays(lastPoint,maths.mulItems(rightTangent,alpha_r))),bezCurve}(points,paramsPrime,leftTangent,rightTangent),[maxError,splitPoint]=function computeMaxError(points,bez,parameters){var dist,maxDist,splitPoint,v,i,count,point,t;maxDist=0,splitPoint=Math.floor(points.length/2);const t_distMap=mapTtoRelativeDistances(bez,10);for(i=0,count=points.length;i<count;i++)point=points[i],t=find_t(0,parameters[i],t_distMap,10),(dist=(v=maths.subtract(bezier.q(bez,t),point))[0]*v[0]+v[1]*v[1])>maxDist&&(maxDist=dist,splitPoint=i);return[maxDist,splitPoint]}(points,bezCurve,paramsOrig),progressCallback&&progressCallback({bez:bezCurve,points,params:paramsOrig,maxErr:maxError,maxPoint:splitPoint}),[bezCurve,maxError,splitPoint]}function reparameterize(bezier2,points,parameters){return parameters.map((p,i)=>function newtonRaphsonRootFind(bez,point,u){var d=maths.subtract(bezier.q(bez,u),point),qprime=bezier.qprime(bez,u),numerator=maths.mulMatrix(d,qprime),denominator=maths.sum(maths.squareItems(qprime))+2*maths.mulMatrix(d,bezier.qprimeprime(bez,u));return 0===denominator?u:u-numerator/denominator}(bezier2,points[i],p))}var mapTtoRelativeDistances=function(bez,B_parts){for(var B_t_curr,B_t_dist=[0],B_t_prev=bez[0],sumLen=0,i=1;i<=B_parts;i++)B_t_curr=bezier.q(bez,i/B_parts),sumLen+=maths.vectorLen(maths.subtract(B_t_curr,B_t_prev)),B_t_dist.push(sumLen),B_t_prev=B_t_curr;return B_t_dist.map(x=>x/sumLen)};function find_t(bez,param,t_distMap,B_parts){if(param<0)return 0;if(param>1)return 1;for(var lenMin,tMin,t,i=1;i<=B_parts;i++)if(param<=t_distMap[i]){t=(param-(lenMin=t_distMap[i-1]))/(t_distMap[i]-lenMin)*(i/B_parts-(tMin=(i-1)/B_parts))+tMin;break}return t}function createTangent(pointA,pointB){return maths.normalize(maths.subtract(pointA,pointB))}class maths{static zeros_Xx2x2(x){for(var zs=[];x--;)zs.push([0,0]);return zs}static mulItems(items,multiplier){return items.map(x=>x*multiplier)}static mulMatrix(m1,m2){return m1.reduce((sum,x1,i)=>sum+x1*m2[i],0)}static subtract(arr1,arr2){return arr1.map((x1,i)=>x1-arr2[i])}static addArrays(arr1,arr2){return arr1.map((x1,i)=>x1+arr2[i])}static addItems(items,addition){return items.map(x=>x+addition)}static sum(items){return items.reduce((sum,x)=>sum+x)}static dot(m1,m2){return maths.mulMatrix(m1,m2)}static vectorLen(v){return Math.hypot(...v)}static divItems(items,divisor){return items.map(x=>x/divisor)}static squareItems(items){return items.map(x=>x*x)}static normalize(v){return this.divItems(v,this.vectorLen(v))}}class bezier{static q(ctrlPoly,t){var tx=1-t,pA=maths.mulItems(ctrlPoly[0],tx*tx*tx),pB=maths.mulItems(ctrlPoly[1],3*tx*tx*t),pC=maths.mulItems(ctrlPoly[2],3*tx*t*t),pD=maths.mulItems(ctrlPoly[3],t*t*t);return maths.addArrays(maths.addArrays(pA,pB),maths.addArrays(pC,pD))}static qprime(ctrlPoly,t){var tx=1-t,pA=maths.mulItems(maths.subtract(ctrlPoly[1],ctrlPoly[0]),3*tx*tx),pB=maths.mulItems(maths.subtract(ctrlPoly[2],ctrlPoly[1]),6*tx*t),pC=maths.mulItems(maths.subtract(ctrlPoly[3],ctrlPoly[2]),3*t*t);return maths.addArrays(maths.addArrays(pA,pB),pC)}static qprimeprime(ctrlPoly,t){return maths.addArrays(maths.mulItems(maths.addArrays(maths.subtract(ctrlPoly[2],maths.mulItems(ctrlPoly[1],2)),ctrlPoly[0]),6*(1-t)),maths.mulItems(maths.addArrays(maths.subtract(ctrlPoly[3],maths.mulItems(ctrlPoly[2],2)),ctrlPoly[1]),6*t))}}module2.exports=function fitCurve(points,maxError,progressCallback){if(!Array.isArray(points))throw new TypeError("First argument should be an array");if(points.forEach(point=>{if(!Array.isArray(point)||point.some(item=>"number"!=typeof item)||point.length!==points[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(points=points.filter((point,i)=>0===i||!point.every((val,j)=>val===points[i-1][j]))).length<2)return[];const len=points.length,leftTangent=createTangent(points[1],points[0]),rightTangent=createTangent(points[len-2],points[len-1]);return fitCubic(points,leftTangent,rightTangent,maxError,progressCallback)},module2.exports.fitCubic=fitCubic,module2.exports.createTangent=createTangent},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.AnnotationLayer=void 0;var _util2=__w_pdfjs_require__2(1),_display_utils2=__w_pdfjs_require__2(8),_annotation_storage2=__w_pdfjs_require__2(5),_scripting_utils=__w_pdfjs_require__2(28),_xfa_layer=__w_pdfjs_require__2(29);const GetElementsByNameSet=new WeakSet;function getRectDims(rect){return{width:rect[2]-rect[0],height:rect[3]-rect[1]}}class AnnotationElementFactory{static create(parameters){switch(parameters.data.annotationType){case _util2.AnnotationType.LINK:return new LinkAnnotationElement(parameters);case _util2.AnnotationType.TEXT:return new TextAnnotationElement(parameters);case _util2.AnnotationType.WIDGET:switch(parameters.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(parameters);case"Btn":return parameters.data.radioButton?new RadioButtonWidgetAnnotationElement(parameters):parameters.data.checkBox?new CheckboxWidgetAnnotationElement(parameters):new PushButtonWidgetAnnotationElement(parameters);case"Ch":return new ChoiceWidgetAnnotationElement(parameters)}return new WidgetAnnotationElement(parameters);case _util2.AnnotationType.POPUP:return new PopupAnnotationElement(parameters);case _util2.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(parameters);case _util2.AnnotationType.LINE:return new LineAnnotationElement(parameters);case _util2.AnnotationType.SQUARE:return new SquareAnnotationElement(parameters);case _util2.AnnotationType.CIRCLE:return new CircleAnnotationElement(parameters);case _util2.AnnotationType.POLYLINE:return new PolylineAnnotationElement(parameters);case _util2.AnnotationType.CARET:return new CaretAnnotationElement(parameters);case _util2.AnnotationType.INK:return new InkAnnotationElement(parameters);case _util2.AnnotationType.POLYGON:return new PolygonAnnotationElement(parameters);case _util2.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(parameters);case _util2.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(parameters);case _util2.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(parameters);case _util2.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(parameters);case _util2.AnnotationType.STAMP:return new StampAnnotationElement(parameters);case _util2.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(parameters);default:return new AnnotationElement(parameters)}}}class AnnotationElement{constructor(parameters,{isRenderable=!1,ignoreBorder=!1,createQuadrilaterals=!1}={}){this.isRenderable=isRenderable,this.data=parameters.data,this.layer=parameters.layer,this.page=parameters.page,this.viewport=parameters.viewport,this.linkService=parameters.linkService,this.downloadManager=parameters.downloadManager,this.imageResourcesPath=parameters.imageResourcesPath,this.renderForms=parameters.renderForms,this.svgFactory=parameters.svgFactory,this.annotationStorage=parameters.annotationStorage,this.enableScripting=parameters.enableScripting,this.hasJSActions=parameters.hasJSActions,this._fieldObjects=parameters.fieldObjects,this._mouseState=parameters.mouseState,isRenderable&&(this.container=this._createContainer(ignoreBorder)),createQuadrilaterals&&(this.quadrilaterals=this._createQuadrilaterals(ignoreBorder))}_createContainer(ignoreBorder=!1){const data=this.data,page=this.page,viewport=this.viewport,container=document.createElement("section"),{width,height}=getRectDims(data.rect),[pageLLx,pageLLy,pageURx,pageURy]=viewport.viewBox,pageWidth=pageURx-pageLLx,pageHeight=pageURy-pageLLy;container.setAttribute("data-annotation-id",data.id);const rect=_util2.Util.normalizeRect([data.rect[0],page.view[3]-data.rect[1]+page.view[1],data.rect[2],page.view[3]-data.rect[3]+page.view[1]]);if(!ignoreBorder&&data.borderStyle.width>0){container.style.borderWidth=`${data.borderStyle.width}px`;const horizontalRadius=data.borderStyle.horizontalCornerRadius,verticalRadius=data.borderStyle.verticalCornerRadius;switch(horizontalRadius>0||verticalRadius>0?container.style.borderRadius=`calc(${horizontalRadius}px * var(--scale-factor)) / calc(${verticalRadius}px * var(--scale-factor))`:this instanceof RadioButtonWidgetAnnotationElement&&(container.style.borderRadius=`calc(${width}px * var(--scale-factor)) / calc(${height}px * var(--scale-factor))`),data.borderStyle.style){case _util2.AnnotationBorderStyleType.SOLID:container.style.borderStyle="solid";break;case _util2.AnnotationBorderStyleType.DASHED:container.style.borderStyle="dashed";break;case _util2.AnnotationBorderStyleType.BEVELED:(0,_util2.warn)("Unimplemented border style: beveled");break;case _util2.AnnotationBorderStyleType.INSET:(0,_util2.warn)("Unimplemented border style: inset");break;case _util2.AnnotationBorderStyleType.UNDERLINE:container.style.borderBottomStyle="solid"}const borderColor=data.borderColor||null;borderColor?container.style.borderColor=_util2.Util.makeHexColor(0|borderColor[0],0|borderColor[1],0|borderColor[2]):container.style.borderWidth=0}container.style.left=100*(rect[0]-pageLLx)/pageWidth+"%",container.style.top=100*(rect[1]-pageLLy)/pageHeight+"%";const{rotation}=data;return data.hasOwnCanvas||0===rotation?(container.style.width=100*width/pageWidth+"%",container.style.height=100*height/pageHeight+"%"):this.setRotation(rotation,container),container}setRotation(angle,container=this.container){const[pageLLx,pageLLy,pageURx,pageURy]=this.viewport.viewBox,pageWidth=pageURx-pageLLx,pageHeight=pageURy-pageLLy,{width,height}=getRectDims(this.data.rect);let elementWidth,elementHeight;angle%180==0?(elementWidth=100*width/pageWidth,elementHeight=100*height/pageHeight):(elementWidth=100*height/pageWidth,elementHeight=100*width/pageHeight),container.style.width=`${elementWidth}%`,container.style.height=`${elementHeight}%`,container.setAttribute("data-main-rotation",(360-angle)%360)}get _commonActions(){const setColor=(jsName,styleName,event)=>{const color=event.detail[jsName];event.target.style[styleName]=_scripting_utils.ColorConverters[`${color[0]}_HTML`](color.slice(1))};return(0,_util2.shadow)(this,"_commonActions",{display:event=>{const hidden=event.detail.display%2==1;this.container.style.visibility=hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden,print:0===event.detail.display||3===event.detail.display})},print:event=>{this.annotationStorage.setValue(this.data.id,{print:event.detail.print})},hidden:event=>{this.container.style.visibility=event.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:event.detail.hidden})},focus:event=>{setTimeout(()=>event.target.focus({preventScroll:!1}),0)},userName:event=>{event.target.title=event.detail.userName},readonly:event=>{event.detail.readonly?event.target.setAttribute("readonly",""):event.target.removeAttribute("readonly")},required:event=>{this._setRequired(event.target,event.detail.required)},bgColor:event=>{setColor("bgColor","backgroundColor",event)},fillColor:event=>{setColor("fillColor","backgroundColor",event)},fgColor:event=>{setColor("fgColor","color",event)},textColor:event=>{setColor("textColor","color",event)},borderColor:event=>{setColor("borderColor","borderColor",event)},strokeColor:event=>{setColor("strokeColor","borderColor",event)},rotation:event=>{const angle=event.detail.rotation;this.setRotation(angle),this.annotationStorage.setValue(this.data.id,{rotation:angle})}})}_dispatchEventFromSandbox(actions,jsEvent){const commonActions=this._commonActions;for(const name of Object.keys(jsEvent.detail)){const action=actions[name]||commonActions[name];action&&action(jsEvent)}}_setDefaultPropertiesFromJS(element){if(!this.enableScripting)return;const storedData=this.annotationStorage.getRawValue(this.data.id);if(!storedData)return;const commonActions=this._commonActions;for(const[actionName,detail]of Object.entries(storedData)){const action=commonActions[actionName];action&&(action({detail:{[actionName]:detail},target:element}),delete storedData[actionName])}}_createQuadrilaterals(ignoreBorder=!1){if(!this.data.quadPoints)return null;const quadrilaterals=[],savedRect=this.data.rect;for(const quadPoint of this.data.quadPoints)this.data.rect=[quadPoint[2].x,quadPoint[2].y,quadPoint[1].x,quadPoint[1].y],quadrilaterals.push(this._createContainer(ignoreBorder));return this.data.rect=savedRect,quadrilaterals}_createPopup(trigger,data){let container=this.container;this.quadrilaterals&&(trigger=trigger||this.quadrilaterals,container=this.quadrilaterals[0]),trigger||((trigger=document.createElement("div")).className="popupTriggerArea",container.append(trigger));const popup=new PopupElement({container,trigger,color:data.color,titleObj:data.titleObj,modificationDate:data.modificationDate,contentsObj:data.contentsObj,richText:data.richText,hideWrapper:!0}).render();popup.style.left="100%",container.append(popup)}_renderQuadrilaterals(className){for(const quadrilateral of this.quadrilaterals)quadrilateral.className=className;return this.quadrilaterals}render(){(0,_util2.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(name,skipId=null){const fields=[];if(this._fieldObjects){const fieldObj=this._fieldObjects[name];if(fieldObj)for(const{page,id,exportValues}of fieldObj){if(-1===page||id===skipId)continue;const exportValue="string"==typeof exportValues?exportValues:null,domElement=document.querySelector(`[data-element-id="${id}"]`);!domElement||GetElementsByNameSet.has(domElement)?fields.push({id,exportValue,domElement}):(0,_util2.warn)(`_getElementsByName - element not allowed: ${id}`)}return fields}for(const domElement of document.getElementsByName(name)){const{id,exportValue}=domElement;id!==skipId&&GetElementsByNameSet.has(domElement)&&fields.push({id,exportValue,domElement})}return fields}static get platform(){const platform=typeof navigator<"u"?navigator.platform:"";return(0,_util2.shadow)(this,"platform",{isWin:platform.includes("Win"),isMac:platform.includes("Mac")})}}class LinkAnnotationElement extends AnnotationElement{constructor(parameters,options=null){super(parameters,{isRenderable:!0,ignoreBorder:!!options?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=parameters.data.isTooltipOnly}render(){const{data,linkService}=this,link=document.createElement("a");link.setAttribute("data-element-id",data.id);let isBound=!1;return data.url?(linkService.addLinkAttributes(link,data.url,data.newWindow),isBound=!0):data.action?(this._bindNamedAction(link,data.action),isBound=!0):data.dest?(this._bindLink(link,data.dest),isBound=!0):(data.actions&&(data.actions.Action||data.actions["Mouse Up"]||data.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(link,data),isBound=!0),data.resetForm?(this._bindResetFormAction(link,data.resetForm),isBound=!0):this.isTooltipOnly&&!isBound&&(this._bindLink(link,""),isBound=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((quadrilateral,index)=>{const linkElement=0===index?link:link.cloneNode();return quadrilateral.append(linkElement),quadrilateral}):(this.container.className="linkAnnotation",isBound&&this.container.append(link),this.container)}_bindLink(link,destination){link.href=this.linkService.getDestinationHash(destination),link.onclick=()=>(destination&&this.linkService.goToDestination(destination),!1),(destination||""===destination)&&(link.className="internalLink")}_bindNamedAction(link,action){link.href=this.linkService.getAnchorUrl(""),link.onclick=()=>(this.linkService.executeNamedAction(action),!1),link.className="internalLink"}_bindJSAction(link,data){link.href=this.linkService.getAnchorUrl("");const map=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const name of Object.keys(data.actions)){const jsName=map.get(name);jsName&&(link[jsName]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:data.id,name}}),!1))}link.onclick||(link.onclick=()=>!1),link.className="internalLink"}_bindResetFormAction(link,resetForm){const otherClickAction=link.onclick;if(otherClickAction||(link.href=this.linkService.getAnchorUrl("")),link.className="internalLink",!this._fieldObjects)return(0,_util2.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(otherClickAction||(link.onclick=()=>!1));link.onclick=()=>{otherClickAction&&otherClickAction();const{fields:resetFormFields,refs:resetFormRefs,include}=resetForm,allFields=[];if(0!==resetFormFields.length||0!==resetFormRefs.length){const fieldIds=new Set(resetFormRefs);for(const fieldName of resetFormFields){const fields=this._fieldObjects[fieldName]||[];for(const{id}of fields)fieldIds.add(id)}for(const fields of Object.values(this._fieldObjects))for(const field of fields)fieldIds.has(field.id)===include&&allFields.push(field)}else for(const fields of Object.values(this._fieldObjects))allFields.push(...fields);const storage=this.annotationStorage,allIds=[];for(const field of allFields){const{id}=field;switch(allIds.push(id),field.type){case"text":case"combobox":case"listbox":storage.setValue(id,{value:field.defaultValue||""});break;case"checkbox":case"radiobutton":storage.setValue(id,{value:field.defaultValue===field.exportValues});break;default:continue}const domElement=document.querySelector(`[data-element-id="${id}"]`);domElement&&(GetElementsByNameSet.has(domElement)?domElement.dispatchEvent(new Event("resetform")):(0,_util2.warn)(`_bindResetFormAction - element not allowed: ${id}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:allIds,name:"ResetForm"}}),!1}}}class TextAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str)})}render(){this.container.className="textAnnotation";const image=document.createElement("img");return image.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",image.alt="[{{type}} Annotation]",image.dataset.l10nId="text_annotation_type",image.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(image,this.data),this.container.append(image),this.container}}class WidgetAnnotationElement extends AnnotationElement{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(event){const{isWin,isMac}=AnnotationElement.platform;return isWin&&event.ctrlKey||isMac&&event.metaKey}_setEventListener(element,baseName,eventName,valueGetter){baseName.includes("mouse")?element.addEventListener(baseName,event=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:eventName,value:valueGetter(event),shift:event.shiftKey,modifier:this._getKeyModifier(event)}})}):element.addEventListener(baseName,event=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:eventName,value:valueGetter(event)}})})}_setEventListeners(element,names,getter){for(const[baseName,eventName]of names)("Action"===eventName||this.data.actions?.[eventName])&&this._setEventListener(element,baseName,eventName,getter)}_setBackgroundColor(element){const color=this.data.backgroundColor||null;element.style.backgroundColor=null===color?"transparent":_util2.Util.makeHexColor(color[0],color[1],color[2])}_setTextStyle(element){const{fontColor}=this.data.defaultAppearanceData,fontSize=this.data.defaultAppearanceData.fontSize||9,style=element.style;let computedFontSize;if(this.data.multiLine){const height=Math.abs(this.data.rect[3]-this.data.rect[1]),numberOfLines=Math.round(height/(_util2.LINE_FACTOR*fontSize))||1;computedFontSize=Math.min(fontSize,Math.round(height/numberOfLines/_util2.LINE_FACTOR))}else{const height=Math.abs(this.data.rect[3]-this.data.rect[1]);computedFontSize=Math.min(fontSize,Math.round(height/_util2.LINE_FACTOR))}style.fontSize=`calc(${computedFontSize}px * var(--scale-factor))`,style.color=_util2.Util.makeHexColor(fontColor[0],fontColor[1],fontColor[2]),null!==this.data.textAlignment&&(style.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(element,isRequired){isRequired?element.setAttribute("required",!0):element.removeAttribute("required"),element.setAttribute("aria-required",isRequired)}}class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(parameters){super(parameters,{isRenderable:parameters.renderForms||!parameters.data.hasAppearance&&!!parameters.data.fieldValue})}setPropertyOnSiblings(base,key,value,keyInStorage){const storage=this.annotationStorage;for(const element of this._getElementsByName(base.name,base.id))element.domElement&&(element.domElement[key]=value),storage.setValue(element.id,{[keyInStorage]:value})}render(){const storage=this.annotationStorage,id=this.data.id;this.container.className="textWidgetAnnotation";let element=null;if(this.renderForms){const storedData=storage.getValue(id,{value:this.data.fieldValue});let textContent=storedData.formattedValue||storedData.value||"";const maxLen=storage.getValue(id,{charLimit:this.data.maxLen}).charLimit;maxLen&&textContent.length>maxLen&&(textContent=textContent.slice(0,maxLen));const elementData={userValue:textContent,formattedValue:null,valueOnFocus:""};this.data.multiLine?(element=document.createElement("textarea"),element.textContent=textContent,this.data.doNotScroll&&(element.style.overflowY="hidden")):(element=document.createElement("input"),element.type="text",element.setAttribute("value",textContent),this.data.doNotScroll&&(element.style.overflowX="hidden")),GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=this.data.readOnly,element.name=this.data.fieldName,element.tabIndex=1e3,this._setRequired(element,this.data.required),maxLen&&(element.maxLength=maxLen),element.addEventListener("input",event=>{storage.setValue(id,{value:event.target.value}),this.setPropertyOnSiblings(element,"value",event.target.value,"value")}),element.addEventListener("resetform",event=>{element.value=elementData.userValue=this.data.defaultFieldValue??"",elementData.formattedValue=null});let blurListener=event=>{const{formattedValue}=elementData;null!=formattedValue&&(event.target.value=formattedValue),event.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){element.addEventListener("focus",event=>{elementData.userValue&&(event.target.value=elementData.userValue),elementData.valueOnFocus=event.target.value}),element.addEventListener("updatefromsandbox",jsEvent=>{this._dispatchEventFromSandbox({value(event){elementData.userValue=event.detail.value??"",storage.setValue(id,{value:elementData.userValue.toString()}),event.target.value=elementData.userValue},formattedValue(event){const{formattedValue}=event.detail;elementData.formattedValue=formattedValue,null!=formattedValue&&event.target!==document.activeElement&&(event.target.value=formattedValue),storage.setValue(id,{formattedValue})},selRange(event){event.target.setSelectionRange(...event.detail.selRange)},charLimit:event=>{const{charLimit}=event.detail,{target}=event;if(0===charLimit)return void target.removeAttribute("maxLength");target.setAttribute("maxLength",charLimit);let value=elementData.userValue;!value||value.length<=charLimit||(value=value.slice(0,charLimit),target.value=elementData.userValue=value,storage.setValue(id,{value}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id,name:"Keystroke",value,willCommit:!0,commitKey:1,selStart:target.selectionStart,selEnd:target.selectionEnd}}))}},jsEvent)}),element.addEventListener("keydown",event=>{let commitKey=-1;if("Escape"===event.key?commitKey=0:"Enter"===event.key?commitKey=2:"Tab"===event.key&&(commitKey=3),-1===commitKey)return;const{value}=event.target;elementData.valueOnFocus!==value&&(elementData.userValue=value,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id,name:"Keystroke",value,willCommit:!0,commitKey,selStart:event.target.selectionStart,selEnd:event.target.selectionEnd}}))});const _blurListener=blurListener;blurListener=null,element.addEventListener("blur",event=>{const{value}=event.target;elementData.userValue=value,this._mouseState.isDown&&elementData.valueOnFocus!==value&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id,name:"Keystroke",value,willCommit:!0,commitKey:1,selStart:event.target.selectionStart,selEnd:event.target.selectionEnd}}),_blurListener(event)}),this.data.actions?.Keystroke&&element.addEventListener("beforeinput",event=>{const{data,target}=event,{value,selectionStart,selectionEnd}=target;let selStart=selectionStart,selEnd=selectionEnd;switch(event.inputType){case"deleteWordBackward":{const match=value.substring(0,selectionStart).match(/\w*[^\w]*$/);match&&(selStart-=match[0].length);break}case"deleteWordForward":{const match=value.substring(selectionStart).match(/^[^\w]*\w*/);match&&(selEnd+=match[0].length);break}case"deleteContentBackward":selectionStart===selectionEnd&&(selStart-=1);break;case"deleteContentForward":selectionStart===selectionEnd&&(selEnd+=1)}event.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id,name:"Keystroke",value,change:data||"",willCommit:!1,selStart,selEnd}})}),this._setEventListeners(element,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],event=>event.target.value)}if(blurListener&&element.addEventListener("blur",blurListener),this.data.comb){const combWidth=(this.data.rect[2]-this.data.rect[0])/maxLen;element.classList.add("comb"),element.style.letterSpacing=`calc(${combWidth}px * var(--scale-factor) - 1ch)`}}else element=document.createElement("div"),element.textContent=this.data.fieldValue,element.style.verticalAlign="middle",element.style.display="table-cell";return this._setTextStyle(element),this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(parameters){super(parameters,{isRenderable:parameters.renderForms})}render(){const storage=this.annotationStorage,data=this.data,id=data.id;let value=storage.getValue(id,{value:data.exportValue===data.fieldValue}).value;"string"==typeof value&&(value="Off"!==value,storage.setValue(id,{value})),this.container.className="buttonWidgetAnnotation checkBox";const element=document.createElement("input");return GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=data.readOnly,this._setRequired(element,this.data.required),element.type="checkbox",element.name=data.fieldName,value&&element.setAttribute("checked",!0),element.setAttribute("exportValue",data.exportValue),element.tabIndex=1e3,element.addEventListener("change",event=>{const{name,checked}=event.target;for(const checkbox of this._getElementsByName(name,id)){const curChecked=checked&&checkbox.exportValue===data.exportValue;checkbox.domElement&&(checkbox.domElement.checked=curChecked),storage.setValue(checkbox.id,{value:curChecked})}storage.setValue(id,{value:checked})}),element.addEventListener("resetform",event=>{event.target.checked=(data.defaultFieldValue||"Off")===data.exportValue}),this.enableScripting&&this.hasJSActions&&(element.addEventListener("updatefromsandbox",jsEvent=>{this._dispatchEventFromSandbox({value(event){event.target.checked="Off"!==event.detail.value,storage.setValue(id,{value:event.target.checked})}},jsEvent)}),this._setEventListeners(element,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],event=>event.target.checked)),this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(parameters){super(parameters,{isRenderable:parameters.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const storage=this.annotationStorage,data=this.data,id=data.id;let value=storage.getValue(id,{value:data.fieldValue===data.buttonValue}).value;"string"==typeof value&&(value=value!==data.buttonValue,storage.setValue(id,{value}));const element=document.createElement("input");if(GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=data.readOnly,this._setRequired(element,this.data.required),element.type="radio",element.name=data.fieldName,value&&element.setAttribute("checked",!0),element.tabIndex=1e3,element.addEventListener("change",event=>{const{name,checked}=event.target;for(const radio of this._getElementsByName(name,id))storage.setValue(radio.id,{value:!1});storage.setValue(id,{value:checked})}),element.addEventListener("resetform",event=>{const defaultValue=data.defaultFieldValue;event.target.checked=null!=defaultValue&&defaultValue===data.buttonValue}),this.enableScripting&&this.hasJSActions){const pdfButtonValue=data.buttonValue;element.addEventListener("updatefromsandbox",jsEvent=>{this._dispatchEventFromSandbox({value:event=>{const checked=pdfButtonValue===event.detail.value;for(const radio of this._getElementsByName(event.target.name)){const curChecked=checked&&radio.id===id;radio.domElement&&(radio.domElement.checked=curChecked),storage.setValue(radio.id,{value:curChecked})}}},jsEvent)}),this._setEventListeners(element,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],event=>event.target.checked)}return this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{constructor(parameters){super(parameters,{ignoreBorder:parameters.data.hasAppearance})}render(){const container=super.render();container.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(container.title=this.data.alternativeText);const linkElement=container.lastChild;return this.enableScripting&&this.hasJSActions&&linkElement&&(this._setDefaultPropertiesFromJS(linkElement),linkElement.addEventListener("updatefromsandbox",jsEvent=>{this._dispatchEventFromSandbox({},jsEvent)})),container}}class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(parameters){super(parameters,{isRenderable:parameters.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const storage=this.annotationStorage,id=this.data.id,storedData=storage.getValue(id,{value:this.data.fieldValue}),selectElement=document.createElement("select");GetElementsByNameSet.add(selectElement),selectElement.setAttribute("data-element-id",id),selectElement.disabled=this.data.readOnly,this._setRequired(selectElement,this.data.required),selectElement.name=this.data.fieldName,selectElement.tabIndex=1e3;let addAnEmptyEntry=this.data.combo&&this.data.options.length>0;this.data.combo||(selectElement.size=this.data.options.length,this.data.multiSelect&&(selectElement.multiple=!0)),selectElement.addEventListener("resetform",event=>{const defaultValue=this.data.defaultFieldValue;for(const option of selectElement.options)option.selected=option.value===defaultValue});for(const option of this.data.options){const optionElement=document.createElement("option");optionElement.textContent=option.displayValue,optionElement.value=option.exportValue,storedData.value.includes(option.exportValue)&&(optionElement.setAttribute("selected",!0),addAnEmptyEntry=!1),selectElement.append(optionElement)}let removeEmptyEntry=null;if(addAnEmptyEntry){const noneOptionElement=document.createElement("option");noneOptionElement.value=" ",noneOptionElement.setAttribute("hidden",!0),noneOptionElement.setAttribute("selected",!0),selectElement.prepend(noneOptionElement),removeEmptyEntry=()=>{noneOptionElement.remove(),selectElement.removeEventListener("input",removeEmptyEntry),removeEmptyEntry=null},selectElement.addEventListener("input",removeEmptyEntry)}const getValue=(event,isExport)=>{const name=isExport?"value":"textContent",options=event.target.options;return event.target.multiple?Array.prototype.filter.call(options,option=>option.selected).map(option=>option[name]):-1===options.selectedIndex?null:options[options.selectedIndex][name]},getItems=event=>Array.prototype.map.call(event.target.options,option=>({displayValue:option.textContent,exportValue:option.value}));return this.enableScripting&&this.hasJSActions?(selectElement.addEventListener("updatefromsandbox",jsEvent=>{this._dispatchEventFromSandbox({value(event){removeEmptyEntry?.();const value=event.detail.value,values=new Set(Array.isArray(value)?value:[value]);for(const option of selectElement.options)option.selected=values.has(option.value);storage.setValue(id,{value:getValue(event,!0)})},multipleSelection(event){selectElement.multiple=!0},remove(event){const options=selectElement.options,index=event.detail.remove;options[index].selected=!1,selectElement.remove(index),options.length>0&&-1===Array.prototype.findIndex.call(options,option=>option.selected)&&(options[0].selected=!0),storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},clear(event){for(;0!==selectElement.length;)selectElement.remove(0);storage.setValue(id,{value:null,items:[]})},insert(event){const{index,displayValue,exportValue}=event.detail.insert,selectChild=selectElement.children[index],optionElement=document.createElement("option");optionElement.textContent=displayValue,optionElement.value=exportValue,selectChild?selectChild.before(optionElement):selectElement.append(optionElement),storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},items(event){const{items}=event.detail;for(;0!==selectElement.length;)selectElement.remove(0);for(const item of items){const{displayValue,exportValue}=item,optionElement=document.createElement("option");optionElement.textContent=displayValue,optionElement.value=exportValue,selectElement.append(optionElement)}selectElement.options.length>0&&(selectElement.options[0].selected=!0),storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},indices(event){const indices=new Set(event.detail.indices);for(const option of event.target.options)option.selected=indices.has(option.index);storage.setValue(id,{value:getValue(event,!0)})},editable(event){event.target.disabled=!event.detail.editable}},jsEvent)}),selectElement.addEventListener("input",event=>{const exportValue=getValue(event,!0),value=getValue(event,!1);storage.setValue(id,{value:exportValue}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id,name:"Keystroke",value,changeEx:exportValue,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(selectElement,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],event=>event.target.checked)):selectElement.addEventListener("input",function(event){storage.setValue(id,{value:getValue(event,!0)})}),this.data.combo&&this._setTextStyle(selectElement),this._setBackgroundColor(selectElement),this._setDefaultPropertiesFromJS(selectElement),this.container.append(selectElement),this.container}}class PopupAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const parentElements=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(0===parentElements.length)return this.container;const popup=new PopupElement({container:this.container,trigger:Array.from(parentElements),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),page=this.page,rect=_util2.Util.normalizeRect([this.data.parentRect[0],page.view[3]-this.data.parentRect[1]+page.view[1],this.data.parentRect[2],page.view[3]-this.data.parentRect[3]+page.view[1]]),popupLeft=rect[0]+this.data.parentRect[2]-this.data.parentRect[0],popupTop=rect[1],[pageLLx,pageLLy,pageURx,pageURy]=this.viewport.viewBox,pageHeight=pageURy-pageLLy;return this.container.style.left=100*(popupLeft-pageLLx)/(pageURx-pageLLx)+"%",this.container.style.top=100*(popupTop-pageLLy)/pageHeight+"%",this.container.append(popup.render()),this.container}}class PopupElement{constructor(parameters){this.container=parameters.container,this.trigger=parameters.trigger,this.color=parameters.color,this.titleObj=parameters.titleObj,this.modificationDate=parameters.modificationDate,this.contentsObj=parameters.contentsObj,this.richText=parameters.richText,this.hideWrapper=parameters.hideWrapper||!1,this.pinned=!1}render(){const wrapper=document.createElement("div");wrapper.className="popupWrapper",this.hideElement=this.hideWrapper?wrapper:this.container,this.hideElement.hidden=!0;const popup=document.createElement("div");popup.className="popup";const color=this.color;color&&(popup.style.backgroundColor=_util2.Util.makeHexColor(0|.7*(255-color[0])+color[0],0|.7*(255-color[1])+color[1],0|.7*(255-color[2])+color[2]));const title=document.createElement("h1");title.dir=this.titleObj.dir,title.textContent=this.titleObj.str,popup.append(title);const dateObject=_display_utils2.PDFDateString.toDateObject(this.modificationDate);if(dateObject){const modificationDate=document.createElement("span");modificationDate.className="popupDate",modificationDate.textContent="{{date}}, {{time}}",modificationDate.dataset.l10nId="annotation_date_string",modificationDate.dataset.l10nArgs=JSON.stringify({date:dateObject.toLocaleDateString(),time:dateObject.toLocaleTimeString()}),popup.append(modificationDate)}if(!this.richText?.str||this.contentsObj?.str&&this.contentsObj.str!==this.richText.str){const contents=this._formatContents(this.contentsObj);popup.append(contents)}else _xfa_layer.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:popup}),popup.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const element of this.trigger)element.addEventListener("click",this._toggle.bind(this)),element.addEventListener("mouseover",this._show.bind(this,!1)),element.addEventListener("mouseout",this._hide.bind(this,!1));return popup.addEventListener("click",this._hide.bind(this,!0)),wrapper.append(popup),wrapper}_formatContents({str,dir}){const p=document.createElement("p");p.className="popupContent",p.dir=dir;const lines=str.split(/(?:\r\n?|\n)/);for(let i=0,ii=lines.length;i<ii;++i)p.append(document.createTextNode(lines[i])),i<ii-1&&p.append(document.createElement("br"));return p}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(pin=!1){pin&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(unpin=!0){unpin&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class FreeTextAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0}),this.textContent=parameters.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const content=document.createElement("div");content.className="annotationTextContent",content.setAttribute("role","comment");for(const line of this.textContent){const lineSpan=document.createElement("span");lineSpan.textContent=line,content.append(lineSpan)}this.container.append(content)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class LineAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const data=this.data,{width,height}=getRectDims(data.rect),svg=this.svgFactory.create(width,height,!0),line=this.svgFactory.createElement("svg:line");return line.setAttribute("x1",data.rect[2]-data.lineCoordinates[0]),line.setAttribute("y1",data.rect[3]-data.lineCoordinates[1]),line.setAttribute("x2",data.rect[2]-data.lineCoordinates[2]),line.setAttribute("y2",data.rect[3]-data.lineCoordinates[3]),line.setAttribute("stroke-width",data.borderStyle.width||1),line.setAttribute("stroke","transparent"),line.setAttribute("fill","transparent"),svg.append(line),this.container.append(svg),this._createPopup(line,data),this.container}}class SquareAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const data=this.data,{width,height}=getRectDims(data.rect),svg=this.svgFactory.create(width,height,!0),borderWidth=data.borderStyle.width,square=this.svgFactory.createElement("svg:rect");return square.setAttribute("x",borderWidth/2),square.setAttribute("y",borderWidth/2),square.setAttribute("width",width-borderWidth),square.setAttribute("height",height-borderWidth),square.setAttribute("stroke-width",borderWidth||1),square.setAttribute("stroke","transparent"),square.setAttribute("fill","transparent"),svg.append(square),this.container.append(svg),this._createPopup(square,data),this.container}}class CircleAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const data=this.data,{width,height}=getRectDims(data.rect),svg=this.svgFactory.create(width,height,!0),borderWidth=data.borderStyle.width,circle=this.svgFactory.createElement("svg:ellipse");return circle.setAttribute("cx",width/2),circle.setAttribute("cy",height/2),circle.setAttribute("rx",width/2-borderWidth/2),circle.setAttribute("ry",height/2-borderWidth/2),circle.setAttribute("stroke-width",borderWidth||1),circle.setAttribute("stroke","transparent"),circle.setAttribute("fill","transparent"),svg.append(circle),this.container.append(svg),this._createPopup(circle,data),this.container}}class PolylineAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const data=this.data,{width,height}=getRectDims(data.rect),svg=this.svgFactory.create(width,height,!0);let points=[];for(const coordinate of data.vertices)points.push(coordinate.x-data.rect[0]+","+(data.rect[3]-coordinate.y));points=points.join(" ");const polyline=this.svgFactory.createElement(this.svgElementName);return polyline.setAttribute("points",points),polyline.setAttribute("stroke-width",data.borderStyle.width||1),polyline.setAttribute("stroke","transparent"),polyline.setAttribute("fill","transparent"),svg.append(polyline),this.container.append(svg),this._createPopup(polyline,data),this.container}}class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(parameters){super(parameters),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class CaretAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class InkAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const data=this.data,{width,height}=getRectDims(data.rect),svg=this.svgFactory.create(width,height,!0);for(const inkList of data.inkLists){let points=[];for(const coordinate of inkList)points.push(`${coordinate.x-data.rect[0]},${data.rect[3]-coordinate.y}`);points=points.join(" ");const polyline=this.svgFactory.createElement(this.svgElementName);polyline.setAttribute("points",points),polyline.setAttribute("stroke-width",data.borderStyle.width||1),polyline.setAttribute("stroke","transparent"),polyline.setAttribute("fill","transparent"),this._createPopup(polyline,data),svg.append(polyline)}return this.container.append(svg),this.container}}class HighlightAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class UnderlineAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class SquigglyAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class StrikeOutAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class StampAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!!(parameters.data.hasPopup||parameters.data.titleObj?.str||parameters.data.contentsObj?.str||parameters.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class FileAttachmentAnnotationElement extends AnnotationElement{constructor(parameters){super(parameters,{isRenderable:!0});const{filename,content}=this.data.file;this.filename=(0,_display_utils2.getFilenameFromUrl)(filename),this.content=content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename,content})}render(){this.container.className="fileAttachmentAnnotation";const trigger=document.createElement("div");return trigger.className="popupTriggerArea",trigger.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(trigger,this.data),this.container.append(trigger),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class AnnotationLayer{static#appendElement(element,id,div,accessibilityManager){const contentElement=element.firstChild||element;contentElement.id=`${_display_utils2.AnnotationPrefix}${id}`,div.append(element),accessibilityManager?.moveElementInDOM(div,element,contentElement,!1)}static render(parameters){const{annotations,div,viewport,accessibilityManager}=parameters;this.#setDimensions(div,viewport);let zIndex=0;for(const data of annotations){if(data.annotationType!==_util2.AnnotationType.POPUP){const{width,height}=getRectDims(data.rect);if(width<=0||height<=0)continue}const element=AnnotationElementFactory.create({data,layer:div,page:parameters.page,viewport,linkService:parameters.linkService,downloadManager:parameters.downloadManager,imageResourcesPath:parameters.imageResourcesPath||"",renderForms:!1!==parameters.renderForms,svgFactory:new _display_utils2.DOMSVGFactory,annotationStorage:parameters.annotationStorage||new _annotation_storage2.AnnotationStorage,enableScripting:parameters.enableScripting,hasJSActions:parameters.hasJSActions,fieldObjects:parameters.fieldObjects,mouseState:parameters.mouseState||{isDown:!1}});if(element.isRenderable){const rendered=element.render();if(data.hidden&&(rendered.style.visibility="hidden"),Array.isArray(rendered))for(const renderedElement of rendered)renderedElement.style.zIndex=zIndex++,AnnotationLayer.#appendElement(renderedElement,data.id,div,accessibilityManager);else rendered.style.zIndex=zIndex++,element instanceof PopupAnnotationElement?div.prepend(rendered):AnnotationLayer.#appendElement(rendered,data.id,div,accessibilityManager)}}this.#setAnnotationCanvasMap(div,parameters.annotationCanvasMap)}static update(parameters){const{annotationCanvasMap,div,viewport}=parameters;this.#setDimensions(div,viewport),this.#setAnnotationCanvasMap(div,annotationCanvasMap),div.hidden=!1}static#setDimensions(div,{width,height,rotation}){const{style}=div,flipOrientation=rotation%180!=0,widthStr=Math.floor(width)+"px",heightStr=Math.floor(height)+"px";style.width=flipOrientation?heightStr:widthStr,style.height=flipOrientation?widthStr:heightStr,div.setAttribute("data-main-rotation",rotation)}static#setAnnotationCanvasMap(div,annotationCanvasMap){if(annotationCanvasMap){for(const[id,canvas]of annotationCanvasMap){const element=div.querySelector(`[data-annotation-id="${id}"]`);if(!element)continue;const{firstChild}=element;firstChild?"CANVAS"===firstChild.nodeName?firstChild.replaceWith(canvas):firstChild.before(canvas):element.append(canvas)}annotationCanvasMap.clear()}}}exports2.AnnotationLayer=AnnotationLayer},(__unused_webpack_module2,exports2)=>{function makeColorComp(n){return Math.floor(255*Math.max(0,Math.min(1,n))).toString(16).padStart(2,"0")}Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.ColorConverters=void 0,exports2.ColorConverters=class ColorConverters{static CMYK_G([c,y,m,k]){return["G",1-Math.min(1,.3*c+.59*m+.11*y+k)]}static G_CMYK([g]){return["CMYK",0,0,0,1-g]}static G_RGB([g]){return["RGB",g,g,g]}static G_HTML([g]){const G=makeColorComp(g);return`#${G}${G}${G}`}static RGB_G([r,g,b]){return["G",.3*r+.59*g+.11*b]}static RGB_HTML([r,g,b]){return`#${makeColorComp(r)}${makeColorComp(g)}${makeColorComp(b)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([c,y,m,k]){return["RGB",1-Math.min(1,c+k),1-Math.min(1,m+k),1-Math.min(1,y+k)]}static CMYK_HTML(components){const rgb=this.CMYK_RGB(components).slice(1);return this.RGB_HTML(rgb)}static RGB_CMYK([r,g,b]){const c=1-r,m=1-g,y=1-b;return["CMYK",c,m,y,Math.min(c,m,y)]}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.XfaLayer=void 0;var _xfa_text2=__w_pdfjs_require__2(20);exports2.XfaLayer=class XfaLayer{static setupStorage(html,id,element,storage,intent){const storedData=storage.getValue(id,{value:null});switch(element.name){case"textarea":if(null!==storedData.value&&(html.textContent=storedData.value),"print"===intent)break;html.addEventListener("input",event=>{storage.setValue(id,{value:event.target.value})});break;case"input":if("radio"===element.attributes.type||"checkbox"===element.attributes.type){if(storedData.value===element.attributes.xfaOn?html.setAttribute("checked",!0):storedData.value===element.attributes.xfaOff&&html.removeAttribute("checked"),"print"===intent)break;html.addEventListener("change",event=>{storage.setValue(id,{value:event.target.getAttribute(event.target.checked?"xfaOn":"xfaOff")})})}else{if(null!==storedData.value&&html.setAttribute("value",storedData.value),"print"===intent)break;html.addEventListener("input",event=>{storage.setValue(id,{value:event.target.value})})}break;case"select":if(null!==storedData.value)for(const option of element.children)option.attributes.value===storedData.value&&(option.attributes.selected=!0);html.addEventListener("input",event=>{const options=event.target.options;storage.setValue(id,{value:-1===options.selectedIndex?"":options[options.selectedIndex].value})})}}static setAttributes({html,element,storage=null,intent,linkService}){const{attributes}=element,isHTMLAnchorElement=html instanceof HTMLAnchorElement;"radio"===attributes.type&&(attributes.name=`${attributes.name}-${intent}`);for(const[key,value]of Object.entries(attributes))if(null!=value)switch(key){case"class":value.length&&html.setAttribute(key,value.join(" "));break;case"dataId":break;case"id":html.setAttribute("data-element-id",value);break;case"style":Object.assign(html.style,value);break;case"textContent":html.textContent=value;break;default:(!isHTMLAnchorElement||"href"!==key&&"newWindow"!==key)&&html.setAttribute(key,value)}isHTMLAnchorElement&&linkService.addLinkAttributes(html,attributes.href,attributes.newWindow),storage&&attributes.dataId&&this.setupStorage(html,attributes.dataId,element,storage)}static render(parameters){const storage=parameters.annotationStorage,linkService=parameters.linkService,root=parameters.xfaHtml,intent=parameters.intent||"display",rootHtml=document.createElement(root.name);root.attributes&&this.setAttributes({html:rootHtml,element:root,intent,linkService});const stack=[[root,-1,rootHtml]],rootDiv=parameters.div;if(rootDiv.append(rootHtml),parameters.viewport){const transform=`matrix(${parameters.viewport.transform.join(",")})`;rootDiv.style.transform=transform}"richText"!==intent&&rootDiv.setAttribute("class","xfaLayer xfaFont");const textDivs=[];for(;stack.length>0;){const[parent,i,html]=stack.at(-1);if(i+1===parent.children.length){stack.pop();continue}const child=parent.children[++stack.at(-1)[1]];if(null===child)continue;const{name}=child;if("#text"===name){const node=document.createTextNode(child.value);textDivs.push(node),html.append(node);continue}let childHtml;if(childHtml=child?.attributes?.xmlns?document.createElementNS(child.attributes.xmlns,name):document.createElement(name),html.append(childHtml),child.attributes&&this.setAttributes({html:childHtml,element:child,storage,intent,linkService}),child.children&&child.children.length>0)stack.push([child,-1,childHtml]);else if(child.value){const node=document.createTextNode(child.value);_xfa_text2.XfaText.shouldBuildText(name)&&textDivs.push(node),childHtml.append(node)}}for(const el of rootDiv.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))el.setAttribute("readOnly",!0);return{textDivs}}static update(parameters){const transform=`matrix(${parameters.viewport.transform.join(",")})`;parameters.div.style.transform=transform,parameters.div.hidden=!1}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.TextLayerRenderTask=void 0,exports2.renderTextLayer=function renderTextLayer(renderParameters){const task=new TextLayerRenderTask({textContent:renderParameters.textContent,textContentStream:renderParameters.textContentStream,container:renderParameters.container,viewport:renderParameters.viewport,textDivs:renderParameters.textDivs,textContentItemsStr:renderParameters.textContentItemsStr,enhanceTextSelection:renderParameters.enhanceTextSelection});return task._render(renderParameters.timeout),task};var _util2=__w_pdfjs_require__2(1),_display_utils2=__w_pdfjs_require__2(8);const ascentCache=new Map,AllWhitespaceRegexp=/^\s+$/g;function appendText(task,geom,styles,ctx){const textDiv=document.createElement("span"),textDivProperties=task._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==geom.str,hasEOL:geom.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==geom.str,hasEOL:geom.hasEOL,fontSize:0};task._textDivs.push(textDiv);const tx=_util2.Util.transform(task._viewport.transform,geom.transform);let angle=Math.atan2(tx[1],tx[0]);const style=styles[geom.fontName];style.vertical&&(angle+=Math.PI/2);const fontHeight=Math.hypot(tx[2],tx[3]),fontAscent=fontHeight*function getAscent(fontFamily,ctx){const cachedAscent=ascentCache.get(fontFamily);if(cachedAscent)return cachedAscent;ctx.save(),ctx.font=`30px ${fontFamily}`;const metrics=ctx.measureText("");let ascent=metrics.fontBoundingBoxAscent,descent=Math.abs(metrics.fontBoundingBoxDescent);if(ascent){ctx.restore();const ratio=ascent/(ascent+descent);return ascentCache.set(fontFamily,ratio),ratio}ctx.strokeStyle="red",ctx.clearRect(0,0,30,30),ctx.strokeText("g",0,0);let pixels=ctx.getImageData(0,0,30,30).data;descent=0;for(let i=pixels.length-1-3;i>=0;i-=4)if(pixels[i]>0){descent=Math.ceil(i/4/30);break}ctx.clearRect(0,0,30,30),ctx.strokeText("A",0,30),pixels=ctx.getImageData(0,0,30,30).data,ascent=0;for(let i=0,ii=pixels.length;i<ii;i+=4)if(pixels[i]>0){ascent=30-Math.floor(i/4/30);break}if(ctx.restore(),ascent){const ratio=ascent/(ascent+descent);return ascentCache.set(fontFamily,ratio),ratio}return ascentCache.set(fontFamily,.8),.8}(style.fontFamily,ctx);let left,top;0===angle?(left=tx[4],top=tx[5]-fontAscent):(left=tx[4]+fontAscent*Math.sin(angle),top=tx[5]-fontAscent*Math.cos(angle)),textDiv.style.left=`${left}px`,textDiv.style.top=`${top}px`,textDiv.style.fontSize=`${fontHeight}px`,textDiv.style.fontFamily=style.fontFamily,textDivProperties.fontSize=fontHeight,textDiv.setAttribute("role","presentation"),textDiv.textContent=geom.str,textDiv.dir=geom.dir,task._fontInspectorEnabled&&(textDiv.dataset.fontName=geom.fontName),0!==angle&&(textDivProperties.angle=angle*(180/Math.PI));let shouldScaleText=!1;if(geom.str.length>1||task._enhanceTextSelection&&AllWhitespaceRegexp.test(geom.str))shouldScaleText=!0;else if(" "!==geom.str&&geom.transform[0]!==geom.transform[3]){const absScaleX=Math.abs(geom.transform[0]),absScaleY=Math.abs(geom.transform[3]);absScaleX!==absScaleY&&Math.max(absScaleX,absScaleY)/Math.min(absScaleX,absScaleY)>1.5&&(shouldScaleText=!0)}if(shouldScaleText&&(textDivProperties.canvasWidth=style.vertical?geom.height*task._viewport.scale:geom.width*task._viewport.scale),task._textDivProperties.set(textDiv,textDivProperties),task._textContentStream&&task._layoutText(textDiv),task._enhanceTextSelection&&textDivProperties.hasText){let angleCos=1,angleSin=0;0!==angle&&(angleCos=Math.cos(angle),angleSin=Math.sin(angle));const divWidth=(style.vertical?geom.height:geom.width)*task._viewport.scale,divHeight=fontHeight;let m,b;0!==angle?(m=[angleCos,angleSin,-angleSin,angleCos,left,top],b=_util2.Util.getAxialAlignedBoundingBox([0,0,divWidth,divHeight],m)):b=[left,top,left+divWidth,top+divHeight],task._bounds.push({left:b[0],top:b[1],right:b[2],bottom:b[3],div:textDiv,size:[divWidth,divHeight],m})}}function render(task){if(task._canceled)return;const textDivs=task._textDivs,capability=task._capability,textDivsLength=textDivs.length;if(textDivsLength>1e5)return task._renderingDone=!0,void capability.resolve();if(!task._textContentStream)for(let i=0;i<textDivsLength;i++)task._layoutText(textDivs[i]);task._renderingDone=!0,capability.resolve()}function findPositiveMin(ts,offset,count){let result=0;for(let i=0;i<count;i++){const t=ts[offset++];t>0&&(result=result?Math.min(t,result):t)}return result}function expandBoundsLTR(width,bounds){bounds.sort(function(a,b){return a.x1-b.x1||a.index-b.index});const horizon=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const boundary of bounds){let i=0;for(;i<horizon.length&&horizon[i].end<=boundary.y1;)i++;let j=horizon.length-1;for(;j>=0&&horizon[j].start>=boundary.y2;)j--;let horizonPart,affectedBoundary,q,k,maxXNew=-1/0;for(q=i;q<=j;q++){let xNew;horizonPart=horizon[q],affectedBoundary=horizonPart.boundary,xNew=affectedBoundary.x2>boundary.x1?affectedBoundary.index>boundary.index?affectedBoundary.x1New:boundary.x1:void 0===affectedBoundary.x2New?(affectedBoundary.x2+boundary.x1)/2:affectedBoundary.x2New,xNew>maxXNew&&(maxXNew=xNew)}for(boundary.x1New=maxXNew,q=i;q<=j;q++)horizonPart=horizon[q],affectedBoundary=horizonPart.boundary,void 0===affectedBoundary.x2New?affectedBoundary.x2>boundary.x1?affectedBoundary.index>boundary.index&&(affectedBoundary.x2New=affectedBoundary.x2):affectedBoundary.x2New=maxXNew:affectedBoundary.x2New>maxXNew&&(affectedBoundary.x2New=Math.max(maxXNew,affectedBoundary.x2));const changedHorizon=[];let lastBoundary=null;for(q=i;q<=j;q++){horizonPart=horizon[q],affectedBoundary=horizonPart.boundary;const useBoundary=affectedBoundary.x2>boundary.x2?affectedBoundary:boundary;lastBoundary===useBoundary?changedHorizon.at(-1).end=horizonPart.end:(changedHorizon.push({start:horizonPart.start,end:horizonPart.end,boundary:useBoundary}),lastBoundary=useBoundary)}for(horizon[i].start<boundary.y1&&(changedHorizon[0].start=boundary.y1,changedHorizon.unshift({start:horizon[i].start,end:boundary.y1,boundary:horizon[i].boundary})),boundary.y2<horizon[j].end&&(changedHorizon.at(-1).end=boundary.y2,changedHorizon.push({start:boundary.y2,end:horizon[j].end,boundary:horizon[j].boundary})),q=i;q<=j;q++){if(horizonPart=horizon[q],affectedBoundary=horizonPart.boundary,void 0!==affectedBoundary.x2New)continue;let used=!1;for(k=i-1;!used&&k>=0&&horizon[k].start>=affectedBoundary.y1;k--)used=horizon[k].boundary===affectedBoundary;for(k=j+1;!used&&k<horizon.length&&horizon[k].end<=affectedBoundary.y2;k++)used=horizon[k].boundary===affectedBoundary;for(k=0;!used&&k<changedHorizon.length;k++)used=changedHorizon[k].boundary===affectedBoundary;used||(affectedBoundary.x2New=maxXNew)}Array.prototype.splice.apply(horizon,[i,j-i+1,...changedHorizon])}for(const horizonPart of horizon){const affectedBoundary=horizonPart.boundary;void 0===affectedBoundary.x2New&&(affectedBoundary.x2New=Math.max(width,affectedBoundary.x2))}}class TextLayerRenderTask{constructor({textContent,textContentStream,container,viewport,textDivs,textContentItemsStr,enhanceTextSelection}){enhanceTextSelection&&(0,_display_utils2.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=textContent,this._textContentStream=textContentStream,this._container=container,this._document=container.ownerDocument,this._viewport=viewport,this._textDivs=textDivs||[],this._textContentItemsStr=textContentItemsStr||[],this._enhanceTextSelection=!!enhanceTextSelection,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,_util2.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new _util2.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(items,styleCache){for(let i=0,len=items.length;i<len;i++)if(void 0!==items[i].str)this._textContentItemsStr.push(items[i].str),appendText(this,items[i],styleCache,this._layoutTextCtx);else if("beginMarkedContentProps"===items[i].type||"beginMarkedContent"===items[i].type){const parent=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==items[i].id&&this._container.setAttribute("id",`${items[i].id}`),parent.append(this._container)}else"endMarkedContent"===items[i].type&&(this._container=this._container.parentNode)}_layoutText(textDiv){const textDivProperties=this._textDivProperties.get(textDiv);let transform="";if(0!==textDivProperties.canvasWidth&&textDivProperties.hasText){const{fontFamily}=textDiv.style,{fontSize}=textDivProperties;(fontSize!==this._layoutTextLastFontSize||fontFamily!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${fontSize*this._devicePixelRatio}px ${fontFamily}`,this._layoutTextLastFontSize=fontSize,this._layoutTextLastFontFamily=fontFamily);const{width}=this._layoutTextCtx.measureText(textDiv.textContent);if(width>0){const scale=this._devicePixelRatio*textDivProperties.canvasWidth/width;this._enhanceTextSelection&&(textDivProperties.scale=scale),transform=`scaleX(${scale})`}}if(0!==textDivProperties.angle&&(transform=`rotate(${textDivProperties.angle}deg) ${transform}`),transform.length>0&&(this._enhanceTextSelection&&(textDivProperties.originalTransform=transform),textDiv.style.transform=transform),textDivProperties.hasText&&this._container.append(textDiv),textDivProperties.hasEOL){const br=document.createElement("br");br.setAttribute("role","presentation"),this._container.append(br)}}_render(timeout=0){const capability=(0,_util2.createPromiseCapability)();let styleCache=Object.create(null);const canvas=this._document.createElement("canvas");if(canvas.height=canvas.width=30,this._layoutTextCtx=canvas.getContext("2d",{alpha:!1}),this._textContent)this._processItems(this._textContent.items,this._textContent.styles),capability.resolve();else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const pump=()=>{this._reader.read().then(({value,done})=>{done?capability.resolve():(Object.assign(styleCache,value.styles),this._processItems(value.items,styleCache),pump())},capability.reject)};this._reader=this._textContentStream.getReader(),pump()}}capability.promise.then(()=>{styleCache=null,timeout?this._renderTimer=setTimeout(()=>{render(this),this._renderTimer=null},timeout):render(this)},this._capability.reject)}expandTextDivs(expandDivs=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(function expand(task){const bounds=task._bounds,viewport=task._viewport,expanded=function expandBounds(width,height,boxes){const bounds=boxes.map(function(box,i){return{x1:box.left,y1:box.top,x2:box.right,y2:box.bottom,index:i,x1New:void 0,x2New:void 0}});expandBoundsLTR(width,bounds);const expanded=new Array(boxes.length);for(const b of bounds)expanded[b.index]={left:b.x1New,top:0,right:b.x2New,bottom:0};boxes.map(function(box,i){const e=expanded[i],b=bounds[i];b.x1=box.top,b.y1=width-e.right,b.x2=box.bottom,b.y2=width-e.left,b.index=i,b.x1New=void 0,b.x2New=void 0}),expandBoundsLTR(height,bounds);for(const b of bounds){const i=b.index;expanded[i].top=b.x1New,expanded[i].bottom=b.x2New}return expanded}(viewport.width,viewport.height,bounds);for(let i=0;i<expanded.length;i++){const div=bounds[i].div,divProperties=task._textDivProperties.get(div);if(0===divProperties.angle){divProperties.paddingLeft=bounds[i].left-expanded[i].left,divProperties.paddingTop=bounds[i].top-expanded[i].top,divProperties.paddingRight=expanded[i].right-bounds[i].right,divProperties.paddingBottom=expanded[i].bottom-bounds[i].bottom,task._textDivProperties.set(div,divProperties);continue}const e=expanded[i],b=bounds[i],m=b.m,c=m[0],s=m[1],points=[[0,0],[0,b.size[1]],[b.size[0],0],b.size],ts=new Float64Array(64);for(let j=0,jj=points.length;j<jj;j++){const t=_util2.Util.applyTransform(points[j],m);ts[j+0]=c&&(e.left-t[0])/c,ts[j+4]=s&&(e.top-t[1])/s,ts[j+8]=c&&(e.right-t[0])/c,ts[j+12]=s&&(e.bottom-t[1])/s,ts[j+16]=s&&(e.left-t[0])/-s,ts[j+20]=c&&(e.top-t[1])/c,ts[j+24]=s&&(e.right-t[0])/-s,ts[j+28]=c&&(e.bottom-t[1])/c,ts[j+32]=c&&(e.left-t[0])/-c,ts[j+36]=s&&(e.top-t[1])/-s,ts[j+40]=c&&(e.right-t[0])/-c,ts[j+44]=s&&(e.bottom-t[1])/-s,ts[j+48]=s&&(e.left-t[0])/s,ts[j+52]=c&&(e.top-t[1])/-c,ts[j+56]=s&&(e.right-t[0])/s,ts[j+60]=c&&(e.bottom-t[1])/-c}const boxScale=1+Math.min(Math.abs(c),Math.abs(s));divProperties.paddingLeft=findPositiveMin(ts,32,16)/boxScale,divProperties.paddingTop=findPositiveMin(ts,48,16)/boxScale,divProperties.paddingRight=findPositiveMin(ts,0,16)/boxScale,divProperties.paddingBottom=findPositiveMin(ts,16,16)/boxScale,task._textDivProperties.set(div,divProperties)}}(this),this._bounds=null);const transformBuf=[],paddingBuf=[];for(let i=0,ii=this._textDivs.length;i<ii;i++){const div=this._textDivs[i],divProps=this._textDivProperties.get(div);divProps.hasText&&(expandDivs?(transformBuf.length=0,paddingBuf.length=0,divProps.originalTransform&&transformBuf.push(divProps.originalTransform),divProps.paddingTop>0?(paddingBuf.push(`${divProps.paddingTop}px`),transformBuf.push(`translateY(${-divProps.paddingTop}px)`)):paddingBuf.push(0),paddingBuf.push(divProps.paddingRight>0?divProps.paddingRight/divProps.scale+"px":0),paddingBuf.push(divProps.paddingBottom>0?`${divProps.paddingBottom}px`:0),divProps.paddingLeft>0?(paddingBuf.push(divProps.paddingLeft/divProps.scale+"px"),transformBuf.push(`translateX(${-divProps.paddingLeft/divProps.scale}px)`)):paddingBuf.push(0),div.style.padding=paddingBuf.join(" "),transformBuf.length&&(div.style.transform=transformBuf.join(" "))):(div.style.padding=null,div.style.transform=divProps.originalTransform))}}}exports2.TextLayerRenderTask=TextLayerRenderTask},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.SVGGraphics=void 0;var _display_utils2=__w_pdfjs_require__2(8),_util2=__w_pdfjs_require__2(1),_is_node2=__w_pdfjs_require__2(3);let SVGGraphics=class{constructor(){(0,_util2.unreachable)("Not implemented: SVGGraphics")}};exports2.SVGGraphics=SVGGraphics;{let opListToTree=function(opList){let opTree=[];const tmp=[];for(const opListElement of opList)"save"!==opListElement.fn?"restore"===opListElement.fn?opTree=tmp.pop():opTree.push(opListElement):(opTree.push({fnId:92,fn:"group",items:[]}),tmp.push(opTree),opTree=opTree.at(-1).items);return opTree},pf=function(value){if(Number.isInteger(value))return value.toString();const s=value.toFixed(10);let i=s.length-1;if("0"!==s[i])return s;do{i--}while("0"===s[i]);return s.substring(0,"."===s[i]?i:i+1)},pm=function(m){if(0===m[4]&&0===m[5]){if(0===m[1]&&0===m[2])return 1===m[0]&&1===m[3]?"":`scale(${pf(m[0])} ${pf(m[3])})`;if(m[0]===m[3]&&m[1]===-m[2]){const a=180*Math.acos(m[0])/Math.PI;return`rotate(${pf(a)})`}}else if(1===m[0]&&0===m[1]&&0===m[2]&&1===m[3])return`translate(${pf(m[4])} ${pf(m[5])})`;return`matrix(${pf(m[0])} ${pf(m[1])} ${pf(m[2])} ${pf(m[3])} ${pf(m[4])} ${pf(m[5])})`};const SVG_DEFAULTS={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},XML_NS="http://www.w3.org/XML/1998/namespace",XLINK_NS="http://www.w3.org/1999/xlink",LINE_CAP_STYLES=["butt","round","square"],LINE_JOIN_STYLES=["miter","round","bevel"],createObjectURL=function(data,contentType="",forceDataSchema=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!forceDataSchema)return URL.createObjectURL(new Blob([data],{type:contentType}));const digits="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let buffer=`data:${contentType};base64,`;for(let i=0,ii=data.length;i<ii;i+=3){const b1=255&data[i],b2=255&data[i+1],b3=255&data[i+2];buffer+=digits[b1>>2]+digits[(3&b1)<<4|b2>>4]+digits[i+1<ii?(15&b2)<<2|b3>>6:64]+digits[i+2<ii?63&b3:64]}return buffer},convertImgDataToPng=function(){const PNG_HEADER=new Uint8Array([137,80,78,71,13,10,26,10]),crcTable=new Int32Array(256);for(let i=0;i<256;i++){let c=i;for(let h=0;h<8;h++)c=1&c?3988292384^c>>1&2147483647:c>>1&2147483647;crcTable[i]=c}function writePngChunk(type,body,data,offset){let p=offset;const len=body.length;data[p]=len>>24&255,data[p+1]=len>>16&255,data[p+2]=len>>8&255,data[p+3]=255&len,p+=4,data[p]=255&type.charCodeAt(0),data[p+1]=255&type.charCodeAt(1),data[p+2]=255&type.charCodeAt(2),data[p+3]=255&type.charCodeAt(3),p+=4,data.set(body,p),p+=body.length;const crc=function crc32(data,start,end){let crc=-1;for(let i=start;i<end;i++)crc=crc>>>8^crcTable[255&(crc^data[i])];return-1^crc}(data,offset+4,p);data[p]=crc>>24&255,data[p+1]=crc>>16&255,data[p+2]=crc>>8&255,data[p+3]=255&crc}function deflateSyncUncompressed(literals){let len=literals.length;const deflateBlocks=Math.ceil(len/65535),idat=new Uint8Array(2+len+5*deflateBlocks+4);let pi=0;idat[pi++]=120,idat[pi++]=156;let pos=0;for(;len>65535;)idat[pi++]=0,idat[pi++]=255,idat[pi++]=255,idat[pi++]=0,idat[pi++]=0,idat.set(literals.subarray(pos,pos+65535),pi),pi+=65535,pos+=65535,len-=65535;idat[pi++]=1,idat[pi++]=255&len,idat[pi++]=len>>8&255,idat[pi++]=255&~len,idat[pi++]=(65535&~len)>>8&255,idat.set(literals.subarray(pos),pi),pi+=literals.length-pos;const adler=function adler32(data,start,end){let a=1,b=0;for(let i=start;i<end;++i)a=(a+(255&data[i]))%65521,b=(b+a)%65521;return b<<16|a}(literals,0,literals.length);return idat[pi++]=adler>>24&255,idat[pi++]=adler>>16&255,idat[pi++]=adler>>8&255,idat[pi++]=255&adler,idat}return function(imgData,forceDataSchema,isMask){return function encode(imgData,kind,forceDataSchema,isMask){const width=imgData.width,height=imgData.height;let bitDepth,colorType,lineSize;const bytes=imgData.data;switch(kind){case _util2.ImageKind.GRAYSCALE_1BPP:colorType=0,bitDepth=1,lineSize=width+7>>3;break;case _util2.ImageKind.RGB_24BPP:colorType=2,bitDepth=8,lineSize=3*width;break;case _util2.ImageKind.RGBA_32BPP:colorType=6,bitDepth=8,lineSize=4*width;break;default:throw new Error("invalid format")}const literals=new Uint8Array((1+lineSize)*height);let offsetLiterals=0,offsetBytes=0;for(let y=0;y<height;++y)literals[offsetLiterals++]=0,literals.set(bytes.subarray(offsetBytes,offsetBytes+lineSize),offsetLiterals),offsetBytes+=lineSize,offsetLiterals+=lineSize;if(kind===_util2.ImageKind.GRAYSCALE_1BPP&&isMask){offsetLiterals=0;for(let y=0;y<height;y++){offsetLiterals++;for(let i=0;i<lineSize;i++)literals[offsetLiterals++]^=255}}const ihdr=new Uint8Array([width>>24&255,width>>16&255,width>>8&255,255&width,height>>24&255,height>>16&255,height>>8&255,255&height,bitDepth,colorType,0,0,0]),idat=function deflateSync(literals){if(!_is_node2.isNodeJS)return deflateSyncUncompressed(literals);try{let input;input=parseInt(process.versions.node)>=8?literals:Buffer.from(literals);const output=__webpack_require__(9796).deflateSync(input,{level:9});return output instanceof Uint8Array?output:new Uint8Array(output)}catch(e){(0,_util2.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return deflateSyncUncompressed(literals)}(literals),data=new Uint8Array(PNG_HEADER.length+36+ihdr.length+idat.length);let offset=0;return data.set(PNG_HEADER,offset),offset+=PNG_HEADER.length,writePngChunk("IHDR",ihdr,data,offset),offset+=12+ihdr.length,writePngChunk("IDATA",idat,data,offset),offset+=12+idat.length,writePngChunk("IEND",new Uint8Array(0),data,offset),createObjectURL(data,"image/png",forceDataSchema)}(imgData,void 0===imgData.kind?_util2.ImageKind.GRAYSCALE_1BPP:imgData.kind,forceDataSchema,isMask)}}();class SVGExtraState{constructor(){this.fontSizeScale=1,this.fontWeight=SVG_DEFAULTS.fontWeight,this.fontSize=0,this.textMatrix=_util2.IDENTITY_MATRIX,this.fontMatrix=_util2.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_util2.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=SVG_DEFAULTS.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(x,y){this.x=x,this.y=y}}let clipCount=0,maskCount=0,shadingCount=0;exports2.SVGGraphics=SVGGraphics=class{constructor(commonObjs,objs,forceDataSchema=!1){(0,_display_utils2.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new _display_utils2.DOMSVGFactory,this.current=new SVGExtraState,this.transformMatrix=_util2.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=commonObjs,this.objs=objs,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!forceDataSchema,this._operatorIdMapping=[];for(const op in _util2.OPS)this._operatorIdMapping[_util2.OPS[op]]=op}save(){this.transformStack.push(this.transformMatrix);const old=this.current;this.extraStack.push(old),this.current=old.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(items){this.save(),this.executeOpTree(items),this.restore()}loadDependencies(operatorList){const fnArray=operatorList.fnArray,argsArray=operatorList.argsArray;for(let i=0,ii=fnArray.length;i<ii;i++)if(fnArray[i]===_util2.OPS.dependency)for(const obj of argsArray[i]){const objsPool=obj.startsWith("g_")?this.commonObjs:this.objs,promise=new Promise(resolve=>{objsPool.get(obj,resolve)});this.current.dependencies.push(promise)}return Promise.all(this.current.dependencies)}transform(a,b,c,d,e,f){this.transformMatrix=_util2.Util.transform(this.transformMatrix,[a,b,c,d,e,f]),this.tgrp=null}getSVG(operatorList,viewport){this.viewport=viewport;const svgElement=this._initialize(viewport);return this.loadDependencies(operatorList).then(()=>(this.transformMatrix=_util2.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(operatorList)),svgElement))}convertOpList(operatorList){const operatorIdMapping=this._operatorIdMapping,argsArray=operatorList.argsArray,fnArray=operatorList.fnArray,opList=[];for(let i=0,ii=fnArray.length;i<ii;i++){const fnId=fnArray[i];opList.push({fnId,fn:operatorIdMapping[fnId],args:argsArray[i]})}return opListToTree(opList)}executeOpTree(opTree){for(const opTreeElement of opTree){const fn=opTreeElement.fn,args=opTreeElement.args;switch(0|opTreeElement.fnId){case _util2.OPS.beginText:this.beginText();break;case _util2.OPS.dependency:break;case _util2.OPS.setLeading:this.setLeading(args);break;case _util2.OPS.setLeadingMoveText:this.setLeadingMoveText(args[0],args[1]);break;case _util2.OPS.setFont:this.setFont(args);break;case _util2.OPS.showText:case _util2.OPS.showSpacedText:this.showText(args[0]);break;case _util2.OPS.endText:this.endText();break;case _util2.OPS.moveText:this.moveText(args[0],args[1]);break;case _util2.OPS.setCharSpacing:this.setCharSpacing(args[0]);break;case _util2.OPS.setWordSpacing:this.setWordSpacing(args[0]);break;case _util2.OPS.setHScale:this.setHScale(args[0]);break;case _util2.OPS.setTextMatrix:this.setTextMatrix(args[0],args[1],args[2],args[3],args[4],args[5]);break;case _util2.OPS.setTextRise:this.setTextRise(args[0]);break;case _util2.OPS.setTextRenderingMode:this.setTextRenderingMode(args[0]);break;case _util2.OPS.setLineWidth:this.setLineWidth(args[0]);break;case _util2.OPS.setLineJoin:this.setLineJoin(args[0]);break;case _util2.OPS.setLineCap:this.setLineCap(args[0]);break;case _util2.OPS.setMiterLimit:this.setMiterLimit(args[0]);break;case _util2.OPS.setFillRGBColor:this.setFillRGBColor(args[0],args[1],args[2]);break;case _util2.OPS.setStrokeRGBColor:this.setStrokeRGBColor(args[0],args[1],args[2]);break;case _util2.OPS.setStrokeColorN:this.setStrokeColorN(args);break;case _util2.OPS.setFillColorN:this.setFillColorN(args);break;case _util2.OPS.shadingFill:this.shadingFill(args[0]);break;case _util2.OPS.setDash:this.setDash(args[0],args[1]);break;case _util2.OPS.setRenderingIntent:this.setRenderingIntent(args[0]);break;case _util2.OPS.setFlatness:this.setFlatness(args[0]);break;case _util2.OPS.setGState:this.setGState(args[0]);break;case _util2.OPS.fill:this.fill();break;case _util2.OPS.eoFill:this.eoFill();break;case _util2.OPS.stroke:this.stroke();break;case _util2.OPS.fillStroke:this.fillStroke();break;case _util2.OPS.eoFillStroke:this.eoFillStroke();break;case _util2.OPS.clip:this.clip("nonzero");break;case _util2.OPS.eoClip:this.clip("evenodd");break;case _util2.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _util2.OPS.paintImageXObject:this.paintImageXObject(args[0]);break;case _util2.OPS.paintInlineImageXObject:this.paintInlineImageXObject(args[0]);break;case _util2.OPS.paintImageMaskXObject:this.paintImageMaskXObject(args[0]);break;case _util2.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(args[0],args[1]);break;case _util2.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _util2.OPS.closePath:this.closePath();break;case _util2.OPS.closeStroke:this.closeStroke();break;case _util2.OPS.closeFillStroke:this.closeFillStroke();break;case _util2.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _util2.OPS.nextLine:this.nextLine();break;case _util2.OPS.transform:this.transform(args[0],args[1],args[2],args[3],args[4],args[5]);break;case _util2.OPS.constructPath:this.constructPath(args[0],args[1]);break;case _util2.OPS.endPath:this.endPath();break;case 92:this.group(opTreeElement.items);break;default:(0,_util2.warn)(`Unimplemented operator ${fn}`)}}}setWordSpacing(wordSpacing){this.current.wordSpacing=wordSpacing}setCharSpacing(charSpacing){this.current.charSpacing=charSpacing}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(a,b,c,d,e,f){const current=this.current;current.textMatrix=current.lineMatrix=[a,b,c,d,e,f],current.textMatrixScale=Math.hypot(a,b),current.x=current.lineX=0,current.y=current.lineY=0,current.xcoords=[],current.ycoords=[],current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size",`${pf(current.fontSize)}px`),current.tspan.setAttributeNS(null,"y",pf(-current.y)),current.txtElement=this.svgFactory.createElement("svg:text"),current.txtElement.append(current.tspan)}beginText(){const current=this.current;current.x=current.lineX=0,current.y=current.lineY=0,current.textMatrix=_util2.IDENTITY_MATRIX,current.lineMatrix=_util2.IDENTITY_MATRIX,current.textMatrixScale=1,current.tspan=this.svgFactory.createElement("svg:tspan"),current.txtElement=this.svgFactory.createElement("svg:text"),current.txtgrp=this.svgFactory.createElement("svg:g"),current.xcoords=[],current.ycoords=[]}moveText(x,y){const current=this.current;current.x=current.lineX+=x,current.y=current.lineY+=y,current.xcoords=[],current.ycoords=[],current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size",`${pf(current.fontSize)}px`),current.tspan.setAttributeNS(null,"y",pf(-current.y))}showText(glyphs){const current=this.current,font=current.font,fontSize=current.fontSize;if(0===fontSize)return;const fontSizeScale=current.fontSizeScale,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,fontDirection=current.fontDirection,textHScale=current.textHScale*fontDirection,vertical=font.vertical,spacingDir=vertical?1:-1,defaultVMetrics=font.defaultVMetrics,widthAdvanceScale=fontSize*current.fontMatrix[0];let x=0;for(const glyph of glyphs){if(null===glyph){x+=fontDirection*wordSpacing;continue}if("number"==typeof glyph){x+=spacingDir*glyph*fontSize/1e3;continue}const spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,character=glyph.fontChar;let scaledX,scaledY,charWidth,width=glyph.width;if(vertical){let vx;const vmetric=glyph.vmetric||defaultVMetrics;vx=glyph.vmetric?vmetric[1]:.5*width,vx=-vx*widthAdvanceScale,width=vmetric?-vmetric[0]:width,scaledX=vx/fontSizeScale,scaledY=(x+vmetric[2]*widthAdvanceScale)/fontSizeScale}else scaledX=x/fontSizeScale,scaledY=0;(glyph.isInFont||font.missingFile)&&(current.xcoords.push(current.x+scaledX),vertical&&current.ycoords.push(-current.y+scaledY),current.tspan.textContent+=character),charWidth=vertical?width*widthAdvanceScale-spacing*fontDirection:width*widthAdvanceScale+spacing*fontDirection,x+=charWidth}current.tspan.setAttributeNS(null,"x",current.xcoords.map(pf).join(" ")),current.tspan.setAttributeNS(null,"y",vertical?current.ycoords.map(pf).join(" "):pf(-current.y)),vertical?current.y-=x:current.x+=x*textHScale,current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size",`${pf(current.fontSize)}px`),current.fontStyle!==SVG_DEFAULTS.fontStyle&&current.tspan.setAttributeNS(null,"font-style",current.fontStyle),current.fontWeight!==SVG_DEFAULTS.fontWeight&&current.tspan.setAttributeNS(null,"font-weight",current.fontWeight);const fillStrokeMode=current.textRenderingMode&_util2.TextRenderingMode.FILL_STROKE_MASK;fillStrokeMode===_util2.TextRenderingMode.FILL||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE?(current.fillColor!==SVG_DEFAULTS.fillColor&&current.tspan.setAttributeNS(null,"fill",current.fillColor),current.fillAlpha<1&&current.tspan.setAttributeNS(null,"fill-opacity",current.fillAlpha)):current.tspan.setAttributeNS(null,"fill",current.textRenderingMode===_util2.TextRenderingMode.ADD_TO_PATH?"transparent":"none"),(fillStrokeMode===_util2.TextRenderingMode.STROKE||fillStrokeMode===_util2.TextRenderingMode.FILL_STROKE)&&this._setStrokeAttributes(current.tspan,1/(current.textMatrixScale||1));let textMatrix=current.textMatrix;0!==current.textRise&&(textMatrix=textMatrix.slice(),textMatrix[5]+=current.textRise),current.txtElement.setAttributeNS(null,"transform",`${pm(textMatrix)} scale(${pf(textHScale)}, -1)`),current.txtElement.setAttributeNS(XML_NS,"xml:space","preserve"),current.txtElement.append(current.tspan),current.txtgrp.append(current.txtElement),this._ensureTransformGroup().append(current.txtElement)}setLeadingMoveText(x,y){this.setLeading(-y),this.moveText(x,y)}addFontStyle(fontObj){if(!fontObj.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const url=createObjectURL(fontObj.data,fontObj.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${fontObj.loadedName}"; src: url(${url}); }\n`}setFont(details){const current=this.current,fontObj=this.commonObjs.get(details[0]);let size=details[1];current.font=fontObj,this.embedFonts&&!fontObj.missingFile&&!this.embeddedFonts[fontObj.loadedName]&&(this.addFontStyle(fontObj),this.embeddedFonts[fontObj.loadedName]=fontObj),current.fontMatrix=fontObj.fontMatrix||_util2.FONT_IDENTITY_MATRIX;let bold="normal";fontObj.black?bold="900":fontObj.bold&&(bold="bold");const italic=fontObj.italic?"italic":"normal";size<0?(size=-size,current.fontDirection=-1):current.fontDirection=1,current.fontSize=size,current.fontFamily=fontObj.loadedName,current.fontWeight=bold,current.fontStyle=italic,current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"y",pf(-current.y)),current.xcoords=[],current.ycoords=[]}endText(){const current=this.current;current.textRenderingMode&_util2.TextRenderingMode.ADD_TO_PATH_FLAG&&current.txtElement?.hasChildNodes()&&(current.element=current.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(width){width>0&&(this.current.lineWidth=width)}setLineCap(style){this.current.lineCap=LINE_CAP_STYLES[style]}setLineJoin(style){this.current.lineJoin=LINE_JOIN_STYLES[style]}setMiterLimit(limit){this.current.miterLimit=limit}setStrokeAlpha(strokeAlpha){this.current.strokeAlpha=strokeAlpha}setStrokeRGBColor(r,g,b){this.current.strokeColor=_util2.Util.makeHexColor(r,g,b)}setFillAlpha(fillAlpha){this.current.fillAlpha=fillAlpha}setFillRGBColor(r,g,b){this.current.fillColor=_util2.Util.makeHexColor(r,g,b),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(args){this.current.strokeColor=this._makeColorN_Pattern(args)}setFillColorN(args){this.current.fillColor=this._makeColorN_Pattern(args)}shadingFill(args){const width=this.viewport.width,height=this.viewport.height,inv=_util2.Util.inverseTransform(this.transformMatrix),bl=_util2.Util.applyTransform([0,0],inv),br=_util2.Util.applyTransform([0,height],inv),ul=_util2.Util.applyTransform([width,0],inv),ur=_util2.Util.applyTransform([width,height],inv),x0=Math.min(bl[0],br[0],ul[0],ur[0]),y0=Math.min(bl[1],br[1],ul[1],ur[1]),x1=Math.max(bl[0],br[0],ul[0],ur[0]),y1=Math.max(bl[1],br[1],ul[1],ur[1]),rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x",x0),rect.setAttributeNS(null,"y",y0),rect.setAttributeNS(null,"width",x1-x0),rect.setAttributeNS(null,"height",y1-y0),rect.setAttributeNS(null,"fill",this._makeShadingPattern(args)),this.current.fillAlpha<1&&rect.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(rect)}_makeColorN_Pattern(args){return"TilingPattern"===args[0]?this._makeTilingPattern(args):this._makeShadingPattern(args)}_makeTilingPattern(args){const color=args[1],operatorList=args[2],matrix=args[3]||_util2.IDENTITY_MATRIX,[x0,y0,x1,y1]=args[4],xstep=args[5],ystep=args[6],paintType=args[7],tilingId="shading"+shadingCount++,[tx0,ty0,tx1,ty1]=_util2.Util.normalizeRect([..._util2.Util.applyTransform([x0,y0],matrix),..._util2.Util.applyTransform([x1,y1],matrix)]),[xscale,yscale]=_util2.Util.singularValueDecompose2dScale(matrix),txstep=xstep*xscale,tystep=ystep*yscale,tiling=this.svgFactory.createElement("svg:pattern");tiling.setAttributeNS(null,"id",tilingId),tiling.setAttributeNS(null,"patternUnits","userSpaceOnUse"),tiling.setAttributeNS(null,"width",txstep),tiling.setAttributeNS(null,"height",tystep),tiling.setAttributeNS(null,"x",`${tx0}`),tiling.setAttributeNS(null,"y",`${ty0}`);const svg=this.svg,transformMatrix=this.transformMatrix,fillColor=this.current.fillColor,strokeColor=this.current.strokeColor,bbox=this.svgFactory.create(tx1-tx0,ty1-ty0);if(this.svg=bbox,this.transformMatrix=matrix,2===paintType){const cssColor=_util2.Util.makeHexColor(...color);this.current.fillColor=cssColor,this.current.strokeColor=cssColor}return this.executeOpTree(this.convertOpList(operatorList)),this.svg=svg,this.transformMatrix=transformMatrix,this.current.fillColor=fillColor,this.current.strokeColor=strokeColor,tiling.append(bbox.childNodes[0]),this.defs.append(tiling),`url(#${tilingId})`}_makeShadingPattern(args){switch("string"==typeof args&&(args=this.objs.get(args)),args[0]){case"RadialAxial":const shadingId="shading"+shadingCount++,colorStops=args[3];let gradient;switch(args[1]){case"axial":const point0=args[4],point1=args[5];gradient=this.svgFactory.createElement("svg:linearGradient"),gradient.setAttributeNS(null,"id",shadingId),gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gradient.setAttributeNS(null,"x1",point0[0]),gradient.setAttributeNS(null,"y1",point0[1]),gradient.setAttributeNS(null,"x2",point1[0]),gradient.setAttributeNS(null,"y2",point1[1]);break;case"radial":const focalPoint=args[4],circlePoint=args[5],focalRadius=args[6],circleRadius=args[7];gradient=this.svgFactory.createElement("svg:radialGradient"),gradient.setAttributeNS(null,"id",shadingId),gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gradient.setAttributeNS(null,"cx",circlePoint[0]),gradient.setAttributeNS(null,"cy",circlePoint[1]),gradient.setAttributeNS(null,"r",circleRadius),gradient.setAttributeNS(null,"fx",focalPoint[0]),gradient.setAttributeNS(null,"fy",focalPoint[1]),gradient.setAttributeNS(null,"fr",focalRadius);break;default:throw new Error(`Unknown RadialAxial type: ${args[1]}`)}for(const colorStop of colorStops){const stop=this.svgFactory.createElement("svg:stop");stop.setAttributeNS(null,"offset",colorStop[0]),stop.setAttributeNS(null,"stop-color",colorStop[1]),gradient.append(stop)}return this.defs.append(gradient),`url(#${shadingId})`;case"Mesh":return(0,_util2.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${args[0]}`)}}setDash(dashArray,dashPhase){this.current.dashArray=dashArray,this.current.dashPhase=dashPhase}constructPath(ops,args){const current=this.current;let x=current.x,y=current.y,d=[],j=0;for(const op of ops)switch(0|op){case _util2.OPS.rectangle:x=args[j++],y=args[j++];const xw=x+args[j++],yh=y+args[j++];d.push("M",pf(x),pf(y),"L",pf(xw),pf(y),"L",pf(xw),pf(yh),"L",pf(x),pf(yh),"Z");break;case _util2.OPS.moveTo:x=args[j++],y=args[j++],d.push("M",pf(x),pf(y));break;case _util2.OPS.lineTo:x=args[j++],y=args[j++],d.push("L",pf(x),pf(y));break;case _util2.OPS.curveTo:x=args[j+4],y=args[j+5],d.push("C",pf(args[j]),pf(args[j+1]),pf(args[j+2]),pf(args[j+3]),pf(x),pf(y)),j+=6;break;case _util2.OPS.curveTo2:d.push("C",pf(x),pf(y),pf(args[j]),pf(args[j+1]),pf(args[j+2]),pf(args[j+3])),x=args[j+2],y=args[j+3],j+=4;break;case _util2.OPS.curveTo3:x=args[j+2],y=args[j+3],d.push("C",pf(args[j]),pf(args[j+1]),pf(x),pf(y),pf(x),pf(y)),j+=4;break;case _util2.OPS.closePath:d.push("Z")}d=d.join(" "),current.path&&ops.length>0&&ops[0]!==_util2.OPS.rectangle&&ops[0]!==_util2.OPS.moveTo?d=current.path.getAttributeNS(null,"d")+d:(current.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(current.path)),current.path.setAttributeNS(null,"d",d),current.path.setAttributeNS(null,"fill","none"),current.element=current.path,current.setCurrentPoint(x,y)}endPath(){const current=this.current;if(current.path=null,!this.pendingClip)return;if(!current.element)return void(this.pendingClip=null);const clipId="clippath"+clipCount++,clipPath=this.svgFactory.createElement("svg:clipPath");clipPath.setAttributeNS(null,"id",clipId),clipPath.setAttributeNS(null,"transform",pm(this.transformMatrix));const clipElement=current.element.cloneNode(!0);if(clipElement.setAttributeNS(null,"clip-rule","evenodd"===this.pendingClip?"evenodd":"nonzero"),this.pendingClip=null,clipPath.append(clipElement),this.defs.append(clipPath),current.activeClipUrl){current.clipGroup=null;for(const prev of this.extraStack)prev.clipGroup=null;clipPath.setAttributeNS(null,"clip-path",current.activeClipUrl)}current.activeClipUrl=`url(#${clipId})`,this.tgrp=null}clip(type){this.pendingClip=type}closePath(){const current=this.current;if(current.path){const d=`${current.path.getAttributeNS(null,"d")}Z`;current.path.setAttributeNS(null,"d",d)}}setLeading(leading){this.current.leading=-leading}setTextRise(textRise){this.current.textRise=textRise}setTextRenderingMode(textRenderingMode){this.current.textRenderingMode=textRenderingMode}setHScale(scale){this.current.textHScale=scale/100}setRenderingIntent(intent){}setFlatness(flatness){}setGState(states){for(const[key,value]of states)switch(key){case"LW":this.setLineWidth(value);break;case"LC":this.setLineCap(value);break;case"LJ":this.setLineJoin(value);break;case"ML":this.setMiterLimit(value);break;case"D":this.setDash(value[0],value[1]);break;case"RI":this.setRenderingIntent(value);break;case"FL":this.setFlatness(value);break;case"Font":this.setFont(value);break;case"CA":this.setStrokeAlpha(value);break;case"ca":this.setFillAlpha(value);break;default:(0,_util2.warn)(`Unimplemented graphic state operator ${key}`)}}fill(){const current=this.current;current.element&&(current.element.setAttributeNS(null,"fill",current.fillColor),current.element.setAttributeNS(null,"fill-opacity",current.fillAlpha),this.endPath())}stroke(){const current=this.current;current.element&&(this._setStrokeAttributes(current.element),current.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(element,lineWidthScale=1){const current=this.current;let dashArray=current.dashArray;1!==lineWidthScale&&dashArray.length>0&&(dashArray=dashArray.map(function(value){return lineWidthScale*value})),element.setAttributeNS(null,"stroke",current.strokeColor),element.setAttributeNS(null,"stroke-opacity",current.strokeAlpha),element.setAttributeNS(null,"stroke-miterlimit",pf(current.miterLimit)),element.setAttributeNS(null,"stroke-linecap",current.lineCap),element.setAttributeNS(null,"stroke-linejoin",current.lineJoin),element.setAttributeNS(null,"stroke-width",pf(lineWidthScale*current.lineWidth)+"px"),element.setAttributeNS(null,"stroke-dasharray",dashArray.map(pf).join(" ")),element.setAttributeNS(null,"stroke-dashoffset",pf(lineWidthScale*current.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x","0"),rect.setAttributeNS(null,"y","0"),rect.setAttributeNS(null,"width","1px"),rect.setAttributeNS(null,"height","1px"),rect.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(rect)}paintImageXObject(objId){const imgData=objId.startsWith("g_")?this.commonObjs.get(objId):this.objs.get(objId);imgData?this.paintInlineImageXObject(imgData):(0,_util2.warn)(`Dependent image with object ID ${objId} is not ready yet`)}paintInlineImageXObject(imgData,mask){const width=imgData.width,height=imgData.height,imgSrc=convertImgDataToPng(imgData,this.forceDataSchema,!!mask),cliprect=this.svgFactory.createElement("svg:rect");cliprect.setAttributeNS(null,"x","0"),cliprect.setAttributeNS(null,"y","0"),cliprect.setAttributeNS(null,"width",pf(width)),cliprect.setAttributeNS(null,"height",pf(height)),this.current.element=cliprect,this.clip("nonzero");const imgEl=this.svgFactory.createElement("svg:image");imgEl.setAttributeNS(XLINK_NS,"xlink:href",imgSrc),imgEl.setAttributeNS(null,"x","0"),imgEl.setAttributeNS(null,"y",pf(-height)),imgEl.setAttributeNS(null,"width",pf(width)+"px"),imgEl.setAttributeNS(null,"height",pf(height)+"px"),imgEl.setAttributeNS(null,"transform",`scale(${pf(1/width)} ${pf(-1/height)})`),mask?mask.append(imgEl):this._ensureTransformGroup().append(imgEl)}paintImageMaskXObject(imgData){const current=this.current,width=imgData.width,height=imgData.height,fillColor=current.fillColor;current.maskId="mask"+maskCount++;const mask=this.svgFactory.createElement("svg:mask");mask.setAttributeNS(null,"id",current.maskId);const rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x","0"),rect.setAttributeNS(null,"y","0"),rect.setAttributeNS(null,"width",pf(width)),rect.setAttributeNS(null,"height",pf(height)),rect.setAttributeNS(null,"fill",fillColor),rect.setAttributeNS(null,"mask",`url(#${current.maskId})`),this.defs.append(mask),this._ensureTransformGroup().append(rect),this.paintInlineImageXObject(imgData,mask)}paintFormXObjectBegin(matrix,bbox){if(Array.isArray(matrix)&&6===matrix.length&&this.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),bbox){const width=bbox[2]-bbox[0],height=bbox[3]-bbox[1],cliprect=this.svgFactory.createElement("svg:rect");cliprect.setAttributeNS(null,"x",bbox[0]),cliprect.setAttributeNS(null,"y",bbox[1]),cliprect.setAttributeNS(null,"width",pf(width)),cliprect.setAttributeNS(null,"height",pf(height)),this.current.element=cliprect,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(viewport){const svg=this.svgFactory.create(viewport.width,viewport.height),definitions=this.svgFactory.createElement("svg:defs");svg.append(definitions),this.defs=definitions;const rootGroup=this.svgFactory.createElement("svg:g");return rootGroup.setAttributeNS(null,"transform",pm(viewport.transform)),svg.append(rootGroup),this.svg=rootGroup,svg}_ensureClipGroup(){if(!this.current.clipGroup){const clipGroup=this.svgFactory.createElement("svg:g");clipGroup.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(clipGroup),this.current.clipGroup=clipGroup}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFNodeStream=void 0;var _util2=__w_pdfjs_require__2(1),_network_utils=__w_pdfjs_require__2(33);const fs=__webpack_require__(7147),http=__webpack_require__(3685),https=__webpack_require__(5687),url=__webpack_require__(7310),fileUriRegex=/^file:\/\/\/[a-zA-Z]:\//;exports2.PDFNodeStream=class PDFNodeStream{constructor(source){this.source=source,this.url=function parseUrl(sourceUrl){const parsedUrl=url.parse(sourceUrl);return"file:"===parsedUrl.protocol||parsedUrl.host?parsedUrl:/^[a-z]:[/\\]/i.test(sourceUrl)?url.parse(`file:///${sourceUrl}`):(parsedUrl.host||(parsedUrl.protocol="file:"),parsedUrl)}(source.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&source.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,_util2.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this),this._fullRequestReader}getRangeReader(start,end){if(end<=this._progressiveDataLength)return null;const rangeReader=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,start,end):new PDFNodeStreamRangeReader(this,start,end);return this._rangeRequestReaders.push(rangeReader),rangeReader}cancelAllRequests(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);for(const reader of this._rangeRequestReaders.slice(0))reader.cancel(reason)}};class BaseFullReader{constructor(stream){this._url=stream.url,this._done=!1,this._storedError=null,this.onProgress=null;const source=stream.source;this._contentLength=source.length,this._loaded=0,this._filename=null,this._disableRange=source.disableRange||!1,this._rangeChunkSize=source.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!source.disableStream,this._isRangeSupported=!source.disableRange,this._readableStream=null,this._readCapability=(0,_util2.createPromiseCapability)(),this._headersCapability=(0,_util2.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var _this13=this;return _asyncToGenerator(function*(){if(yield _this13._readCapability.promise,_this13._done)return{value:void 0,done:!0};if(_this13._storedError)throw _this13._storedError;const chunk=_this13._readableStream.read();return null===chunk?(_this13._readCapability=(0,_util2.createPromiseCapability)(),_this13.read()):(_this13._loaded+=chunk.length,_this13.onProgress&&_this13.onProgress({loaded:_this13._loaded,total:_this13._contentLength}),{value:new Uint8Array(chunk).buffer,done:!1})})()}cancel(reason){this._readableStream?this._readableStream.destroy(reason):this._error(reason)}_error(reason){this._storedError=reason,this._readCapability.resolve()}_setReadableStream(readableStream){this._readableStream=readableStream,readableStream.on("readable",()=>{this._readCapability.resolve()}),readableStream.on("end",()=>{readableStream.destroy(),this._done=!0,this._readCapability.resolve()}),readableStream.on("error",reason=>{this._error(reason)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _util2.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class BaseRangeReader{constructor(stream){this._url=stream.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,_util2.createPromiseCapability)(),this._isStreamingSupported=!stream.source.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){var _this14=this;return _asyncToGenerator(function*(){if(yield _this14._readCapability.promise,_this14._done)return{value:void 0,done:!0};if(_this14._storedError)throw _this14._storedError;const chunk=_this14._readableStream.read();return null===chunk?(_this14._readCapability=(0,_util2.createPromiseCapability)(),_this14.read()):(_this14._loaded+=chunk.length,_this14.onProgress&&_this14.onProgress({loaded:_this14._loaded}),{value:new Uint8Array(chunk).buffer,done:!1})})()}cancel(reason){this._readableStream?this._readableStream.destroy(reason):this._error(reason)}_error(reason){this._storedError=reason,this._readCapability.resolve()}_setReadableStream(readableStream){this._readableStream=readableStream,readableStream.on("readable",()=>{this._readCapability.resolve()}),readableStream.on("end",()=>{readableStream.destroy(),this._done=!0,this._readCapability.resolve()}),readableStream.on("error",reason=>{this._error(reason)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function createRequestOptions(parsedUrl,headers){return{protocol:parsedUrl.protocol,auth:parsedUrl.auth,host:parsedUrl.hostname,port:parsedUrl.port,path:parsedUrl.path,method:"GET",headers}}class PDFNodeStreamFullReader extends BaseFullReader{constructor(stream){super(stream);const handleResponse=response=>{if(404===response.statusCode){const error=new _util2.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=error,void this._headersCapability.reject(error)}this._headersCapability.resolve(),this._setReadableStream(response);const getResponseHeader=name=>this._readableStream.headers[name.toLowerCase()],{allowRangeRequests,suggestedLength}=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader,isHttp:stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=allowRangeRequests,this._contentLength=suggestedLength||this._contentLength,this._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader)};this._request=null,this._request="http:"===this._url.protocol?http.request(createRequestOptions(this._url,stream.httpHeaders),handleResponse):https.request(createRequestOptions(this._url,stream.httpHeaders),handleResponse),this._request.on("error",reason=>{this._storedError=reason,this._headersCapability.reject(reason)}),this._request.end()}}class PDFNodeStreamRangeReader extends BaseRangeReader{constructor(stream,start,end){super(stream),this._httpHeaders={};for(const property in stream.httpHeaders){const value=stream.httpHeaders[property];typeof value>"u"||(this._httpHeaders[property]=value)}this._httpHeaders.Range=`bytes=${start}-${end-1}`;const handleResponse=response=>{if(404!==response.statusCode)this._setReadableStream(response);else{const error=new _util2.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=error}};this._request=null,this._request="http:"===this._url.protocol?http.request(createRequestOptions(this._url,this._httpHeaders),handleResponse):https.request(createRequestOptions(this._url,this._httpHeaders),handleResponse),this._request.on("error",reason=>{this._storedError=reason}),this._request.end()}}class PDFNodeStreamFsFullReader extends BaseFullReader{constructor(stream){super(stream);let path=decodeURIComponent(this._url.path);fileUriRegex.test(this._url.href)&&(path=path.replace(/^\//,"")),fs.lstat(path,(error,stat)=>{if(error)return"ENOENT"===error.code&&(error=new _util2.MissingPDFException(`Missing PDF "${path}".`)),this._storedError=error,void this._headersCapability.reject(error);this._contentLength=stat.size,this._setReadableStream(fs.createReadStream(path)),this._headersCapability.resolve()})}}class PDFNodeStreamFsRangeReader extends BaseRangeReader{constructor(stream,start,end){super(stream);let path=decodeURIComponent(this._url.path);fileUriRegex.test(this._url.href)&&(path=path.replace(/^\//,"")),this._setReadableStream(fs.createReadStream(path,{start,end:end-1}))}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.createResponseStatusError=function createResponseStatusError(status,url){return 404===status||0===status&&url.startsWith("file:")?new _util2.MissingPDFException('Missing PDF "'+url+'".'):new _util2.UnexpectedResponseException(`Unexpected server response (${status}) while retrieving PDF "${url}".`,status)},exports2.extractFilenameFromHeader=function extractFilenameFromHeader(getResponseHeader){const contentDisposition=getResponseHeader("Content-Disposition");if(contentDisposition){let filename=(0,_content_disposition.getFilenameFromContentDispositionHeader)(contentDisposition);if(filename.includes("%"))try{filename=decodeURIComponent(filename)}catch{}if((0,_display_utils2.isPdfFile)(filename))return filename}return null},exports2.validateRangeRequestCapabilities=function validateRangeRequestCapabilities({getResponseHeader,isHttp,rangeChunkSize,disableRange}){const returnValues={allowRangeRequests:!1,suggestedLength:void 0},length=parseInt(getResponseHeader("Content-Length"),10);return!Number.isInteger(length)||(returnValues.suggestedLength=length,length<=2*rangeChunkSize)||disableRange||!isHttp||"bytes"!==getResponseHeader("Accept-Ranges")||"identity"!==(getResponseHeader("Content-Encoding")||"identity")||(returnValues.allowRangeRequests=!0),returnValues},exports2.validateResponseStatus=function validateResponseStatus(status){return 200===status||206===status};var _util2=__w_pdfjs_require__2(1),_content_disposition=__w_pdfjs_require__2(34),_display_utils2=__w_pdfjs_require__2(8)},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.getFilenameFromContentDispositionHeader=function getFilenameFromContentDispositionHeader(contentDisposition){let needsEncodingFixup=!0,tmp=toParamRegExp("filename\\*","i").exec(contentDisposition);if(tmp){tmp=tmp[1];let filename=rfc2616unquote(tmp);return filename=unescape(filename),filename=rfc5987decode(filename),filename=rfc2047decode(filename),fixupEncoding(filename)}if(tmp=function rfc2231getparam(contentDispositionStr){const matches=[];let match;const iter=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(match=iter.exec(contentDispositionStr));){let[,n,quot,part]=match;if(n=parseInt(n,10),n in matches){if(0===n)break}else matches[n]=[quot,part]}const parts=[];for(let n=0;n<matches.length&&n in matches;++n){let[quot,part]=matches[n];part=rfc2616unquote(part),quot&&(part=unescape(part),0===n&&(part=rfc5987decode(part))),parts.push(part)}return parts.join("")}(contentDisposition),tmp)return fixupEncoding(rfc2047decode(tmp));if(tmp=toParamRegExp("filename","i").exec(contentDisposition),tmp){tmp=tmp[1];let filename=rfc2616unquote(tmp);return filename=rfc2047decode(filename),fixupEncoding(filename)}function toParamRegExp(attributePattern,flags){return new RegExp("(?:^|;)\\s*"+attributePattern+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',flags)}function textdecode(encoding,value){if(encoding){if(!/^[\x00-\xFF]+$/.test(value))return value;try{const decoder=new TextDecoder(encoding,{fatal:!0}),buffer=(0,_util2.stringToBytes)(value);value=decoder.decode(buffer),needsEncodingFixup=!1}catch{}}return value}function fixupEncoding(value){return needsEncodingFixup&&/[\x80-\xff]/.test(value)&&(value=textdecode("utf-8",value),needsEncodingFixup&&(value=textdecode("iso-8859-1",value))),value}function rfc2616unquote(value){if(value.startsWith('"')){const parts=value.slice(1).split('\\"');for(let i=0;i<parts.length;++i){const quotindex=parts[i].indexOf('"');-1!==quotindex&&(parts[i]=parts[i].slice(0,quotindex),parts.length=i+1),parts[i]=parts[i].replace(/\\(.)/g,"$1")}value=parts.join('"')}return value}function rfc5987decode(extvalue){const encodingend=extvalue.indexOf("'");return-1===encodingend?extvalue:textdecode(extvalue.slice(0,encodingend),extvalue.slice(encodingend+1).replace(/^[^']*'/,""))}function rfc2047decode(value){return!value.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(value)?value:value.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(matches,charset,encoding,text){if("q"===encoding||"Q"===encoding)return textdecode(charset,text=(text=text.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(match,hex){return String.fromCharCode(parseInt(hex,16))}));try{text=atob(text)}catch{}return textdecode(charset,text)})}return""};var _util2=__w_pdfjs_require__2(1)},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFNetworkStream=void 0;var _util2=__w_pdfjs_require__2(1),_network_utils=__w_pdfjs_require__2(33);class NetworkManager{constructor(url,args={}){this.url=url,this.isHttp=/^https?:/i.test(url),this.httpHeaders=this.isHttp&&args.httpHeaders||Object.create(null),this.withCredentials=args.withCredentials||!1,this.getXhr=args.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(begin,end,listeners){const args={begin,end};for(const prop in listeners)args[prop]=listeners[prop];return this.request(args)}requestFull(listeners){return this.request(listeners)}request(args){const xhr=this.getXhr(),xhrId=this.currXhrId++,pendingRequest=this.pendingRequests[xhrId]={xhr};xhr.open("GET",this.url),xhr.withCredentials=this.withCredentials;for(const property in this.httpHeaders){const value=this.httpHeaders[property];typeof value>"u"||xhr.setRequestHeader(property,value)}return this.isHttp&&"begin"in args&&"end"in args?(xhr.setRequestHeader("Range",`bytes=${args.begin}-${args.end-1}`),pendingRequest.expectedStatus=206):pendingRequest.expectedStatus=200,xhr.responseType="arraybuffer",args.onError&&(xhr.onerror=function(evt){args.onError(xhr.status)}),xhr.onreadystatechange=this.onStateChange.bind(this,xhrId),xhr.onprogress=this.onProgress.bind(this,xhrId),pendingRequest.onHeadersReceived=args.onHeadersReceived,pendingRequest.onDone=args.onDone,pendingRequest.onError=args.onError,pendingRequest.onProgress=args.onProgress,xhr.send(null),xhrId}onProgress(xhrId,evt){const pendingRequest=this.pendingRequests[xhrId];pendingRequest&&pendingRequest.onProgress?.(evt)}onStateChange(xhrId,evt){const pendingRequest=this.pendingRequests[xhrId];if(!pendingRequest)return;const xhr=pendingRequest.xhr;if(xhr.readyState>=2&&pendingRequest.onHeadersReceived&&(pendingRequest.onHeadersReceived(),delete pendingRequest.onHeadersReceived),4!==xhr.readyState||!(xhrId in this.pendingRequests))return;if(delete this.pendingRequests[xhrId],0===xhr.status&&this.isHttp)return void pendingRequest.onError?.(xhr.status);const xhrStatus=xhr.status||200;if((200!==xhrStatus||206!==pendingRequest.expectedStatus)&&xhrStatus!==pendingRequest.expectedStatus)return void pendingRequest.onError?.(xhr.status);const chunk=function getArrayBuffer(xhr){const data=xhr.response;return"string"!=typeof data?data:(0,_util2.stringToBytes)(data).buffer}(xhr);if(206===xhrStatus){const rangeHeader=xhr.getResponseHeader("Content-Range"),matches=/bytes (\d+)-(\d+)\/(\d+)/.exec(rangeHeader);pendingRequest.onDone({begin:parseInt(matches[1],10),chunk})}else chunk?pendingRequest.onDone({begin:0,chunk}):pendingRequest.onError?.(xhr.status)}getRequestXhr(xhrId){return this.pendingRequests[xhrId].xhr}isPendingRequest(xhrId){return xhrId in this.pendingRequests}abortRequest(xhrId){const xhr=this.pendingRequests[xhrId].xhr;delete this.pendingRequests[xhrId],xhr.abort()}}exports2.PDFNetworkStream=class PDFNetworkStream{constructor(source){this._source=source,this._manager=new NetworkManager(source.url,{httpHeaders:source.httpHeaders,withCredentials:source.withCredentials}),this._rangeChunkSize=source.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(reader){const i=this._rangeRequestReaders.indexOf(reader);i>=0&&this._rangeRequestReaders.splice(i,1)}getFullReader(){return(0,_util2.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}getRangeReader(begin,end){const reader=new PDFNetworkStreamRangeRequestReader(this._manager,begin,end);return reader.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(reader),reader}cancelAllRequests(reason){this._fullRequestReader?.cancel(reason);for(const reader of this._rangeRequestReaders.slice(0))reader.cancel(reason)}};class PDFNetworkStreamFullRequestReader{constructor(manager,source){this._manager=manager;const args={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=source.url,this._fullRequestId=manager.requestFull(args),this._headersReceivedCapability=(0,_util2.createPromiseCapability)(),this._disableRange=source.disableRange||!1,this._contentLength=source.length,this._rangeChunkSize=source.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const fullRequestXhrId=this._fullRequestId,fullRequestXhr=this._manager.getRequestXhr(fullRequestXhrId),getResponseHeader=name=>fullRequestXhr.getResponseHeader(name),{allowRangeRequests,suggestedLength}=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});allowRangeRequests&&(this._isRangeSupported=!0),this._contentLength=suggestedLength||this._contentLength,this._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader),this._isRangeSupported&&this._manager.abortRequest(fullRequestXhrId),this._headersReceivedCapability.resolve()}_onDone(data){if(data&&(this._requests.length>0?this._requests.shift().resolve({value:data.chunk,done:!1}):this._cachedChunks.push(data.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(status){this._storedError=(0,_network_utils.createResponseStatusError)(status,this._url),this._headersReceivedCapability.reject(this._storedError);for(const requestCapability of this._requests)requestCapability.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(evt){this.onProgress?.({loaded:evt.loaded,total:evt.lengthComputable?evt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){var _this15=this;return _asyncToGenerator(function*(){if(_this15._storedError)throw _this15._storedError;if(_this15._cachedChunks.length>0)return{value:_this15._cachedChunks.shift(),done:!1};if(_this15._done)return{value:void 0,done:!0};const requestCapability=(0,_util2.createPromiseCapability)();return _this15._requests.push(requestCapability),requestCapability.promise})()}cancel(reason){this._done=!0,this._headersReceivedCapability.reject(reason);for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class PDFNetworkStreamRangeRequestReader{constructor(manager,begin,end){this._manager=manager;const args={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=manager.url,this._requestId=manager.requestRange(begin,end,args),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(data){const chunk=data.chunk;this._requests.length>0?this._requests.shift().resolve({value:chunk,done:!1}):this._queuedChunk=chunk,this._done=!0;for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(status){this._storedError=(0,_network_utils.createResponseStatusError)(status,this._url);for(const requestCapability of this._requests)requestCapability.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(evt){this.isStreamingSupported||this.onProgress?.({loaded:evt.loaded})}get isStreamingSupported(){return!1}read(){var _this16=this;return _asyncToGenerator(function*(){if(_this16._storedError)throw _this16._storedError;if(null!==_this16._queuedChunk){const chunk=_this16._queuedChunk;return _this16._queuedChunk=null,{value:chunk,done:!1}}if(_this16._done)return{value:void 0,done:!0};const requestCapability=(0,_util2.createPromiseCapability)();return _this16._requests.push(requestCapability),requestCapability.promise})()}cancel(reason){this._done=!0;for(const requestCapability of this._requests)requestCapability.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFFetchStream=void 0;var _util2=__w_pdfjs_require__2(1),_network_utils=__w_pdfjs_require__2(33);function createFetchOptions(headers,withCredentials,abortController){return{method:"GET",headers,signal:abortController.signal,mode:"cors",credentials:withCredentials?"include":"same-origin",redirect:"follow"}}function createHeaders(httpHeaders){const headers=new Headers;for(const property in httpHeaders){const value=httpHeaders[property];typeof value>"u"||headers.append(property,value)}return headers}exports2.PDFFetchStream=class PDFFetchStream{constructor(source){this.source=source,this.isHttp=/^https?:/i.test(source.url),this.httpHeaders=this.isHttp&&source.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,_util2.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}getRangeReader(begin,end){if(end<=this._progressiveDataLength)return null;const reader=new PDFFetchStreamRangeReader(this,begin,end);return this._rangeRequestReaders.push(reader),reader}cancelAllRequests(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);for(const reader of this._rangeRequestReaders.slice(0))reader.cancel(reason)}};class PDFFetchStreamReader{constructor(stream){this._stream=stream,this._reader=null,this._loaded=0,this._filename=null;const source=stream.source;this._withCredentials=source.withCredentials||!1,this._contentLength=source.length,this._headersCapability=(0,_util2.createPromiseCapability)(),this._disableRange=source.disableRange||!1,this._rangeChunkSize=source.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!source.disableStream,this._isRangeSupported=!source.disableRange,this._headers=createHeaders(this._stream.httpHeaders);const url=source.url;fetch(url,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then(response=>{if(!(0,_network_utils.validateResponseStatus)(response.status))throw(0,_network_utils.createResponseStatusError)(response.status,url);this._reader=response.body.getReader(),this._headersCapability.resolve();const getResponseHeader=name=>response.headers.get(name),{allowRangeRequests,suggestedLength}=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=allowRangeRequests,this._contentLength=suggestedLength||this._contentLength,this._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new _util2.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var _this17=this;return _asyncToGenerator(function*(){yield _this17._headersCapability.promise;const{value,done}=yield _this17._reader.read();return done?{value,done}:(_this17._loaded+=value.byteLength,_this17.onProgress&&_this17.onProgress({loaded:_this17._loaded,total:_this17._contentLength}),{value:new Uint8Array(value).buffer,done:!1})})()}cancel(reason){this._reader&&this._reader.cancel(reason),this._abortController.abort()}}class PDFFetchStreamRangeReader{constructor(stream,begin,end){this._stream=stream,this._reader=null,this._loaded=0;const source=stream.source;this._withCredentials=source.withCredentials||!1,this._readCapability=(0,_util2.createPromiseCapability)(),this._isStreamingSupported=!source.disableStream,this._abortController=new AbortController,this._headers=createHeaders(this._stream.httpHeaders),this._headers.append("Range",`bytes=${begin}-${end-1}`);const url=source.url;fetch(url,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then(response=>{if(!(0,_network_utils.validateResponseStatus)(response.status))throw(0,_network_utils.createResponseStatusError)(response.status,url);this._readCapability.resolve(),this._reader=response.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){var _this18=this;return _asyncToGenerator(function*(){yield _this18._readCapability.promise;const{value,done}=yield _this18._reader.read();return done?{value,done}:(_this18._loaded+=value.byteLength,_this18.onProgress&&_this18.onProgress({loaded:_this18._loaded}),{value:new Uint8Array(value).buffer,done:!1})})()}cancel(reason){this._reader&&this._reader.cancel(reason),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module2=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module2,module2.exports,__w_pdfjs_require__),module2.exports}var __nested_webpack_exports__={};return(()=>{var exports2=__nested_webpack_exports__;Object.defineProperty(exports2,"__esModule",{value:!0}),Object.defineProperty(exports2,"AnnotationEditorLayer",{enumerable:!0,get:function(){return _annotation_editor_layer.AnnotationEditorLayer}}),Object.defineProperty(exports2,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return _util2.AnnotationEditorParamsType}}),Object.defineProperty(exports2,"AnnotationEditorType",{enumerable:!0,get:function(){return _util2.AnnotationEditorType}}),Object.defineProperty(exports2,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _tools.AnnotationEditorUIManager}}),Object.defineProperty(exports2,"AnnotationLayer",{enumerable:!0,get:function(){return _annotation_layer.AnnotationLayer}}),Object.defineProperty(exports2,"AnnotationMode",{enumerable:!0,get:function(){return _util2.AnnotationMode}}),Object.defineProperty(exports2,"CMapCompressionType",{enumerable:!0,get:function(){return _util2.CMapCompressionType}}),Object.defineProperty(exports2,"GlobalWorkerOptions",{enumerable:!0,get:function(){return _worker_options2.GlobalWorkerOptions}}),Object.defineProperty(exports2,"InvalidPDFException",{enumerable:!0,get:function(){return _util2.InvalidPDFException}}),Object.defineProperty(exports2,"LoopbackPort",{enumerable:!0,get:function(){return _api.LoopbackPort}}),Object.defineProperty(exports2,"MissingPDFException",{enumerable:!0,get:function(){return _util2.MissingPDFException}}),Object.defineProperty(exports2,"OPS",{enumerable:!0,get:function(){return _util2.OPS}}),Object.defineProperty(exports2,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _api.PDFDataRangeTransport}}),Object.defineProperty(exports2,"PDFDateString",{enumerable:!0,get:function(){return _display_utils2.PDFDateString}}),Object.defineProperty(exports2,"PDFWorker",{enumerable:!0,get:function(){return _api.PDFWorker}}),Object.defineProperty(exports2,"PasswordResponses",{enumerable:!0,get:function(){return _util2.PasswordResponses}}),Object.defineProperty(exports2,"PermissionFlag",{enumerable:!0,get:function(){return _util2.PermissionFlag}}),Object.defineProperty(exports2,"PixelsPerInch",{enumerable:!0,get:function(){return _display_utils2.PixelsPerInch}}),Object.defineProperty(exports2,"RenderingCancelledException",{enumerable:!0,get:function(){return _display_utils2.RenderingCancelledException}}),Object.defineProperty(exports2,"SVGGraphics",{enumerable:!0,get:function(){return _svg.SVGGraphics}}),Object.defineProperty(exports2,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return _util2.UNSUPPORTED_FEATURES}}),Object.defineProperty(exports2,"UnexpectedResponseException",{enumerable:!0,get:function(){return _util2.UnexpectedResponseException}}),Object.defineProperty(exports2,"Util",{enumerable:!0,get:function(){return _util2.Util}}),Object.defineProperty(exports2,"VerbosityLevel",{enumerable:!0,get:function(){return _util2.VerbosityLevel}}),Object.defineProperty(exports2,"XfaLayer",{enumerable:!0,get:function(){return _xfa_layer.XfaLayer}}),Object.defineProperty(exports2,"build",{enumerable:!0,get:function(){return _api.build}}),Object.defineProperty(exports2,"createPromiseCapability",{enumerable:!0,get:function(){return _util2.createPromiseCapability}}),Object.defineProperty(exports2,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return _util2.createValidAbsoluteUrl}}),Object.defineProperty(exports2,"getDocument",{enumerable:!0,get:function(){return _api.getDocument}}),Object.defineProperty(exports2,"getFilenameFromUrl",{enumerable:!0,get:function(){return _display_utils2.getFilenameFromUrl}}),Object.defineProperty(exports2,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return _display_utils2.getPdfFilenameFromUrl}}),Object.defineProperty(exports2,"getXfaPageViewport",{enumerable:!0,get:function(){return _display_utils2.getXfaPageViewport}}),Object.defineProperty(exports2,"isPdfFile",{enumerable:!0,get:function(){return _display_utils2.isPdfFile}}),Object.defineProperty(exports2,"loadScript",{enumerable:!0,get:function(){return _display_utils2.loadScript}}),Object.defineProperty(exports2,"renderTextLayer",{enumerable:!0,get:function(){return _text_layer.renderTextLayer}}),Object.defineProperty(exports2,"shadow",{enumerable:!0,get:function(){return _util2.shadow}}),Object.defineProperty(exports2,"version",{enumerable:!0,get:function(){return _api.version}});var _util2=__w_pdfjs_require__(1),_api=__w_pdfjs_require__(4),_display_utils2=__w_pdfjs_require__(8),_annotation_editor_layer=__w_pdfjs_require__(22),_tools=__w_pdfjs_require__(7),_annotation_layer=__w_pdfjs_require__(27),_worker_options2=__w_pdfjs_require__(15),_is_node2=__w_pdfjs_require__(3),_text_layer=__w_pdfjs_require__(30),_svg=__w_pdfjs_require__(31),_xfa_layer=__w_pdfjs_require__(29);if(_is_node2.isNodeJS){const{PDFNodeStream}=__w_pdfjs_require__(32);(0,_api.setPDFNetworkStreamFactory)(params=>new PDFNodeStream(params))}else{const{PDFNetworkStream}=__w_pdfjs_require__(35),{PDFFetchStream}=__w_pdfjs_require__(36);(0,_api.setPDFNetworkStreamFactory)(params=>(0,_display_utils2.isValidFetchUrl)(params.url)?new PDFFetchStream(params):new PDFNetworkStream(params))}})(),__nested_webpack_exports__})(),module.exports=factory()},788:(module2,__unused_webpack_exports2,__webpack_require__2)=>{var _asyncToGenerator2=__webpack_require__2(7156).default;globalThis,module2.exports=(()=>{"use strict";var __webpack_modules__2=[,(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.DefaultXfaLayerFactory=exports2.DefaultTextLayerFactory=exports2.DefaultStructTreeLayerFactory=exports2.DefaultAnnotationLayerFactory=exports2.DefaultAnnotationEditorLayerFactory=void 0;var _annotation_editor_layer_builder=__w_pdfjs_require__3(2),_annotation_layer_builder=__w_pdfjs_require__3(5),_l10n_utils=__w_pdfjs_require__3(4),_pdf_link_service=__w_pdfjs_require__3(6),_struct_tree_layer_builder=__w_pdfjs_require__3(8),_text_layer_builder=__w_pdfjs_require__3(9),_xfa_layer_builder=__w_pdfjs_require__3(10);exports2.DefaultAnnotationLayerFactory=class DefaultAnnotationLayerFactory{createAnnotationLayerBuilder({pageDiv,pdfPage,annotationStorage=null,imageResourcesPath="",renderForms=!0,l10n=_l10n_utils.NullL10n,enableScripting=!1,hasJSActionsPromise=null,mouseState=null,fieldObjectsPromise=null,annotationCanvasMap=null,accessibilityManager=null}){return new _annotation_layer_builder.AnnotationLayerBuilder({pageDiv,pdfPage,imageResourcesPath,renderForms,linkService:new _pdf_link_service.SimpleLinkService,l10n,annotationStorage,enableScripting,hasJSActionsPromise,fieldObjectsPromise,mouseState,annotationCanvasMap,accessibilityManager})}},exports2.DefaultAnnotationEditorLayerFactory=class DefaultAnnotationEditorLayerFactory{createAnnotationEditorLayerBuilder({uiManager=null,pageDiv,pdfPage,accessibilityManager=null,l10n,annotationStorage=null}){return new _annotation_editor_layer_builder.AnnotationEditorLayerBuilder({uiManager,pageDiv,pdfPage,accessibilityManager,l10n,annotationStorage})}},exports2.DefaultStructTreeLayerFactory=class DefaultStructTreeLayerFactory{createStructTreeLayerBuilder({pdfPage}){return new _struct_tree_layer_builder.StructTreeLayerBuilder({pdfPage})}},exports2.DefaultTextLayerFactory=class DefaultTextLayerFactory{createTextLayerBuilder({textLayerDiv,pageIndex,viewport,enhanceTextSelection=!1,eventBus,highlighter,accessibilityManager=null}){return new _text_layer_builder.TextLayerBuilder({textLayerDiv,pageIndex,viewport,enhanceTextSelection,eventBus,highlighter,accessibilityManager})}},exports2.DefaultXfaLayerFactory=class DefaultXfaLayerFactory{createXfaLayerBuilder({pageDiv,pdfPage,annotationStorage=null}){return new _xfa_layer_builder.XfaLayerBuilder({pageDiv,pdfPage,annotationStorage,linkService:new _pdf_link_service.SimpleLinkService})}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.AnnotationEditorLayerBuilder=void 0;var _pdfjsLib=__w_pdfjs_require__3(3),_l10n_utils=__w_pdfjs_require__3(4);exports2.AnnotationEditorLayerBuilder=class AnnotationEditorLayerBuilder{#uiManager;constructor(options){this.pageDiv=options.pageDiv,this.pdfPage=options.pdfPage,this.annotationStorage=options.annotationStorage||null,this.accessibilityManager=options.accessibilityManager,this.l10n=options.l10n||_l10n_utils.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#uiManager=options.uiManager}render(viewport,intent="display"){var _this=this;return _asyncToGenerator2(function*(){if("display"!==intent||_this._cancelled)return;const clonedViewport=viewport.clone({dontFlip:!0});if(_this.div)return _this.annotationEditorLayer.update({viewport:clonedViewport}),void _this.show();_this.div=document.createElement("div"),_this.div.className="annotationEditorLayer",_this.div.tabIndex=0,_this.pageDiv.append(_this.div),_this.annotationEditorLayer=new _pdfjsLib.AnnotationEditorLayer({uiManager:_this.#uiManager,div:_this.div,annotationStorage:_this.annotationStorage,accessibilityManager:_this.accessibilityManager,pageIndex:_this.pdfPage._pageIndex,l10n:_this.l10n,viewport:clonedViewport}),_this.annotationEditorLayer.render({viewport:clonedViewport,div:_this.div,annotations:null,intent})})()}cancel(){this._cancelled=!0,this.destroy()}hide(){this.div&&(this.div.hidden=!0)}show(){this.div&&(this.div.hidden=!1)}destroy(){this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}}},module3=>{let pdfjsLib;pdfjsLib=typeof window<"u"&&window["pdfjs-dist/build/pdf"]?window["pdfjs-dist/build/pdf"]:__webpack_require__2(405),module3.exports=pdfjsLib},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.NullL10n=void 0,exports2.fixupLangCode=function fixupLangCode(langCode){return PARTIAL_LANG_CODES[langCode?.toLowerCase()]||langCode},exports2.getL10nFallback=getL10nFallback;const DEFAULT_L10N_STRINGS={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} \xd7 {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} \xd7 {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",print_progress_percent:"{{progress}}%","toggle_sidebar.title":"Toggle Sidebar","toggle_sidebar_notification2.title":"Toggle Sidebar (document contains outline/attachments/layers)",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",error_version_info:"PDF.js v{{version}} (build: {{build}})",error_message:"Message: {{message}}",error_stack:"Stack: {{stack}}",error_file:"File: {{file}}",error_line:"Line: {{line}}",rendering_error:"An error occurred while rendering the page.",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading:"Loading\u2026",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text_default_content:"Enter text\u2026",editor_free_text_aria_label:"FreeText Editor",editor_ink_aria_label:"Ink Editor",editor_ink_canvas_aria_label:"User-created image"};function getL10nFallback(key,args){switch(key){case"find_match_count":key=`find_match_count[${1===args.total?"one":"other"}]`;break;case"find_match_count_limit":key=`find_match_count_limit[${1===args.limit?"one":"other"}]`}return DEFAULT_L10N_STRINGS[key]||""}const PARTIAL_LANG_CODES={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};exports2.NullL10n={getLanguage:()=>_asyncToGenerator2(function*(){return"en-us"})(),getDirection:()=>_asyncToGenerator2(function*(){return"ltr"})(),get:(key,args=null,fallback=getL10nFallback(key,args))=>_asyncToGenerator2(function*(){return function formatL10nValue(text,args){return args?text.replace(/\{\{\s*(\w+)\s*\}\}/g,(all,name)=>name in args?args[name]:"{{"+name+"}}"):text}(fallback,args)})(),translate:element=>_asyncToGenerator2(function*(){})()}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.AnnotationLayerBuilder=void 0;var _pdfjsLib=__w_pdfjs_require__3(3),_l10n_utils=__w_pdfjs_require__3(4);exports2.AnnotationLayerBuilder=class AnnotationLayerBuilder{constructor({pageDiv,pdfPage,linkService,downloadManager,annotationStorage=null,imageResourcesPath="",renderForms=!0,l10n=_l10n_utils.NullL10n,enableScripting=!1,hasJSActionsPromise=null,fieldObjectsPromise=null,mouseState=null,annotationCanvasMap=null,accessibilityManager=null}){this.pageDiv=pageDiv,this.pdfPage=pdfPage,this.linkService=linkService,this.downloadManager=downloadManager,this.imageResourcesPath=imageResourcesPath,this.renderForms=renderForms,this.l10n=l10n,this.annotationStorage=annotationStorage,this.enableScripting=enableScripting,this._hasJSActionsPromise=hasJSActionsPromise,this._fieldObjectsPromise=fieldObjectsPromise,this._mouseState=mouseState,this._annotationCanvasMap=annotationCanvasMap,this._accessibilityManager=accessibilityManager,this.div=null,this._cancelled=!1}render(viewport,intent="display"){var _this2=this;return _asyncToGenerator2(function*(){const[annotations,hasJSActions=!1,fieldObjects=null]=yield Promise.all([_this2.pdfPage.getAnnotations({intent}),_this2._hasJSActionsPromise,_this2._fieldObjectsPromise]);if(_this2._cancelled||0===annotations.length)return;const parameters={viewport:viewport.clone({dontFlip:!0}),div:_this2.div,annotations,page:_this2.pdfPage,imageResourcesPath:_this2.imageResourcesPath,renderForms:_this2.renderForms,linkService:_this2.linkService,downloadManager:_this2.downloadManager,annotationStorage:_this2.annotationStorage,enableScripting:_this2.enableScripting,hasJSActions,fieldObjects,mouseState:_this2._mouseState,annotationCanvasMap:_this2._annotationCanvasMap,accessibilityManager:_this2._accessibilityManager};_this2.div?_pdfjsLib.AnnotationLayer.update(parameters):(_this2.div=document.createElement("div"),_this2.div.className="annotationLayer",_this2.pageDiv.append(_this2.div),parameters.div=_this2.div,_pdfjsLib.AnnotationLayer.render(parameters),_this2.l10n.translate(_this2.div))})()}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.SimpleLinkService=exports2.PDFLinkService=exports2.LinkTarget=void 0;var _ui_utils=__w_pdfjs_require__3(7);const LinkTarget={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function addLinkAttributes(link,{url,target,rel,enabled=!0}={}){if(!url||"string"!=typeof url)throw new Error('A valid "url" parameter must provided.');const urlNullRemoved=(0,_ui_utils.removeNullCharacters)(url);enabled?link.href=link.title=urlNullRemoved:(link.href="",link.title=`Disabled: ${urlNullRemoved}`,link.onclick=()=>!1);let targetStr="";switch(target){case LinkTarget.NONE:break;case LinkTarget.SELF:targetStr="_self";break;case LinkTarget.BLANK:targetStr="_blank";break;case LinkTarget.PARENT:targetStr="_parent";break;case LinkTarget.TOP:targetStr="_top"}link.target=targetStr,link.rel="string"==typeof rel?rel:"noopener noreferrer nofollow"}exports2.LinkTarget=LinkTarget;class PDFLinkService{#pagesRefCache=new Map;constructor({eventBus,externalLinkTarget=null,externalLinkRel=null,ignoreDestinationZoom=!1}={}){this.eventBus=eventBus,this.externalLinkTarget=externalLinkTarget,this.externalLinkRel=externalLinkRel,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=ignoreDestinationZoom,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(pdfDocument,baseUrl=null){this.baseUrl=baseUrl,this.pdfDocument=pdfDocument,this.#pagesRefCache.clear()}setViewer(pdfViewer){this.pdfViewer=pdfViewer}setHistory(pdfHistory){this.pdfHistory=pdfHistory}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(value){this.pdfViewer.currentPageNumber=value}get rotation(){return this.pdfViewer.pagesRotation}set rotation(value){this.pdfViewer.pagesRotation=value}#goToDestinationHelper(rawDest,namedDest=null,explicitDest){const destRef=explicitDest[0];let pageNumber;if("object"==typeof destRef&&null!==destRef){if(pageNumber=this._cachedPageNumber(destRef),!pageNumber)return void this.pdfDocument.getPageIndex(destRef).then(pageIndex=>{this.cachePageRef(pageIndex+1,destRef),this.#goToDestinationHelper(rawDest,namedDest,explicitDest)}).catch(()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${destRef}" is not a valid page reference, for dest="${rawDest}".`)})}else{if(!Number.isInteger(destRef))return void console.error(`PDFLinkService.#goToDestinationHelper: "${destRef}" is not a valid destination reference, for dest="${rawDest}".`);pageNumber=destRef+1}!pageNumber||pageNumber<1||pageNumber>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${pageNumber}" is not a valid page number, for dest="${rawDest}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest,explicitDest,pageNumber})),this.pdfViewer.scrollPageIntoView({pageNumber,destArray:explicitDest,ignoreDestinationZoom:this._ignoreDestinationZoom}))}goToDestination(dest){var _this3=this;return _asyncToGenerator2(function*(){if(!_this3.pdfDocument)return;let namedDest,explicitDest;"string"==typeof dest?(namedDest=dest,explicitDest=yield _this3.pdfDocument.getDestination(dest)):(namedDest=null,explicitDest=yield dest),Array.isArray(explicitDest)?_this3.#goToDestinationHelper(dest,namedDest,explicitDest):console.error(`PDFLinkService.goToDestination: "${explicitDest}" is not a valid destination array, for dest="${dest}".`)})()}goToPage(val){if(!this.pdfDocument)return;const pageNumber="string"==typeof val&&this.pdfViewer.pageLabelToPageNumber(val)||0|val;Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(pageNumber)),this.pdfViewer.scrollPageIntoView({pageNumber})):console.error(`PDFLinkService.goToPage: "${val}" is not a valid page.`)}addLinkAttributes(link,url,newWindow=!1){addLinkAttributes(link,{url,target:newWindow?LinkTarget.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(dest){if("string"==typeof dest){if(dest.length>0)return this.getAnchorUrl("#"+escape(dest))}else if(Array.isArray(dest)){const str=JSON.stringify(dest);if(str.length>0)return this.getAnchorUrl("#"+escape(str))}return this.getAnchorUrl("")}getAnchorUrl(anchor){return(this.baseUrl||"")+anchor}setHash(hash){if(!this.pdfDocument)return;let pageNumber,dest;if(hash.includes("=")){const params=(0,_ui_utils.parseQueryString)(hash);if(params.has("search")&&this.eventBus.dispatch("findfromurlhash",{source:this,query:params.get("search").replace(/"/g,""),phraseSearch:"true"===params.get("phrase")}),params.has("page")&&(pageNumber=0|params.get("page")||1),params.has("zoom")){const zoomArgs=params.get("zoom").split(","),zoomArg=zoomArgs[0],zoomArgNumber=parseFloat(zoomArg);zoomArg.includes("Fit")?"Fit"===zoomArg||"FitB"===zoomArg?dest=[null,{name:zoomArg}]:"FitH"===zoomArg||"FitBH"===zoomArg||"FitV"===zoomArg||"FitBV"===zoomArg?dest=[null,{name:zoomArg},zoomArgs.length>1?0|zoomArgs[1]:null]:"FitR"===zoomArg?5!==zoomArgs.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):dest=[null,{name:zoomArg},0|zoomArgs[1],0|zoomArgs[2],0|zoomArgs[3],0|zoomArgs[4]]:console.error(`PDFLinkService.setHash: "${zoomArg}" is not a valid zoom value.`):dest=[null,{name:"XYZ"},zoomArgs.length>1?0|zoomArgs[1]:null,zoomArgs.length>2?0|zoomArgs[2]:null,zoomArgNumber?zoomArgNumber/100:zoomArg]}dest?this.pdfViewer.scrollPageIntoView({pageNumber:pageNumber||this.page,destArray:dest,allowNegativeOffset:!0}):pageNumber&&(this.page=pageNumber),params.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:params.get("pagemode")}),params.has("nameddest")&&this.goToDestination(params.get("nameddest"))}else{dest=unescape(hash);try{dest=JSON.parse(dest),Array.isArray(dest)||(dest=dest.toString())}catch{}if("string"==typeof dest||PDFLinkService.#isValidExplicitDestination(dest))return void this.goToDestination(dest);console.error(`PDFLinkService.setHash: "${unescape(hash)}" is not a valid destination.`)}}executeNamedAction(action){switch(action){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action})}cachePageRef(pageNum,pageRef){pageRef&&this.#pagesRefCache.set(0===pageRef.gen?`${pageRef.num}R`:`${pageRef.num}R${pageRef.gen}`,pageNum)}_cachedPageNumber(pageRef){return pageRef&&this.#pagesRefCache.get(0===pageRef.gen?`${pageRef.num}R`:`${pageRef.num}R${pageRef.gen}`)||null}isPageVisible(pageNumber){return this.pdfViewer.isPageVisible(pageNumber)}isPageCached(pageNumber){return this.pdfViewer.isPageCached(pageNumber)}static#isValidExplicitDestination(dest){if(!Array.isArray(dest))return!1;const destLength=dest.length;if(destLength<2)return!1;const page=dest[0];if(!("object"==typeof page&&Number.isInteger(page.num)&&Number.isInteger(page.gen)||Number.isInteger(page)&&page>=0))return!1;const zoom=dest[1];if("object"!=typeof zoom||"string"!=typeof zoom.name)return!1;let allowNull=!0;switch(zoom.name){case"XYZ":if(5!==destLength)return!1;break;case"Fit":case"FitB":return 2===destLength;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==destLength)return!1;break;case"FitR":if(6!==destLength)return!1;allowNull=!1;break;default:return!1}for(let i=2;i<destLength;i++){const param=dest[i];if(!("number"==typeof param||allowNull&&null===param))return!1}return!0}}exports2.PDFLinkService=PDFLinkService,exports2.SimpleLinkService=class SimpleLinkService{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(value){}get rotation(){return 0}set rotation(value){}goToDestination(dest){return _asyncToGenerator2(function*(){})()}goToPage(val){}addLinkAttributes(link,url,newWindow=!1){addLinkAttributes(link,{url,enabled:this.externalLinkEnabled})}getDestinationHash(dest){return"#"}getAnchorUrl(hash){return"#"}setHash(hash){}executeNamedAction(action){}cachePageRef(pageNum,pageRef){}isPageVisible(pageNumber){return!0}isPageCached(pageNumber){return!0}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.animationStarted=exports2.VERTICAL_PADDING=exports2.UNKNOWN_SCALE=exports2.TextLayerMode=exports2.SpreadMode=exports2.SidebarView=exports2.ScrollMode=exports2.SCROLLBAR_PADDING=exports2.RenderingStates=exports2.RendererType=exports2.ProgressBar=exports2.PresentationModeState=exports2.OutputScale=exports2.MIN_SCALE=exports2.MAX_SCALE=exports2.MAX_AUTO_SCALE=exports2.DEFAULT_SCALE_VALUE=exports2.DEFAULT_SCALE_DELTA=exports2.DEFAULT_SCALE=exports2.AutoPrintRegExp=void 0,exports2.apiPageLayoutToViewerModes=function apiPageLayoutToViewerModes(layout){let scrollMode=ScrollMode.VERTICAL,spreadMode=SpreadMode.NONE;switch(layout){case"SinglePage":scrollMode=ScrollMode.PAGE;break;case"OneColumn":break;case"TwoPageLeft":scrollMode=ScrollMode.PAGE;case"TwoColumnLeft":spreadMode=SpreadMode.ODD;break;case"TwoPageRight":scrollMode=ScrollMode.PAGE;case"TwoColumnRight":spreadMode=SpreadMode.EVEN}return{scrollMode,spreadMode}},exports2.apiPageModeToSidebarView=function apiPageModeToSidebarView(mode){switch(mode){case"UseNone":return SidebarView.NONE;case"UseThumbs":return SidebarView.THUMBS;case"UseOutlines":return SidebarView.OUTLINE;case"UseAttachments":return SidebarView.ATTACHMENTS;case"UseOC":return SidebarView.LAYERS}return SidebarView.NONE},exports2.approximateFraction=function approximateFraction(x){if(Math.floor(x)===x)return[x,1];const xinv=1/x;if(xinv>8)return[1,8];if(Math.floor(xinv)===xinv)return[1,xinv];const x_=x>1?xinv:x;let result,a=0,b=1,c=1,d=1;for(;;){const p=a+c,q=b+d;if(q>8)break;x_<=p/q?(c=p,d=q):(a=p,b=q)}return result=x_-a/b<c/d-x_?x_===x?[a,b]:[b,a]:x_===x?[c,d]:[d,c],result},exports2.backtrackBeforeAllVisibleElements=backtrackBeforeAllVisibleElements,exports2.binarySearchFirstItem=binarySearchFirstItem,exports2.docStyle=void 0,exports2.getActiveOrFocusedElement=function getActiveOrFocusedElement(){let curRoot=document,curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");for(;curActiveOrFocused?.shadowRoot;)curRoot=curActiveOrFocused.shadowRoot,curActiveOrFocused=curRoot.activeElement||curRoot.querySelector(":focus");return curActiveOrFocused},exports2.getPageSizeInches=function getPageSizeInches({view,userUnit,rotate}){const[x1,y1,x2,y2]=view,changeOrientation=rotate%180!=0,width=(x2-x1)/72*userUnit,height=(y2-y1)/72*userUnit;return{width:changeOrientation?height:width,height:changeOrientation?width:height}},exports2.getVisibleElements=function getVisibleElements({scrollEl,views,sortByVisibility=!1,horizontal=!1,rtl=!1}){const top=scrollEl.scrollTop,bottom=top+scrollEl.clientHeight,left=scrollEl.scrollLeft,right=left+scrollEl.clientWidth,visible=[],ids=new Set,numViews=views.length;let firstVisibleElementInd=binarySearchFirstItem(views,horizontal?function isElementNextAfterViewHorizontally(view){const element=view.div,elementLeft=element.offsetLeft+element.clientLeft;return rtl?elementLeft<right:elementLeft+element.clientWidth>left}:function isElementBottomAfterViewTop(view){const element=view.div;return element.offsetTop+element.clientTop+element.clientHeight>top});firstVisibleElementInd>0&&firstVisibleElementInd<numViews&&!horizontal&&(firstVisibleElementInd=backtrackBeforeAllVisibleElements(firstVisibleElementInd,views,top));let lastEdge=horizontal?right:-1;for(let i=firstVisibleElementInd;i<numViews;i++){const view=views[i],element=view.div,currentWidth=element.offsetLeft+element.clientLeft,currentHeight=element.offsetTop+element.clientTop,viewWidth=element.clientWidth,viewHeight=element.clientHeight,viewRight=currentWidth+viewWidth,viewBottom=currentHeight+viewHeight;if(-1===lastEdge)viewBottom>=bottom&&(lastEdge=viewBottom);else if((horizontal?currentWidth:currentHeight)>lastEdge)break;if(viewBottom<=top||currentHeight>=bottom||viewRight<=left||currentWidth>=right)continue;const hiddenHeight=Math.max(0,top-currentHeight)+Math.max(0,viewBottom-bottom),fractionWidth=(viewWidth-(Math.max(0,left-currentWidth)+Math.max(0,viewRight-right)))/viewWidth;visible.push({id:view.id,x:currentWidth,y:currentHeight,view,percent:(viewHeight-hiddenHeight)/viewHeight*fractionWidth*100|0,widthPercent:100*fractionWidth|0}),ids.add(view.id)}const first=visible[0],last=visible.at(-1);return sortByVisibility&&visible.sort(function(a,b){const pc=a.percent-b.percent;return Math.abs(pc)>.001?-pc:a.id-b.id}),{first,last,views:visible,ids}},exports2.isPortraitOrientation=function isPortraitOrientation(size){return size.width<=size.height},exports2.isValidRotation=function isValidRotation(angle){return Number.isInteger(angle)&&angle%90==0},exports2.isValidScrollMode=function isValidScrollMode(mode){return Number.isInteger(mode)&&Object.values(ScrollMode).includes(mode)&&mode!==ScrollMode.UNKNOWN},exports2.isValidSpreadMode=function isValidSpreadMode(mode){return Number.isInteger(mode)&&Object.values(SpreadMode).includes(mode)&&mode!==SpreadMode.UNKNOWN},exports2.noContextMenuHandler=function noContextMenuHandler(evt){evt.preventDefault()},exports2.normalizeWheelEventDelta=function normalizeWheelEventDelta(evt){let delta=normalizeWheelEventDirection(evt);return 0===evt.deltaMode?delta/=900:1===evt.deltaMode&&(delta/=30),delta},exports2.normalizeWheelEventDirection=normalizeWheelEventDirection,exports2.parseQueryString=function parseQueryString(query){const params=new Map;for(const[key,value]of new URLSearchParams(query))params.set(key.toLowerCase(),value);return params},exports2.removeNullCharacters=function removeNullCharacters(str,replaceInvisible=!1){return"string"!=typeof str?(console.error("The argument must be a string."),str):(replaceInvisible&&(str=str.replace(InvisibleCharactersRegExp," ")),str.replace(NullCharactersRegExp,""))},exports2.roundToDivide=function roundToDivide(x,div){const r=x%div;return 0===r?x:Math.round(x-r+div)},exports2.scrollIntoView=function scrollIntoView(element,spot,scrollMatches=!1){let parent=element.offsetParent;if(!parent)return void console.error("offsetParent is not set -- cannot scroll");let offsetY=element.offsetTop+element.clientTop,offsetX=element.offsetLeft+element.clientLeft;for(;parent.clientHeight===parent.scrollHeight&&parent.clientWidth===parent.scrollWidth||scrollMatches&&(parent.classList.contains("markedContent")||"hidden"===getComputedStyle(parent).overflow);)if(offsetY+=parent.offsetTop,offsetX+=parent.offsetLeft,parent=parent.offsetParent,!parent)return;spot&&(void 0!==spot.top&&(offsetY+=spot.top),void 0!==spot.left&&(offsetX+=spot.left,parent.scrollLeft=offsetX)),parent.scrollTop=offsetY},exports2.watchScroll=function watchScroll(viewAreaElement,callback){const debounceScroll=function(evt){rAF||(rAF=window.requestAnimationFrame(function(){rAF=null;const currentX=viewAreaElement.scrollLeft,lastX=state.lastX;currentX!==lastX&&(state.right=currentX>lastX),state.lastX=currentX;const currentY=viewAreaElement.scrollTop,lastY=state.lastY;currentY!==lastY&&(state.down=currentY>lastY),state.lastY=currentY,callback(state)}))},state={right:!0,down:!0,lastX:viewAreaElement.scrollLeft,lastY:viewAreaElement.scrollTop,_eventHandler:debounceScroll};let rAF=null;return viewAreaElement.addEventListener("scroll",debounceScroll,!0),state},exports2.DEFAULT_SCALE_VALUE="auto",exports2.DEFAULT_SCALE=1,exports2.DEFAULT_SCALE_DELTA=1.1,exports2.MIN_SCALE=.1,exports2.MAX_SCALE=10,exports2.UNKNOWN_SCALE=0,exports2.MAX_AUTO_SCALE=1.25,exports2.SCROLLBAR_PADDING=40,exports2.VERTICAL_PADDING=5,exports2.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},exports2.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const SidebarView={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};exports2.SidebarView=SidebarView,exports2.RendererType={CANVAS:"canvas",SVG:"svg"},exports2.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};const ScrollMode={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};exports2.ScrollMode=ScrollMode;const SpreadMode={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};exports2.SpreadMode=SpreadMode,exports2.AutoPrintRegExp=/\bprint\s*\(/,exports2.OutputScale=class OutputScale{constructor(){const pixelRatio=window.devicePixelRatio||1;this.sx=pixelRatio,this.sy=pixelRatio}get scaled(){return 1!==this.sx||1!==this.sy}};const NullCharactersRegExp=/\x00/g,InvisibleCharactersRegExp=/[\x01-\x1F]/g;function binarySearchFirstItem(items,condition,start=0){let minIndex=start,maxIndex=items.length-1;if(maxIndex<0||!condition(items[maxIndex]))return items.length;if(condition(items[minIndex]))return minIndex;for(;minIndex<maxIndex;){const currentIndex=minIndex+maxIndex>>1;condition(items[currentIndex])?maxIndex=currentIndex:minIndex=currentIndex+1}return minIndex}function backtrackBeforeAllVisibleElements(index,views,top){if(index<2)return index;let elt=views[index].div,pageTop=elt.offsetTop+elt.clientTop;pageTop>=top&&(elt=views[index-1].div,pageTop=elt.offsetTop+elt.clientTop);for(let i=index-2;i>=0&&(elt=views[i].div,!(elt.offsetTop+elt.clientTop+elt.clientHeight<=pageTop));--i)index=i;return index}function normalizeWheelEventDirection(evt){let delta=Math.hypot(evt.deltaX,evt.deltaY);const angle=Math.atan2(evt.deltaY,evt.deltaX);return-.25*Math.PI<angle&&angle<.75*Math.PI&&(delta=-delta),delta}const animationStarted=new Promise(function(resolve){window.requestAnimationFrame(resolve)});exports2.animationStarted=animationStarted;const docStyle=document.documentElement.style;exports2.docStyle=docStyle,exports2.ProgressBar=class ProgressBar{#classList=null;#percent=0;#visible=!0;constructor(id){if(arguments.length>1)throw new Error("ProgressBar no longer accepts any additional options, please use CSS rules to modify its appearance instead.");const bar=document.getElementById(id);this.#classList=bar.classList}get percent(){return this.#percent}set percent(val){this.#percent=function clamp(v,min,max){return Math.min(Math.max(v,min),max)}(val,0,100),isNaN(val)?this.#classList.add("indeterminate"):(this.#classList.remove("indeterminate"),docStyle.setProperty("--progressBar-percent",`${this.#percent}%`))}setWidth(viewer){if(!viewer)return;const scrollbarWidth=viewer.parentNode.offsetWidth-viewer.offsetWidth;scrollbarWidth>0&&docStyle.setProperty("--progressBar-end-offset",`${scrollbarWidth}px`)}hide(){this.#visible&&(this.#visible=!1,this.#classList.add("hidden"))}show(){this.#visible||(this.#visible=!0,this.#classList.remove("hidden"))}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.StructTreeLayerBuilder=void 0;const PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;exports2.StructTreeLayerBuilder=class StructTreeLayerBuilder{constructor({pdfPage}){this.pdfPage=pdfPage}render(structTree){return this._walk(structTree)}_setAttributes(structElement,htmlElement){void 0!==structElement.alt&&htmlElement.setAttribute("aria-label",structElement.alt),void 0!==structElement.id&&htmlElement.setAttribute("aria-owns",structElement.id),void 0!==structElement.lang&&htmlElement.setAttribute("lang",structElement.lang)}_walk(node){if(!node)return null;const element=document.createElement("span");if("role"in node){const{role}=node,match=role.match(HEADING_PATTERN);match?(element.setAttribute("role","heading"),element.setAttribute("aria-level",match[1])):PDF_ROLE_TO_HTML_ROLE[role]&&element.setAttribute("role",PDF_ROLE_TO_HTML_ROLE[role])}if(this._setAttributes(node,element),node.children)if(1===node.children.length&&"id"in node.children[0])this._setAttributes(node.children[0],element);else for(const kid of node.children)element.append(this._walk(kid));return element}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.TextLayerBuilder=void 0;var _pdfjsLib=__w_pdfjs_require__3(3);exports2.TextLayerBuilder=class TextLayerBuilder{constructor({textLayerDiv,eventBus,pageIndex,viewport,highlighter=null,enhanceTextSelection=!1,accessibilityManager=null}){this.textLayerDiv=textLayerDiv,this.eventBus=eventBus,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=pageIndex+1,this.viewport=viewport,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=highlighter,this.enhanceTextSelection=enhanceTextSelection,this.accessibilityManager=accessibilityManager,this._bindMouse()}_finishRendering(){if(this.renderingDone=!0,!this.enhanceTextSelection){const endOfContent=document.createElement("div");endOfContent.className="endOfContent",this.textLayerDiv.append(endOfContent)}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}render(timeout=0){if(!this.textContent&&!this.textContentStream||this.renderingDone)return;this.cancel(),this.textDivs.length=0,this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr),this.accessibilityManager?.setTextMapping(this.textDivs);const textLayerFrag=document.createDocumentFragment();this.textLayerRenderTask=(0,_pdfjsLib.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:textLayerFrag,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then(()=>{this.textLayerDiv.append(textLayerFrag),this._finishRendering(),this.highlighter?.enable(),this.accessibilityManager?.enable()},function(reason){})}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable(),this.accessibilityManager?.disable()}setTextContentStream(readableStream){this.cancel(),this.textContentStream=readableStream}setTextContent(textContent){this.cancel(),this.textContent=textContent}_bindMouse(){const div=this.textLayerDiv;let expandDivsTimer=null;div.addEventListener("mousedown",evt=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return this.textLayerRenderTask.expandTextDivs(!0),void(expandDivsTimer&&(clearTimeout(expandDivsTimer),expandDivsTimer=null));const end=div.querySelector(".endOfContent");if(!end)return;let adjustTop=evt.target!==div;if(adjustTop=adjustTop&&"none"!==window.getComputedStyle(end).getPropertyValue("-moz-user-select"),adjustTop){const divBounds=div.getBoundingClientRect(),r=Math.max(0,(evt.pageY-divBounds.top)/divBounds.height);end.style.top=(100*r).toFixed(2)+"%"}end.classList.add("active")}),div.addEventListener("mouseup",()=>{if(this.enhanceTextSelection&&this.textLayerRenderTask)return void(expandDivsTimer=setTimeout(()=>{this.textLayerRenderTask&&this.textLayerRenderTask.expandTextDivs(!1),expandDivsTimer=null},300));const end=div.querySelector(".endOfContent");end&&(end.style.top="",end.classList.remove("active"))})}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.XfaLayerBuilder=void 0;var _pdfjsLib=__w_pdfjs_require__3(3);exports2.XfaLayerBuilder=class XfaLayerBuilder{constructor({pageDiv,pdfPage,annotationStorage=null,linkService,xfaHtml=null}){this.pageDiv=pageDiv,this.pdfPage=pdfPage,this.annotationStorage=annotationStorage,this.linkService=linkService,this.xfaHtml=xfaHtml,this.div=null,this._cancelled=!1}render(viewport,intent="display"){if("print"===intent){const parameters={viewport:viewport.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent},div=document.createElement("div");this.pageDiv.append(div),parameters.div=div;const result=_pdfjsLib.XfaLayer.render(parameters);return Promise.resolve(result)}return this.pdfPage.getXfa().then(xfaHtml=>{if(this._cancelled||!xfaHtml)return{textDivs:[]};const parameters={viewport:viewport.clone({dontFlip:!0}),div:this.div,xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent};return this.div?_pdfjsLib.XfaLayer.update(parameters):(this.div=document.createElement("div"),this.pageDiv.append(this.div),parameters.div=this.div,_pdfjsLib.XfaLayer.render(parameters))}).catch(error=>{console.error(error)})}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFViewer=exports2.PDFSinglePageViewer=void 0;var _ui_utils=__w_pdfjs_require__3(7),_base_viewer=__w_pdfjs_require__3(12);exports2.PDFViewer=class PDFViewer extends _base_viewer.BaseViewer{},exports2.PDFSinglePageViewer=class PDFSinglePageViewer extends _base_viewer.BaseViewer{_resetView(){super._resetView(),this._scrollMode=_ui_utils.ScrollMode.PAGE,this._spreadMode=_ui_utils.SpreadMode.NONE}set scrollMode(mode){}_updateScrollMode(){}set spreadMode(mode){}_updateSpreadMode(){}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PagesCountLimit=exports2.PDFPageViewBuffer=exports2.BaseViewer=void 0;var _pdfjsLib=__w_pdfjs_require__3(3),_ui_utils=__w_pdfjs_require__3(7),_annotation_editor_layer_builder=__w_pdfjs_require__3(2),_annotation_layer_builder=__w_pdfjs_require__3(5),_l10n_utils=__w_pdfjs_require__3(4),_pdf_page_view=__w_pdfjs_require__3(13),_pdf_rendering_queue=__w_pdfjs_require__3(16),_pdf_link_service=__w_pdfjs_require__3(6),_struct_tree_layer_builder=__w_pdfjs_require__3(8),_text_highlighter=__w_pdfjs_require__3(17),_text_layer_builder=__w_pdfjs_require__3(9),_xfa_layer_builder=__w_pdfjs_require__3(10);const PagesCountLimit={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};function isValidAnnotationEditorMode(mode){return Object.values(_pdfjsLib.AnnotationEditorType).includes(mode)&&mode!==_pdfjsLib.AnnotationEditorType.DISABLE}exports2.PagesCountLimit=PagesCountLimit;class PDFPageViewBuffer{#buf=new Set;#size=0;constructor(size){this.#size=size}push(view){const buf=this.#buf;buf.has(view)&&buf.delete(view),buf.add(view),buf.size>this.#size&&this.#destroyFirstView()}resize(newSize,idsToKeep=null){this.#size=newSize;const buf=this.#buf;if(idsToKeep){const ii=buf.size;let i=1;for(const view of buf)if(idsToKeep.has(view.id)&&(buf.delete(view),buf.add(view)),++i>ii)break}for(;buf.size>this.#size;)this.#destroyFirstView()}has(view){return this.#buf.has(view)}[Symbol.iterator](){return this.#buf.keys()}#destroyFirstView(){const firstView=this.#buf.keys().next().value;firstView?.destroy(),this.#buf.delete(firstView)}}exports2.PDFPageViewBuffer=PDFPageViewBuffer;class BaseViewer{#buffer=null;#annotationEditorMode=_pdfjsLib.AnnotationEditorType.DISABLE;#annotationEditorUIManager=null;#annotationMode=_pdfjsLib.AnnotationMode.ENABLE_FORMS;#enablePermissions=!1;#previousContainerHeight=0;#scrollModePageState=null;#onVisibilityChange=null;constructor(options){if(this.constructor===BaseViewer)throw new Error("Cannot initialize BaseViewer.");if("2.16.105"!==_pdfjsLib.version)throw new Error(`The API version "${_pdfjsLib.version}" does not match the Viewer version "2.16.105".`);if(this.container=options.container,this.viewer=options.viewer||options.container.firstElementChild,"DIV"!==this.container?.tagName.toUpperCase()||"DIV"!==this.viewer?.tagName.toUpperCase())throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.eventBus=options.eventBus,this.linkService=options.linkService||new _pdf_link_service.SimpleLinkService,this.downloadManager=options.downloadManager||null,this.findController=options.findController||null,this._scriptingManager=options.scriptingManager||null,this.removePageBorders=options.removePageBorders||!1,this.textLayerMode=options.textLayerMode??_ui_utils.TextLayerMode.ENABLE,this.#annotationMode=options.annotationMode??_pdfjsLib.AnnotationMode.ENABLE_FORMS,this.#annotationEditorMode=options.annotationEditorMode??_pdfjsLib.AnnotationEditorType.DISABLE,this.imageResourcesPath=options.imageResourcesPath||"",this.enablePrintAutoRotate=options.enablePrintAutoRotate||!1,this.renderer=options.renderer||_ui_utils.RendererType.CANVAS,this.useOnlyCssZoom=options.useOnlyCssZoom||!1,this.maxCanvasPixels=options.maxCanvasPixels,this.l10n=options.l10n||_l10n_utils.NullL10n,this.#enablePermissions=options.enablePermissions||!1,this.pageColors=options.pageColors||null,this.pageColors&&!(CSS.supports("color",this.pageColors.background)&&CSS.supports("color",this.pageColors.foreground))&&((this.pageColors.background||this.pageColors.foreground)&&console.warn("BaseViewer: Ignoring `pageColors`-option, since the browser doesn't support the values used."),this.pageColors=null),this.defaultRenderingQueue=!options.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new _pdf_rendering_queue.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=options.renderingQueue,this.scroll=(0,_ui_utils.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=_ui_utils.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.updateContainerHeightCss()}get pagesCount(){return this._pages.length}getPageView(index){return this._pages[index]}get pageViewsReady(){return!!this._pagesCapability.settled&&this._pages.every(function(pageView){return pageView?.pdfPage})}get renderForms(){return this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(val){if(!Number.isInteger(val))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(val,!0)||console.error(`currentPageNumber: "${val}" is not a valid page.`))}_setCurrentPageNumber(val,resetCurrentPageView=!1){if(this._currentPageNumber===val)return resetCurrentPageView&&this.#resetCurrentPageView(),!0;if(!(0<val&&val<=this.pagesCount))return!1;const previous=this._currentPageNumber;return this._currentPageNumber=val,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:val,pageLabel:this._pageLabels?.[val-1]??null,previous}),resetCurrentPageView&&this.#resetCurrentPageView(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(val){if(!this.pdfDocument)return;let page=0|val;if(this._pageLabels){const i=this._pageLabels.indexOf(val);i>=0&&(page=i+1)}this._setCurrentPageNumber(page,!0)||console.error(`currentPageLabel: "${val}" is not a valid page.`)}get currentScale(){return this._currentScale!==_ui_utils.UNKNOWN_SCALE?this._currentScale:_ui_utils.DEFAULT_SCALE}set currentScale(val){if(isNaN(val))throw new Error("Invalid numeric scale.");this.pdfDocument&&this._setScale(val,!1)}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(val){this.pdfDocument&&this._setScale(val,!1)}get pagesRotation(){return this._pagesRotation}set pagesRotation(rotation){if(!(0,_ui_utils.isValidRotation)(rotation))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||((rotation%=360)<0&&(rotation+=360),this._pagesRotation===rotation))return;this._pagesRotation=rotation;const pageNumber=this._currentPageNumber,updateArgs={rotation};for(const pageView of this._pages)pageView.update(updateArgs);this._currentScaleValue&&this._setScale(this._currentScaleValue,!0),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:rotation,pageNumber}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#initializePermissions(permissions){const params={annotationEditorMode:this.#annotationEditorMode,annotationMode:this.#annotationMode,textLayerMode:this.textLayerMode};return permissions&&(permissions.includes(_pdfjsLib.PermissionFlag.COPY)||this.viewer.classList.add("enablePermissions"),permissions.includes(_pdfjsLib.PermissionFlag.MODIFY_CONTENTS)||(params.annotationEditorMode=_pdfjsLib.AnnotationEditorType.DISABLE),!permissions.includes(_pdfjsLib.PermissionFlag.MODIFY_ANNOTATIONS)&&!permissions.includes(_pdfjsLib.PermissionFlag.FILL_INTERACTIVE_FORMS)&&this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS&&(params.annotationMode=_pdfjsLib.AnnotationMode.ENABLE)),params}#onePageRenderedOrForceFetch(){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return Promise.resolve();const visibilityChangePromise=new Promise(resolve=>{this.#onVisibilityChange=()=>{"hidden"===document.visibilityState&&(resolve(),document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null)},document.addEventListener("visibilitychange",this.#onVisibilityChange)});return Promise.race([this._onePageRenderedCapability.promise,visibilityChangePromise])}setDocument(pdfDocument){var _this42=this;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController&&this.findController.setDocument(null),this._scriptingManager&&this._scriptingManager.setDocument(null),this.#annotationEditorUIManager&&(this.#annotationEditorUIManager.destroy(),this.#annotationEditorUIManager=null)),this.pdfDocument=pdfDocument,!pdfDocument)return;const isPureXfa=pdfDocument.isPureXfa,pagesCount=pdfDocument.numPages,firstPagePromise=pdfDocument.getPage(1),optionalContentConfigPromise=pdfDocument.getOptionalContentConfig(),permissionsPromise=this.#enablePermissions?pdfDocument.getPermissions():Promise.resolve();if(pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const mode=this._scrollMode=_ui_utils.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode})}this._pagesCapability.promise.then(()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount})},()=>{}),this._onBeforeDraw=evt=>{const pageView=this._pages[evt.pageNumber-1];pageView&&this.#buffer.push(pageView)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=evt=>{evt.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:evt.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([firstPagePromise,permissionsPromise]).then(([firstPdfPage,permissions])=>{if(pdfDocument!==this.pdfDocument)return;this._firstPageCapability.resolve(firstPdfPage),this._optionalContentConfigPromise=optionalContentConfigPromise;const{annotationEditorMode,annotationMode,textLayerMode}=this.#initializePermissions(permissions);if(annotationEditorMode!==_pdfjsLib.AnnotationEditorType.DISABLE){const mode=annotationEditorMode;isPureXfa?console.warn("Warning: XFA-editing is not implemented."):isValidAnnotationEditorMode(mode)?(this.#annotationEditorUIManager=new _pdfjsLib.AnnotationEditorUIManager(this.container,this.eventBus),mode!==_pdfjsLib.AnnotationEditorType.NONE&&this.#annotationEditorUIManager.updateMode(mode)):console.error(`Invalid AnnotationEditor mode: ${mode}`)}const viewerElement=this._scrollMode===_ui_utils.ScrollMode.PAGE?null:this.viewer,scale=this.currentScale,viewport=firstPdfPage.getViewport({scale:scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS}),textLayerFactory=textLayerMode===_ui_utils.TextLayerMode.DISABLE||isPureXfa?null:this,annotationLayerFactory=annotationMode!==_pdfjsLib.AnnotationMode.DISABLE?this:null,xfaLayerFactory=isPureXfa?this:null,annotationEditorLayerFactory=this.#annotationEditorUIManager?this:null;for(let pageNum=1;pageNum<=pagesCount;++pageNum){const pageView=new _pdf_page_view.PDFPageView({container:viewerElement,eventBus:this.eventBus,id:pageNum,scale,defaultViewport:viewport.clone(),optionalContentConfigPromise,renderingQueue:this.renderingQueue,textLayerFactory,textLayerMode,annotationLayerFactory,annotationMode,xfaLayerFactory,annotationEditorLayerFactory,textHighlighterFactory:this,structTreeLayerFactory:this,imageResourcesPath:this.imageResourcesPath,renderer:this.renderer,useOnlyCssZoom:this.useOnlyCssZoom,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n});this._pages.push(pageView)}const firstPageView=this._pages[0];firstPageView&&(firstPageView.setPdfPage(firstPdfPage),this.linkService.cachePageRef(1,firstPdfPage.ref)),this._scrollMode===_ui_utils.ScrollMode.PAGE?this.#ensurePageViewVisible():this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._updateSpreadMode(),this.#onePageRenderedOrForceFetch().then(_asyncToGenerator2(function*(){if(_this42.findController&&_this42.findController.setDocument(pdfDocument),_this42._scriptingManager&&_this42._scriptingManager.setDocument(pdfDocument),_this42.#annotationEditorUIManager&&_this42.eventBus.dispatch("annotationeditormodechanged",{source:_this42,mode:_this42.#annotationEditorMode}),pdfDocument.loadingParams.disableAutoFetch||pagesCount>PagesCountLimit.FORCE_LAZY_PAGE_INIT)return void _this42._pagesCapability.resolve();let getPagesLeft=pagesCount-1;if(getPagesLeft<=0)_this42._pagesCapability.resolve();else for(let pageNum=2;pageNum<=pagesCount;++pageNum){const promise=pdfDocument.getPage(pageNum).then(pdfPage=>{const pageView=_this42._pages[pageNum-1];pageView.pdfPage||pageView.setPdfPage(pdfPage),_this42.linkService.cachePageRef(pageNum,pdfPage.ref),0==--getPagesLeft&&_this42._pagesCapability.resolve()},reason=>{console.error(`Unable to get page ${pageNum} to initialize viewer`,reason),0==--getPagesLeft&&_this42._pagesCapability.resolve()});pageNum%PagesCountLimit.PAUSE_EAGER_PAGE_INIT==0&&(yield promise)}})),this.eventBus.dispatch("pagesinit",{source:this}),pdfDocument.getMetadata().then(({info})=>{pdfDocument===this.pdfDocument&&info.Language&&(this.viewer.lang=info.Language)}),this.defaultRenderingQueue&&this.update()}).catch(reason=>{console.error("Unable to initialize viewer",reason),this._pagesCapability.reject(reason)})}setPageLabels(labels){if(this.pdfDocument){labels?Array.isArray(labels)&&this.pdfDocument.numPages===labels.length?this._pageLabels=labels:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let i=0,ii=this._pages.length;i<ii;i++)this._pages[i].setPageLabel(this._pageLabels?.[i]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=_ui_utils.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#buffer=new PDFPageViewBuffer(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=(0,_pdfjsLib.createPromiseCapability)(),this._onePageRenderedCapability=(0,_pdfjsLib.createPromiseCapability)(),this._pagesCapability=(0,_pdfjsLib.createPromiseCapability)(),this._scrollMode=_ui_utils.ScrollMode.VERTICAL,this._previousScrollMode=_ui_utils.ScrollMode.UNKNOWN,this._spreadMode=_ui_utils.SpreadMode.NONE,this.#scrollModePageState={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#onVisibilityChange&&(document.removeEventListener("visibilitychange",this.#onVisibilityChange),this.#onVisibilityChange=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.viewer.classList.remove("enablePermissions")}#ensurePageViewVisible(){if(this._scrollMode!==_ui_utils.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const pageNumber=this._currentPageNumber,state=this.#scrollModePageState,viewer=this.viewer;if(viewer.textContent="",state.pages.length=0,this._spreadMode!==_ui_utils.SpreadMode.NONE||this.isInPresentationMode){const pageIndexSet=new Set,parity=this._spreadMode-1;-1===parity?pageIndexSet.add(pageNumber-1):pageNumber%2!==parity?(pageIndexSet.add(pageNumber-1),pageIndexSet.add(pageNumber)):(pageIndexSet.add(pageNumber-2),pageIndexSet.add(pageNumber-1));const spread=document.createElement("div");if(spread.className="spread",this.isInPresentationMode){const dummyPage=document.createElement("div");dummyPage.className="dummyPage",spread.append(dummyPage)}for(const i of pageIndexSet){const pageView=this._pages[i];pageView&&(spread.append(pageView.div),state.pages.push(pageView))}viewer.append(spread)}else{const pageView=this._pages[pageNumber-1];viewer.append(pageView.div),state.pages.push(pageView)}state.scrollDown=pageNumber>=state.previousPageNumber,state.previousPageNumber=pageNumber}_scrollUpdate(){0!==this.pagesCount&&this.update()}#scrollIntoView(pageView,pageSpot=null){const{div,id}=pageView;if(this._scrollMode===_ui_utils.ScrollMode.PAGE&&(this._setCurrentPageNumber(id),this.#ensurePageViewVisible(),this.update()),!pageSpot&&!this.isInPresentationMode){const left=div.offsetLeft+div.clientLeft,right=left+div.clientWidth,{scrollLeft,clientWidth}=this.container;(this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL||left<scrollLeft||right>scrollLeft+clientWidth)&&(pageSpot={left:0,top:0})}(0,_ui_utils.scrollIntoView)(div,pageSpot)}#isSameScale(newScale){return newScale===this._currentScale||Math.abs(newScale-this._currentScale)<1e-15}_setScaleUpdatePages(newScale,newValue,noScroll=!1,preset=!1){if(this._currentScaleValue=newValue.toString(),this.#isSameScale(newScale))return void(preset&&this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:newValue}));_ui_utils.docStyle.setProperty("--scale-factor",newScale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS);const updateArgs={scale:newScale};for(const pageView of this._pages)pageView.update(updateArgs);if(this._currentScale=newScale,!noScroll){let dest,page=this._currentPageNumber;this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(page=this._location.pageNumber,dest=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:page,destArray:dest,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:newScale,presetValue:preset?newValue:void 0}),this.defaultRenderingQueue&&this.update(),this.updateContainerHeightCss()}get _pageWidthScaleFactor(){return this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._scrollMode!==_ui_utils.ScrollMode.HORIZONTAL?2:1}_setScale(value,noScroll=!1){let scale=parseFloat(value);if(scale>0)this._setScaleUpdatePages(scale,value,noScroll,!1);else{const currentPage=this._pages[this._currentPageNumber-1];if(!currentPage)return;let hPadding=_ui_utils.SCROLLBAR_PADDING,vPadding=_ui_utils.VERTICAL_PADDING;this.isInPresentationMode?hPadding=vPadding=4:this.removePageBorders?hPadding=vPadding=0:this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL&&([hPadding,vPadding]=[vPadding,hPadding]);const pageWidthScale=(this.container.clientWidth-hPadding)/currentPage.width*currentPage.scale/this._pageWidthScaleFactor,pageHeightScale=(this.container.clientHeight-vPadding)/currentPage.height*currentPage.scale;switch(value){case"page-actual":scale=1;break;case"page-width":scale=pageWidthScale;break;case"page-height":scale=pageHeightScale;break;case"page-fit":scale=Math.min(pageWidthScale,pageHeightScale);break;case"auto":const horizontalScale=(0,_ui_utils.isPortraitOrientation)(currentPage)?pageWidthScale:Math.min(pageHeightScale,pageWidthScale);scale=Math.min(_ui_utils.MAX_AUTO_SCALE,horizontalScale);break;default:return void console.error(`_setScale: "${value}" is an unknown zoom value.`)}this._setScaleUpdatePages(scale,value,noScroll,!0)}}#resetCurrentPageView(){const pageView=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this._setScale(this._currentScaleValue,!0),this.#scrollIntoView(pageView)}pageLabelToPageNumber(label){if(!this._pageLabels)return null;const i=this._pageLabels.indexOf(label);return i<0?null:i+1}scrollPageIntoView({pageNumber,destArray=null,allowNegativeOffset=!1,ignoreDestinationZoom=!1}){if(!this.pdfDocument)return;const pageView=Number.isInteger(pageNumber)&&this._pages[pageNumber-1];if(!pageView)return void console.error(`scrollPageIntoView: "${pageNumber}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!destArray)return void this._setCurrentPageNumber(pageNumber,!0);let widthScale,heightScale,x=0,y=0,width=0,height=0;const changeOrientation=pageView.rotation%180!=0,pageWidth=(changeOrientation?pageView.height:pageView.width)/pageView.scale/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,pageHeight=(changeOrientation?pageView.width:pageView.height)/pageView.scale/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS;let scale=0;switch(destArray[1].name){case"XYZ":x=destArray[2],y=destArray[3],scale=destArray[4],x=null!==x?x:0,y=null!==y?y:pageHeight;break;case"Fit":case"FitB":scale="page-fit";break;case"FitH":case"FitBH":y=destArray[2],scale="page-width",null===y&&this._location?(x=this._location.left,y=this._location.top):("number"!=typeof y||y<0)&&(y=pageHeight);break;case"FitV":case"FitBV":x=destArray[2],width=pageWidth,height=pageHeight,scale="page-height";break;case"FitR":x=destArray[2],y=destArray[3],width=destArray[4]-x,height=destArray[5]-y,widthScale=(this.container.clientWidth-(this.removePageBorders?0:_ui_utils.SCROLLBAR_PADDING))/width/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,heightScale=(this.container.clientHeight-(this.removePageBorders?0:_ui_utils.VERTICAL_PADDING))/height/_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,scale=Math.min(Math.abs(widthScale),Math.abs(heightScale));break;default:return void console.error(`scrollPageIntoView: "${destArray[1].name}" is not a valid destination type.`)}if(ignoreDestinationZoom||(scale&&scale!==this._currentScale?this.currentScaleValue=scale:this._currentScale===_ui_utils.UNKNOWN_SCALE&&(this.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)),"page-fit"===scale&&!destArray[4])return void this.#scrollIntoView(pageView);const boundingRect=[pageView.viewport.convertToViewportPoint(x,y),pageView.viewport.convertToViewportPoint(x+width,y+height)];let left=Math.min(boundingRect[0][0],boundingRect[1][0]),top=Math.min(boundingRect[0][1],boundingRect[1][1]);allowNegativeOffset||(left=Math.max(left,0),top=Math.max(top,0)),this.#scrollIntoView(pageView,{left,top})}_updateLocation(firstPage){const currentScale=this._currentScale,currentScaleValue=this._currentScaleValue,normalizedScaleValue=parseFloat(currentScaleValue)===currentScale?Math.round(1e4*currentScale)/100:currentScaleValue,pageNumber=firstPage.id,container=this.container,topLeft=this._pages[pageNumber-1].getPagePoint(container.scrollLeft-firstPage.x,container.scrollTop-firstPage.y),intLeft=Math.round(topLeft[0]),intTop=Math.round(topLeft[1]);let pdfOpenParams=`#page=${pageNumber}`;this.isInPresentationMode||(pdfOpenParams+=`&zoom=${normalizedScaleValue},${intLeft},${intTop}`),this._location={pageNumber,scale:normalizedScaleValue,top:intTop,left:intLeft,rotation:this._pagesRotation,pdfOpenParams}}update(){const visible=this._getVisiblePages(),visiblePages=visible.views,numVisiblePages=visiblePages.length;if(0===numVisiblePages)return;const newCacheSize=Math.max(10,2*numVisiblePages+1);this.#buffer.resize(newCacheSize,visible.ids),this.renderingQueue.renderHighestPriority(visible);const isSimpleLayout=this._spreadMode===_ui_utils.SpreadMode.NONE&&(this._scrollMode===_ui_utils.ScrollMode.PAGE||this._scrollMode===_ui_utils.ScrollMode.VERTICAL),currentId=this._currentPageNumber;let stillFullyVisible=!1;for(const page of visiblePages){if(page.percent<100)break;if(page.id===currentId&&isSimpleLayout){stillFullyVisible=!0;break}}this._setCurrentPageNumber(stillFullyVisible?currentId:visiblePages[0].id),this._updateLocation(visible.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(element){return this.container.contains(element)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===_ui_utils.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===_ui_utils.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const views=this._scrollMode===_ui_utils.ScrollMode.PAGE?this.#scrollModePageState.pages:this._pages,horizontal=this._scrollMode===_ui_utils.ScrollMode.HORIZONTAL;return(0,_ui_utils.getVisibleElements)({scrollEl:this.container,views,sortByVisibility:!0,horizontal,rtl:horizontal&&this._isContainerRtl})}isPageVisible(pageNumber){return!!this.pdfDocument&&(Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount?this._getVisiblePages().ids.has(pageNumber):(console.error(`isPageVisible: "${pageNumber}" is not a valid page.`),!1))}isPageCached(pageNumber){return!!this.pdfDocument&&(Number.isInteger(pageNumber)&&pageNumber>0&&pageNumber<=this.pagesCount?this.#buffer.has(this._pages[pageNumber-1]):(console.error(`isPageCached: "${pageNumber}" is not a valid page.`),!1))}cleanup(){for(const pageView of this._pages)pageView.renderingState!==_ui_utils.RenderingStates.FINISHED&&pageView.reset()}_cancelRendering(){for(const pageView of this._pages)pageView.cancelRendering()}#ensurePdfPageLoaded(pageView){var _this5=this;return _asyncToGenerator2(function*(){if(pageView.pdfPage)return pageView.pdfPage;try{const pdfPage=yield _this5.pdfDocument.getPage(pageView.id);return pageView.pdfPage||pageView.setPdfPage(pdfPage),_this5.linkService._cachedPageNumber?.(pdfPage.ref)||_this5.linkService.cachePageRef(pageView.id,pdfPage.ref),pdfPage}catch(reason){return console.error("Unable to get page for page view",reason),null}})()}#getScrollAhead(visible){if(1===visible.first?.id)return!0;if(visible.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case _ui_utils.ScrollMode.PAGE:return this.#scrollModePageState.scrollDown;case _ui_utils.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}#toggleLoadingIconSpinner(visibleIds){for(const id of visibleIds)this._pages[id-1]?.toggleLoadingIconSpinner(!0);for(const pageView of this.#buffer)visibleIds.has(pageView.id)||pageView.toggleLoadingIconSpinner(!1)}forceRendering(currentlyVisiblePages){const visiblePages=currentlyVisiblePages||this._getVisiblePages(),scrollAhead=this.#getScrollAhead(visiblePages),pageView=this.renderingQueue.getHighestPriority(visiblePages,this._pages,scrollAhead,this._spreadMode!==_ui_utils.SpreadMode.NONE&&this._scrollMode!==_ui_utils.ScrollMode.HORIZONTAL);return this.#toggleLoadingIconSpinner(visiblePages.ids),!!pageView&&(this.#ensurePdfPageLoaded(pageView).then(()=>{this.renderingQueue.renderView(pageView)}),!0)}createTextLayerBuilder({textLayerDiv,pageIndex,viewport,enhanceTextSelection=!1,eventBus,highlighter,accessibilityManager=null}){return new _text_layer_builder.TextLayerBuilder({textLayerDiv,eventBus,pageIndex,viewport,enhanceTextSelection:!this.isInPresentationMode&&enhanceTextSelection,highlighter,accessibilityManager})}createTextHighlighter({pageIndex,eventBus}){return new _text_highlighter.TextHighlighter({eventBus,pageIndex,findController:this.isInPresentationMode?null:this.findController})}createAnnotationLayerBuilder({pageDiv,pdfPage,annotationStorage=this.pdfDocument?.annotationStorage,imageResourcesPath="",renderForms=!0,l10n=_l10n_utils.NullL10n,enableScripting=this.enableScripting,hasJSActionsPromise=this.pdfDocument?.hasJSActions(),mouseState=this._scriptingManager?.mouseState,fieldObjectsPromise=this.pdfDocument?.getFieldObjects(),annotationCanvasMap=null,accessibilityManager=null}){return new _annotation_layer_builder.AnnotationLayerBuilder({pageDiv,pdfPage,annotationStorage,imageResourcesPath,renderForms,linkService:this.linkService,downloadManager:this.downloadManager,l10n,enableScripting,hasJSActionsPromise,mouseState,fieldObjectsPromise,annotationCanvasMap,accessibilityManager})}createAnnotationEditorLayerBuilder({uiManager=this.#annotationEditorUIManager,pageDiv,pdfPage,accessibilityManager=null,l10n,annotationStorage=this.pdfDocument?.annotationStorage}){return new _annotation_editor_layer_builder.AnnotationEditorLayerBuilder({uiManager,pageDiv,pdfPage,annotationStorage,accessibilityManager,l10n})}createXfaLayerBuilder({pageDiv,pdfPage,annotationStorage=this.pdfDocument?.annotationStorage}){return new _xfa_layer_builder.XfaLayerBuilder({pageDiv,pdfPage,annotationStorage,linkService:this.linkService})}createStructTreeLayerBuilder({pdfPage}){return new _struct_tree_layer_builder.StructTreeLayerBuilder({pdfPage})}get hasEqualPageSizes(){const firstPageView=this._pages[0];for(let i=1,ii=this._pages.length;i<ii;++i){const pageView=this._pages[i];if(pageView.width!==firstPageView.width||pageView.height!==firstPageView.height)return!1}return!0}getPagesOverview(){return this._pages.map(pageView=>{const viewport=pageView.pdfPage.getViewport({scale:1});return!this.enablePrintAutoRotate||(0,_ui_utils.isPortraitOrientation)(viewport)?{width:viewport.width,height:viewport.height,rotation:viewport.rotation}:{width:viewport.height,height:viewport.width,rotation:(viewport.rotation-90)%360}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(promise){if(!(promise instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${promise}`);if(!this.pdfDocument||!this._optionalContentConfigPromise)return;this._optionalContentConfigPromise=promise;const updateArgs={optionalContentConfigPromise:promise};for(const pageView of this._pages)pageView.update(updateArgs);this.update(),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise})}get scrollMode(){return this._scrollMode}set scrollMode(mode){if(this._scrollMode!==mode){if(!(0,_ui_utils.isValidScrollMode)(mode))throw new Error(`Invalid scroll mode: ${mode}`);this.pagesCount>PagesCountLimit.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=mode,this.eventBus.dispatch("scrollmodechanged",{source:this,mode}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(pageNumber=null){const scrollMode=this._scrollMode,viewer=this.viewer;viewer.classList.toggle("scrollHorizontal",scrollMode===_ui_utils.ScrollMode.HORIZONTAL),viewer.classList.toggle("scrollWrapped",scrollMode===_ui_utils.ScrollMode.WRAPPED),this.pdfDocument&&pageNumber&&(scrollMode===_ui_utils.ScrollMode.PAGE?this.#ensurePageViewVisible():this._previousScrollMode===_ui_utils.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(pageNumber,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(mode){if(this._spreadMode!==mode){if(!(0,_ui_utils.isValidSpreadMode)(mode))throw new Error(`Invalid spread mode: ${mode}`);this._spreadMode=mode,this.eventBus.dispatch("spreadmodechanged",{source:this,mode}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(pageNumber=null){if(!this.pdfDocument)return;const viewer=this.viewer,pages=this._pages;if(this._scrollMode===_ui_utils.ScrollMode.PAGE)this.#ensurePageViewVisible();else if(viewer.textContent="",this._spreadMode===_ui_utils.SpreadMode.NONE)for(const pageView of this._pages)viewer.append(pageView.div);else{const parity=this._spreadMode-1;let spread=null;for(let i=0,ii=pages.length;i<ii;++i)null===spread?(spread=document.createElement("div"),spread.className="spread",viewer.append(spread)):i%2===parity&&(spread=spread.cloneNode(!1),viewer.append(spread)),spread.append(pages[i].div)}pageNumber&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this._setScale(this._currentScaleValue,!0),this._setCurrentPageNumber(pageNumber,!0),this.update())}_getPageAdvance(currentPageNumber,previous=!1){switch(this._scrollMode){case _ui_utils.ScrollMode.WRAPPED:{const{views}=this._getVisiblePages(),pageLayout=new Map;for(const{id,y,percent,widthPercent}of views){if(0===percent||widthPercent<100)continue;let yArray=pageLayout.get(y);yArray||pageLayout.set(y,yArray||=[]),yArray.push(id)}for(const yArray of pageLayout.values()){const currentIndex=yArray.indexOf(currentPageNumber);if(-1===currentIndex)continue;const numPages=yArray.length;if(1===numPages)break;if(previous)for(let i=currentIndex-1,ii=0;i>=ii;i--){const expectedId=yArray[i+1]-1;if(yArray[i]<expectedId)return currentPageNumber-expectedId}else for(let i=currentIndex+1,ii=numPages;i<ii;i++){const expectedId=yArray[i-1]+1;if(yArray[i]>expectedId)return expectedId-currentPageNumber}if(previous){const firstId=yArray[0];if(firstId<currentPageNumber)return currentPageNumber-firstId+1}else{const lastId=yArray[numPages-1];if(lastId>currentPageNumber)return lastId-currentPageNumber+1}break}break}case _ui_utils.ScrollMode.HORIZONTAL:break;case _ui_utils.ScrollMode.PAGE:case _ui_utils.ScrollMode.VERTICAL:{if(this._spreadMode===_ui_utils.SpreadMode.NONE)break;const parity=this._spreadMode-1;if(previous&&currentPageNumber%2!==parity)break;if(!previous&&currentPageNumber%2===parity)break;const{views}=this._getVisiblePages(),expectedId=previous?currentPageNumber-1:currentPageNumber+1;for(const{id,percent,widthPercent}of views)if(id===expectedId){if(percent>0&&100===widthPercent)return 2;break}break}}return 1}nextPage(){const currentPageNumber=this._currentPageNumber,pagesCount=this.pagesCount;if(currentPageNumber>=pagesCount)return!1;const advance=this._getPageAdvance(currentPageNumber,!1)||1;return this.currentPageNumber=Math.min(currentPageNumber+advance,pagesCount),!0}previousPage(){const currentPageNumber=this._currentPageNumber;if(currentPageNumber<=1)return!1;const advance=this._getPageAdvance(currentPageNumber,!0)||1;return this.currentPageNumber=Math.max(currentPageNumber-advance,1),!0}increaseScale(steps=1){let newScale=this._currentScale;do{newScale=(newScale*_ui_utils.DEFAULT_SCALE_DELTA).toFixed(2),newScale=Math.ceil(10*newScale)/10,newScale=Math.min(_ui_utils.MAX_SCALE,newScale)}while(--steps>0&&newScale<_ui_utils.MAX_SCALE);this.currentScaleValue=newScale}decreaseScale(steps=1){let newScale=this._currentScale;do{newScale=(newScale/_ui_utils.DEFAULT_SCALE_DELTA).toFixed(2),newScale=Math.floor(10*newScale)/10,newScale=Math.max(_ui_utils.MIN_SCALE,newScale)}while(--steps>0&&newScale>_ui_utils.MIN_SCALE);this.currentScaleValue=newScale}updateContainerHeightCss(){const height=this.container.clientHeight;height!==this.#previousContainerHeight&&(this.#previousContainerHeight=height,_ui_utils.docStyle.setProperty("--viewer-container-height",`${height}px`))}get annotationEditorMode(){return this.#annotationEditorUIManager?this.#annotationEditorMode:_pdfjsLib.AnnotationEditorType.DISABLE}set annotationEditorMode(mode){if(!this.#annotationEditorUIManager)throw new Error("The AnnotationEditor is not enabled.");if(this.#annotationEditorMode!==mode){if(!isValidAnnotationEditorMode(mode))throw new Error(`Invalid AnnotationEditor mode: ${mode}`);this.pdfDocument&&(this.#annotationEditorMode=mode,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode}),this.#annotationEditorUIManager.updateMode(mode))}}set annotationEditorParams({type,value}){if(!this.#annotationEditorUIManager)throw new Error("The AnnotationEditor is not enabled.");this.#annotationEditorUIManager.updateParams(type,value)}refresh(){if(!this.pdfDocument)return;const updateArgs={};for(const pageView of this._pages)pageView.update(updateArgs);this.update()}}exports2.BaseViewer=BaseViewer},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFPageView=void 0;var _pdfjsLib=__w_pdfjs_require__3(3),_ui_utils=__w_pdfjs_require__3(7),_app_options=__w_pdfjs_require__3(14),_l10n_utils=__w_pdfjs_require__3(4),_text_accessibility=__w_pdfjs_require__3(15);const MAX_CANVAS_PIXELS=_app_options.compatibilityParams.maxCanvasPixels||16777216;exports2.PDFPageView=class PDFPageView{#annotationMode=_pdfjsLib.AnnotationMode.ENABLE_FORMS;#useThumbnailCanvas={initialOptionalContent:!0,regularAnnotations:!0};constructor(options){const container=options.container,defaultViewport=options.defaultViewport;this.id=options.id,this.renderingId="page"+this.id,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=options.scale||_ui_utils.DEFAULT_SCALE,this.viewport=defaultViewport,this.pdfPageRotate=defaultViewport.rotation,this._optionalContentConfigPromise=options.optionalContentConfigPromise||null,this.hasRestrictedScaling=!1,this.textLayerMode=options.textLayerMode??_ui_utils.TextLayerMode.ENABLE,this.#annotationMode=options.annotationMode??_pdfjsLib.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=options.imageResourcesPath||"",this.useOnlyCssZoom=options.useOnlyCssZoom||!1,this.maxCanvasPixels=options.maxCanvasPixels||MAX_CANVAS_PIXELS,this.pageColors=options.pageColors||null,this.eventBus=options.eventBus,this.renderingQueue=options.renderingQueue,this.textLayerFactory=options.textLayerFactory,this.annotationLayerFactory=options.annotationLayerFactory,this.annotationEditorLayerFactory=options.annotationEditorLayerFactory,this.xfaLayerFactory=options.xfaLayerFactory,this.textHighlighter=options.textHighlighterFactory?.createTextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus}),this.structTreeLayerFactory=options.structTreeLayerFactory,this.renderer=options.renderer||_ui_utils.RendererType.CANVAS,this.l10n=options.l10n||_l10n_utils.NullL10n,this.paintTask=null,this.paintedViewportMap=new WeakMap,this.renderingState=_ui_utils.RenderingStates.INITIAL,this.resume=null,this._renderError=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const div=document.createElement("div");if(div.className="page",div.style.width=Math.floor(this.viewport.width)+"px",div.style.height=Math.floor(this.viewport.height)+"px",div.setAttribute("data-page-number",this.id),div.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then(msg=>{div.setAttribute("aria-label",msg)}),this.div=div,container?.append(div),this._isStandalone){const{optionalContentConfigPromise}=options;optionalContentConfigPromise&&optionalContentConfigPromise.then(optionalContentConfig=>{optionalContentConfigPromise===this._optionalContentConfigPromise&&(this.#useThumbnailCanvas.initialOptionalContent=optionalContentConfig.hasInitialVisibility)})}}setPdfPage(pdfPage){this.pdfPage=pdfPage,this.pdfPageRotate=pdfPage.rotate,this.viewport=pdfPage.getViewport({scale:this.scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),this.reset()}destroy(){this.reset(),this.pdfPage&&this.pdfPage.cleanup()}_renderAnnotationLayer(){var _this6=this;return _asyncToGenerator2(function*(){let error=null;try{yield _this6.annotationLayer.render(_this6.viewport,"display")}catch(ex){console.error(`_renderAnnotationLayer: "${ex}".`),error=ex}finally{_this6.eventBus.dispatch("annotationlayerrendered",{source:_this6,pageNumber:_this6.id,error})}})()}_renderAnnotationEditorLayer(){var _this7=this;return _asyncToGenerator2(function*(){let error=null;try{yield _this7.annotationEditorLayer.render(_this7.viewport,"display")}catch(ex){console.error(`_renderAnnotationEditorLayer: "${ex}".`),error=ex}finally{_this7.eventBus.dispatch("annotationeditorlayerrendered",{source:_this7,pageNumber:_this7.id,error})}})()}_renderXfaLayer(){var _this8=this;return _asyncToGenerator2(function*(){let error=null;try{const result=yield _this8.xfaLayer.render(_this8.viewport,"display");_this8.textHighlighter&&_this8._buildXfaTextContentItems(result.textDivs)}catch(ex){console.error(`_renderXfaLayer: "${ex}".`),error=ex}finally{_this8.eventBus.dispatch("xfalayerrendered",{source:_this8,pageNumber:_this8.id,error})}})()}_buildXfaTextContentItems(textDivs){var _this9=this;return _asyncToGenerator2(function*(){const text=yield _this9.pdfPage.getTextContent(),items=[];for(const item of text.items)items.push(item.str);_this9.textHighlighter.setTextMapping(textDivs,items),_this9.textHighlighter.enable()})()}_resetZoomLayer(removeFromDOM=!1){if(!this.zoomLayer)return;const zoomLayerCanvas=this.zoomLayer.firstChild;this.paintedViewportMap.delete(zoomLayerCanvas),zoomLayerCanvas.width=0,zoomLayerCanvas.height=0,removeFromDOM&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer=!1,keepAnnotationLayer=!1,keepAnnotationEditorLayer=!1,keepXfaLayer=!1}={}){this.cancelRendering({keepAnnotationLayer,keepAnnotationEditorLayer,keepXfaLayer}),this.renderingState=_ui_utils.RenderingStates.INITIAL;const div=this.div;div.style.width=Math.floor(this.viewport.width)+"px",div.style.height=Math.floor(this.viewport.height)+"px";const childNodes=div.childNodes,zoomLayerNode=keepZoomLayer&&this.zoomLayer||null,annotationLayerNode=keepAnnotationLayer&&this.annotationLayer?.div||null,annotationEditorLayerNode=keepAnnotationEditorLayer&&this.annotationEditorLayer?.div||null,xfaLayerNode=keepXfaLayer&&this.xfaLayer?.div||null;for(let i=childNodes.length-1;i>=0;i--){const node=childNodes[i];switch(node){case zoomLayerNode:case annotationLayerNode:case annotationEditorLayerNode:case xfaLayerNode:continue}node.remove()}div.removeAttribute("data-loaded"),annotationLayerNode&&this.annotationLayer.hide(),annotationEditorLayerNode?this.annotationEditorLayer.hide():this.annotationEditorLayer?.destroy(),xfaLayerNode&&this.xfaLayer.hide(),zoomLayerNode||(this.canvas&&(this.paintedViewportMap.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer()),this.svg&&(this.paintedViewportMap.delete(this.svg),delete this.svg),this.loadingIconDiv=document.createElement("div"),this.loadingIconDiv.className="loadingIcon notVisible",this._isStandalone&&this.toggleLoadingIconSpinner(!0),this.loadingIconDiv.setAttribute("role","img"),this.l10n.get("loading").then(msg=>{this.loadingIconDiv?.setAttribute("aria-label",msg)}),div.append(this.loadingIconDiv)}update({scale=0,rotation=null,optionalContentConfigPromise=null}){if(this.scale=scale||this.scale,"number"==typeof rotation&&(this.rotation=rotation),optionalContentConfigPromise instanceof Promise&&(this._optionalContentConfigPromise=optionalContentConfigPromise,optionalContentConfigPromise.then(optionalContentConfig=>{optionalContentConfigPromise===this._optionalContentConfigPromise&&(this.#useThumbnailCanvas.initialOptionalContent=optionalContentConfig.hasInitialVisibility)})),this.viewport=this.viewport.clone({scale:this.scale*_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),this._isStandalone&&_ui_utils.docStyle.setProperty("--scale-factor",this.viewport.scale),this.svg)return this.cssTransform({target:this.svg,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});let isScalingRestricted=!1;if(this.canvas&&this.maxCanvasPixels>0){const outputScale=this.outputScale;(Math.floor(this.viewport.width)*outputScale.sx|0)*(Math.floor(this.viewport.height)*outputScale.sy|0)>this.maxCanvasPixels&&(isScalingRestricted=!0)}if(this.canvas){if(this.useOnlyCssZoom||this.hasRestrictedScaling&&isScalingRestricted)return this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0}),void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this._renderError});!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0})}cancelRendering({keepAnnotationLayer=!1,keepAnnotationEditorLayer=!1,keepXfaLayer=!1}={}){this.paintTask&&(this.paintTask.cancel(),this.paintTask=null),this.resume=null,this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!keepAnnotationLayer||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!keepAnnotationEditorLayer||!this.annotationEditorLayer.div)&&(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!keepXfaLayer||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this.textHighlighter?.disable()),this._onTextLayerRendered&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null)}cssTransform({target,redrawAnnotationLayer=!1,redrawAnnotationEditorLayer=!1,redrawXfaLayer=!1}){const width=this.viewport.width,height=this.viewport.height,div=this.div;target.style.width=target.parentNode.style.width=div.style.width=Math.floor(width)+"px",target.style.height=target.parentNode.style.height=div.style.height=Math.floor(height)+"px";const relativeRotation=this.viewport.rotation-this.paintedViewportMap.get(target).rotation,absRotation=Math.abs(relativeRotation);let scaleX=1,scaleY=1;if((90===absRotation||270===absRotation)&&(scaleX=height/width,scaleY=width/height),target.style.transform=`rotate(${relativeRotation}deg) scale(${scaleX}, ${scaleY})`,this.textLayer){const textLayerViewport=this.textLayer.viewport,textAbsRotation=Math.abs(this.viewport.rotation-textLayerViewport.rotation);let scale=width/textLayerViewport.width;(90===textAbsRotation||270===textAbsRotation)&&(scale=width/textLayerViewport.height);const textLayerDiv=this.textLayer.textLayerDiv;let transX,transY;switch(textAbsRotation){case 0:transX=transY=0;break;case 90:transX=0,transY="-"+textLayerDiv.style.height;break;case 180:transX="-"+textLayerDiv.style.width,transY="-"+textLayerDiv.style.height;break;case 270:transX="-"+textLayerDiv.style.width,transY=0;break;default:console.error("Bad rotation value.")}textLayerDiv.style.transform=`rotate(${textAbsRotation}deg) scale(${scale}) translate(${transX}, ${transY})`,textLayerDiv.style.transformOrigin="0% 0%"}redrawAnnotationLayer&&this.annotationLayer&&this._renderAnnotationLayer(),redrawAnnotationEditorLayer&&this.annotationEditorLayer&&this._renderAnnotationEditorLayer(),redrawXfaLayer&&this.xfaLayer&&this._renderXfaLayer()}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(x,y){return this.viewport.convertToPdfPoint(x,y)}toggleLoadingIconSpinner(viewVisible=!1){this.loadingIconDiv?.classList.toggle("notVisible",!viewVisible)}draw(){var _this10=this;this.renderingState!==_ui_utils.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div,pdfPage}=this;if(!pdfPage)return this.renderingState=_ui_utils.RenderingStates.FINISHED,this.loadingIconDiv&&(this.loadingIconDiv.remove(),delete this.loadingIconDiv),Promise.reject(new Error("pdfPage is not loaded"));this.renderingState=_ui_utils.RenderingStates.RUNNING;const canvasWrapper=document.createElement("div");canvasWrapper.style.width=div.style.width,canvasWrapper.style.height=div.style.height,canvasWrapper.classList.add("canvasWrapper");const lastDivBeforeTextDiv=this.annotationLayer?.div||this.annotationEditorLayer?.div;lastDivBeforeTextDiv?lastDivBeforeTextDiv.before(canvasWrapper):div.append(canvasWrapper);let textLayer=null;if(this.textLayerMode!==_ui_utils.TextLayerMode.DISABLE&&this.textLayerFactory){this._accessibilityManager||=new _text_accessibility.TextAccessibilityManager;const textLayerDiv=document.createElement("div");textLayerDiv.className="textLayer",textLayerDiv.style.width=canvasWrapper.style.width,textLayerDiv.style.height=canvasWrapper.style.height,lastDivBeforeTextDiv?lastDivBeforeTextDiv.before(textLayerDiv):div.append(textLayerDiv),textLayer=this.textLayerFactory.createTextLayerBuilder({textLayerDiv,pageIndex:this.id-1,viewport:this.viewport,enhanceTextSelection:this.textLayerMode===_ui_utils.TextLayerMode.ENABLE_ENHANCE,eventBus:this.eventBus,highlighter:this.textHighlighter,accessibilityManager:this._accessibilityManager})}this.textLayer=textLayer,this.#annotationMode!==_pdfjsLib.AnnotationMode.DISABLE&&this.annotationLayerFactory&&(this._annotationCanvasMap||=new Map,this.annotationLayer||=this.annotationLayerFactory.createAnnotationLayerBuilder({pageDiv:div,pdfPage,imageResourcesPath:this.imageResourcesPath,renderForms:this.#annotationMode===_pdfjsLib.AnnotationMode.ENABLE_FORMS,l10n:this.l10n,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})),this.xfaLayer?.div&&div.append(this.xfaLayer.div);let renderContinueCallback=null;this.renderingQueue&&(renderContinueCallback=cont=>{if(!this.renderingQueue.isHighestPriority(this))return this.renderingState=_ui_utils.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=_ui_utils.RenderingStates.RUNNING,cont()});cont()});const finishPaintTask=function(){var _ref22=_asyncToGenerator2(function*(error=null){if(paintTask===_this10.paintTask&&(_this10.paintTask=null),error instanceof _pdfjsLib.RenderingCancelledException)_this10._renderError=null;else if(_this10._renderError=error,_this10.renderingState=_ui_utils.RenderingStates.FINISHED,_this10.loadingIconDiv&&(_this10.loadingIconDiv.remove(),delete _this10.loadingIconDiv),_this10._resetZoomLayer(!0),_this10.#useThumbnailCanvas.regularAnnotations=!paintTask.separateAnnots,_this10.eventBus.dispatch("pagerendered",{source:_this10,pageNumber:_this10.id,cssTransform:!1,timestamp:performance.now(),error:_this10._renderError}),error)throw error});return function(){return _ref22.apply(this,arguments)}}(),paintTask=this.renderer===_ui_utils.RendererType.SVG?this.paintOnSvg(canvasWrapper):this.paintOnCanvas(canvasWrapper);paintTask.onRenderContinue=renderContinueCallback,this.paintTask=paintTask;const resultPromise=paintTask.promise.then(()=>finishPaintTask(null).then(()=>{if(textLayer){const readableStream=pdfPage.streamTextContent({includeMarkedContent:!0});textLayer.setTextContentStream(readableStream),textLayer.render()}this.annotationLayer&&this._renderAnnotationLayer().then(()=>{this.annotationEditorLayerFactory&&(this.annotationEditorLayer||=this.annotationEditorLayerFactory.createAnnotationEditorLayerBuilder({pageDiv:div,pdfPage,l10n:this.l10n,accessibilityManager:this._accessibilityManager}),this._renderAnnotationEditorLayer())})}),function(reason){return finishPaintTask(reason)});return this.xfaLayerFactory&&(this.xfaLayer||=this.xfaLayerFactory.createXfaLayerBuilder({pageDiv:div,pdfPage}),this._renderXfaLayer()),this.structTreeLayerFactory&&this.textLayer&&this.canvas&&(this._onTextLayerRendered=event=>{event.pageNumber===this.id&&(this.eventBus._off("textlayerrendered",this._onTextLayerRendered),this._onTextLayerRendered=null,this.canvas&&this.pdfPage.getStructTree().then(tree=>{if(!tree||!this.canvas)return;const treeDom=this.structTreeLayer.render(tree);treeDom.classList.add("structTree"),this.canvas.append(treeDom)}))},this.eventBus._on("textlayerrendered",this._onTextLayerRendered),this.structTreeLayer=this.structTreeLayerFactory.createStructTreeLayerBuilder({pdfPage})),div.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),resultPromise}paintOnCanvas(canvasWrapper){const renderCapability=(0,_pdfjsLib.createPromiseCapability)(),result={promise:renderCapability.promise,onRenderContinue(cont){cont()},cancel(){renderTask.cancel()},get separateAnnots(){return renderTask.separateAnnots}},viewport=this.viewport,canvas=document.createElement("canvas");canvas.setAttribute("role","presentation"),canvas.hidden=!0;let isCanvasHidden=!0;const showCanvas=function(){isCanvasHidden&&(canvas.hidden=!1,isCanvasHidden=!1)};canvasWrapper.append(canvas),this.canvas=canvas;const ctx=canvas.getContext("2d",{alpha:!1}),outputScale=this.outputScale=new _ui_utils.OutputScale;if(this.useOnlyCssZoom){const actualSizeViewport=viewport.clone({scale:_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS});outputScale.sx*=actualSizeViewport.width/viewport.width,outputScale.sy*=actualSizeViewport.height/viewport.height}if(this.maxCanvasPixels>0){const maxScale=Math.sqrt(this.maxCanvasPixels/(viewport.width*viewport.height));outputScale.sx>maxScale||outputScale.sy>maxScale?(outputScale.sx=maxScale,outputScale.sy=maxScale,this.hasRestrictedScaling=!0):this.hasRestrictedScaling=!1}const sfx=(0,_ui_utils.approximateFraction)(outputScale.sx),sfy=(0,_ui_utils.approximateFraction)(outputScale.sy);canvas.width=(0,_ui_utils.roundToDivide)(viewport.width*outputScale.sx,sfx[0]),canvas.height=(0,_ui_utils.roundToDivide)(viewport.height*outputScale.sy,sfy[0]),canvas.style.width=(0,_ui_utils.roundToDivide)(viewport.width,sfx[1])+"px",canvas.style.height=(0,_ui_utils.roundToDivide)(viewport.height,sfy[1])+"px",this.paintedViewportMap.set(canvas,viewport);const renderContext={canvasContext:ctx,transform:outputScale.scaled?[outputScale.sx,0,0,outputScale.sy,0,0]:null,viewport:this.viewport,annotationMode:this.#annotationMode,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors},renderTask=this.pdfPage.render(renderContext);return renderTask.onContinue=function(cont){showCanvas(),result.onRenderContinue?result.onRenderContinue(cont):cont()},renderTask.promise.then(function(){showCanvas(),renderCapability.resolve()},function(error){showCanvas(),renderCapability.reject(error)}),result}paintOnSvg(wrapper){let cancelled=!1;const ensureNotCancelled=()=>{if(cancelled)throw new _pdfjsLib.RenderingCancelledException(`Rendering cancelled, page ${this.id}`,"svg")},pdfPage=this.pdfPage,actualSizeViewport=this.viewport.clone({scale:_pdfjsLib.PixelsPerInch.PDF_TO_CSS_UNITS});return{promise:pdfPage.getOperatorList({annotationMode:this.#annotationMode}).then(opList=>(ensureNotCancelled(),new _pdfjsLib.SVGGraphics(pdfPage.commonObjs,pdfPage.objs).getSVG(opList,actualSizeViewport).then(svg=>{ensureNotCancelled(),this.svg=svg,this.paintedViewportMap.set(svg,actualSizeViewport),svg.style.width=wrapper.style.width,svg.style.height=wrapper.style.height,this.renderingState=_ui_utils.RenderingStates.FINISHED,wrapper.append(svg)}))),onRenderContinue(cont){cont()},cancel(){cancelled=!0},get separateAnnots(){return!1}}}setPageLabel(label){this.pageLabel="string"==typeof label?label:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{initialOptionalContent,regularAnnotations}=this.#useThumbnailCanvas;return initialOptionalContent&&regularAnnotations?this.canvas:null}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.compatibilityParams=exports2.OptionKind=exports2.AppOptions=void 0;const compatibilityParams=Object.create(null);exports2.compatibilityParams=compatibilityParams;{const userAgent=navigator.userAgent||"",platform=navigator.platform||"",maxTouchPoints=navigator.maxTouchPoints||1,isAndroid=/Android/.test(userAgent);(/\b(iPad|iPhone|iPod)(?=;)/.test(userAgent)||"MacIntel"===platform&&maxTouchPoints>1||isAndroid)&&(compatibilityParams.maxCanvasPixels=5242880)}const OptionKind={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};exports2.OptionKind=OptionKind;const defaultOptions={annotationEditorMode:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},annotationMode:{value:2,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cursorToolOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},defaultZoomValue:{value:"",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},disableHistory:{value:!1,kind:OptionKind.VIEWER},disablePageLabels:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePermissions:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},enableScripting:{value:!0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:OptionKind.VIEWER},externalLinkTarget:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},historyUpdateUrl:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},imageResourcesPath:{value:"./images/",kind:OptionKind.VIEWER},maxCanvasPixels:{value:16777216,kind:OptionKind.VIEWER},forcePageColors:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},pdfBugEnabled:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},printResolution:{value:150,kind:OptionKind.VIEWER},sidebarViewOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},scrollModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},spreadModeOnLoad:{value:-1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},textLayerMode:{value:1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},useOnlyCssZoom:{value:!1,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewerCssTheme:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},viewOnLoad:{value:0,kind:OptionKind.VIEWER+OptionKind.PREFERENCE},cMapPacked:{value:!0,kind:OptionKind.API},cMapUrl:{value:"../web/cmaps/",kind:OptionKind.API},disableAutoFetch:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableFontFace:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableRange:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},disableStream:{value:!1,kind:OptionKind.API+OptionKind.PREFERENCE},docBaseUrl:{value:"",kind:OptionKind.API},enableXfa:{value:!0,kind:OptionKind.API+OptionKind.PREFERENCE},fontExtraProperties:{value:!1,kind:OptionKind.API},isEvalSupported:{value:!0,kind:OptionKind.API},maxImageSize:{value:-1,kind:OptionKind.API},pdfBug:{value:!1,kind:OptionKind.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:OptionKind.API},verbosity:{value:1,kind:OptionKind.API},workerPort:{value:null,kind:OptionKind.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:OptionKind.WORKER}};defaultOptions.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:OptionKind.VIEWER},defaultOptions.disablePreferences={value:!1,kind:OptionKind.VIEWER},defaultOptions.locale={value:navigator.language||"en-US",kind:OptionKind.VIEWER},defaultOptions.renderer={value:"canvas",kind:OptionKind.VIEWER+OptionKind.PREFERENCE},defaultOptions.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:OptionKind.VIEWER};const userOptions=Object.create(null);exports2.AppOptions=class AppOptions{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(name){const userOption=userOptions[name];if(void 0!==userOption)return userOption;const defaultOption=defaultOptions[name];return void 0!==defaultOption?compatibilityParams[name]??defaultOption.value:void 0}static getAll(kind=null){const options=Object.create(null);for(const name in defaultOptions){const defaultOption=defaultOptions[name];if(kind){if(!(kind&defaultOption.kind))continue;if(kind===OptionKind.PREFERENCE){const value=defaultOption.value,valueType=typeof value;if("boolean"===valueType||"string"===valueType||"number"===valueType&&Number.isInteger(value)){options[name]=value;continue}throw new Error(`Invalid type for preference: ${name}`)}}const userOption=userOptions[name];options[name]=void 0!==userOption?userOption:compatibilityParams[name]??defaultOption.value}return options}static set(name,value){userOptions[name]=value}static setAll(options){for(const name in options)userOptions[name]=options[name]}static remove(name){delete userOptions[name]}static _hasUserOptions(){return Object.keys(userOptions).length>0}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.TextAccessibilityManager=void 0;var _ui_utils=__w_pdfjs_require__3(7);class TextAccessibilityManager{#enabled=!1;#textChildren=null;#textNodes=new Map;#waitingElements=new Map;setTextMapping(textDivs){this.#textChildren=textDivs}static#compareElementPositions(e1,e2){const rect1=e1.getBoundingClientRect(),rect2=e2.getBoundingClientRect();if(0===rect1.width&&0===rect1.height)return 1;if(0===rect2.width&&0===rect2.height)return-1;const mid1=rect1.y+rect1.height/2,mid2=rect2.y+rect2.height/2;return mid1<=rect2.y&&mid2>=rect1.y+rect1.height?-1:mid2<=rect1.y&&mid1>=rect2.y+rect2.height?1:rect1.x+rect1.width/2-(rect2.x+rect2.width/2)}enable(){if(this.#enabled)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#textChildren)throw new Error("Text divs and strings have not been set.");if(this.#enabled=!0,this.#textChildren=this.#textChildren.slice(),this.#textChildren.sort(TextAccessibilityManager.#compareElementPositions),this.#textNodes.size>0){const textChildren=this.#textChildren;for(const[id,nodeIndex]of this.#textNodes)document.getElementById(id)?this.#addIdToAriaOwns(id,textChildren[nodeIndex]):this.#textNodes.delete(id)}for(const[element,isRemovable]of this.#waitingElements)this.addPointerInTextLayer(element,isRemovable);this.#waitingElements.clear()}disable(){this.#enabled&&(this.#waitingElements.clear(),this.#textChildren=null,this.#enabled=!1)}removePointerInTextLayer(element){if(!this.#enabled)return void this.#waitingElements.delete(element);const children=this.#textChildren;if(!children||0===children.length)return;const{id}=element,nodeIndex=this.#textNodes.get(id);if(void 0===nodeIndex)return;const node=children[nodeIndex];this.#textNodes.delete(id);let owns=node.getAttribute("aria-owns");owns?.includes(id)&&(owns=owns.split(" ").filter(x=>x!==id).join(" "),owns?node.setAttribute("aria-owns",owns):(node.removeAttribute("aria-owns"),node.setAttribute("role","presentation")))}#addIdToAriaOwns(id,node){const owns=node.getAttribute("aria-owns");owns?.includes(id)||node.setAttribute("aria-owns",owns?`${owns} ${id}`:id),node.removeAttribute("role")}addPointerInTextLayer(element,isRemovable){const{id}=element;if(!id)return;if(!this.#enabled)return void this.#waitingElements.set(element,isRemovable);isRemovable&&this.removePointerInTextLayer(element);const children=this.#textChildren;if(!children||0===children.length)return;const index=(0,_ui_utils.binarySearchFirstItem)(children,node=>TextAccessibilityManager.#compareElementPositions(element,node)<0),nodeIndex=Math.max(0,index-1);this.#addIdToAriaOwns(id,children[nodeIndex]),this.#textNodes.set(id,nodeIndex)}moveElementInDOM(container,element,contentElement,isRemovable){if(this.addPointerInTextLayer(contentElement,isRemovable),!container.hasChildNodes())return void container.append(element);const children=Array.from(container.childNodes).filter(node=>node!==element);if(0===children.length)return;const elementToCompare=contentElement||element,index=(0,_ui_utils.binarySearchFirstItem)(children,node=>TextAccessibilityManager.#compareElementPositions(elementToCompare,node)<0);0===index?children[0].before(element):children[index-1].after(element)}}exports2.TextAccessibilityManager=TextAccessibilityManager},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFRenderingQueue=void 0;var _pdfjsLib=__w_pdfjs_require__3(3),_ui_utils=__w_pdfjs_require__3(7);exports2.PDFRenderingQueue=class PDFRenderingQueue{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1}setViewer(pdfViewer){this.pdfViewer=pdfViewer}setThumbnailViewer(pdfThumbnailViewer){this.pdfThumbnailViewer=pdfThumbnailViewer}isHighestPriority(view){return this.highestPriorityPage===view.renderingId}hasViewer(){return!!this.pdfViewer}renderHighestPriority(currentlyVisiblePages){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(currentlyVisiblePages)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4)))}getHighestPriority(visible,views,scrolledDown,preRenderExtra=!1){const visibleViews=visible.views,numVisible=visibleViews.length;if(0===numVisible)return null;for(let i=0;i<numVisible;i++){const view=visibleViews[i].view;if(!this.isViewFinished(view))return view}const firstId=visible.first.id,lastId=visible.last.id;if(lastId-firstId+1>numVisible){const visibleIds=visible.ids;for(let i=1,ii=lastId-firstId;i<ii;i++){const holeId=scrolledDown?firstId+i:lastId-i;if(visibleIds.has(holeId))continue;const holeView=views[holeId-1];if(!this.isViewFinished(holeView))return holeView}}let preRenderIndex=scrolledDown?lastId:firstId-2,preRenderView=views[preRenderIndex];return preRenderView&&!this.isViewFinished(preRenderView)||preRenderExtra&&(preRenderIndex+=scrolledDown?1:-1,preRenderView=views[preRenderIndex],preRenderView&&!this.isViewFinished(preRenderView))?preRenderView:null}isViewFinished(view){return view.renderingState===_ui_utils.RenderingStates.FINISHED}renderView(view){switch(view.renderingState){case _ui_utils.RenderingStates.FINISHED:return!1;case _ui_utils.RenderingStates.PAUSED:this.highestPriorityPage=view.renderingId,view.resume();break;case _ui_utils.RenderingStates.RUNNING:this.highestPriorityPage=view.renderingId;break;case _ui_utils.RenderingStates.INITIAL:this.highestPriorityPage=view.renderingId,view.draw().finally(()=>{this.renderHighestPriority()}).catch(reason=>{reason instanceof _pdfjsLib.RenderingCancelledException||console.error(`renderView: "${reason}"`)})}return!0}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.TextHighlighter=void 0,exports2.TextHighlighter=class TextHighlighter{constructor({findController,eventBus,pageIndex}){this.findController=findController,this.matches=[],this.eventBus=eventBus,this.pageIdx=pageIndex,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(divs,texts){this.textDivs=divs,this.textContentItemsStr=texts}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=evt=>{(evt.pageIndex===this.pageIdx||-1===evt.pageIndex)&&this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null))}_convertMatches(matches,matchesLength){if(!matches)return[];const{textContentItemsStr}=this;let i=0,iIndex=0;const end=textContentItemsStr.length-1,result=[];for(let m=0,mm=matches.length;m<mm;m++){let matchIdx=matches[m];for(;i!==end&&matchIdx>=iIndex+textContentItemsStr[i].length;)iIndex+=textContentItemsStr[i].length,i++;i===textContentItemsStr.length&&console.error("Could not find a matching mapping");const match={begin:{divIdx:i,offset:matchIdx-iIndex}};for(matchIdx+=matchesLength[m];i!==end&&matchIdx>iIndex+textContentItemsStr[i].length;)iIndex+=textContentItemsStr[i].length,i++;match.end={divIdx:i,offset:matchIdx-iIndex},result.push(match)}return result}_renderMatches(matches){if(0===matches.length)return;const{findController,pageIdx}=this,{textContentItemsStr,textDivs}=this,isSelectedPage=pageIdx===findController.selected.pageIdx,selectedMatchIdx=findController.selected.matchIdx;let prevEnd=null;function beginText(begin,className){const divIdx=begin.divIdx;return textDivs[divIdx].textContent="",appendTextToDiv(divIdx,0,begin.offset,className)}function appendTextToDiv(divIdx,fromOffset,toOffset,className){let div=textDivs[divIdx];if(div.nodeType===Node.TEXT_NODE){const span=document.createElement("span");div.before(span),span.append(div),textDivs[divIdx]=span,div=span}const content=textContentItemsStr[divIdx].substring(fromOffset,toOffset),node=document.createTextNode(content);if(className){const span=document.createElement("span");return span.className=`${className} appended`,span.append(node),div.append(span),className.includes("selected")?span.offsetLeft:0}return div.append(node),0}let i0=selectedMatchIdx,i1=i0+1;if(findController.state.highlightAll)i0=0,i1=matches.length;else if(!isSelectedPage)return;for(let i=i0;i<i1;i++){const match=matches[i],begin=match.begin,end=match.end,isSelected=isSelectedPage&&i===selectedMatchIdx,highlightSuffix=isSelected?" selected":"";let selectedLeft=0;if(prevEnd&&begin.divIdx===prevEnd.divIdx?appendTextToDiv(prevEnd.divIdx,prevEnd.offset,begin.offset):(null!==prevEnd&&appendTextToDiv(prevEnd.divIdx,prevEnd.offset,void 0),beginText(begin)),begin.divIdx===end.divIdx)selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,end.offset,"highlight"+highlightSuffix);else{selectedLeft=appendTextToDiv(begin.divIdx,begin.offset,void 0,"highlight begin"+highlightSuffix);for(let n0=begin.divIdx+1,n1=end.divIdx;n0<n1;n0++)textDivs[n0].className="highlight middle"+highlightSuffix;beginText(end,"highlight end"+highlightSuffix)}prevEnd=end,isSelected&&findController.scrollMatchIntoView({element:textDivs[begin.divIdx],selectedLeft,pageIndex:pageIdx,matchIndex:selectedMatchIdx})}prevEnd&&appendTextToDiv(prevEnd.divIdx,prevEnd.offset,void 0)}_updateMatches(){if(!this.enabled)return;const{findController,matches,pageIdx}=this,{textContentItemsStr,textDivs}=this;let clearedUntilDivIdx=-1;for(let i=0,ii=matches.length;i<ii;i++){const match=matches[i];for(let n=Math.max(clearedUntilDivIdx,match.begin.divIdx),end=match.end.divIdx;n<=end;n++){const div=textDivs[n];div.textContent=textContentItemsStr[n],div.className=""}clearedUntilDivIdx=match.end.divIdx+1}findController?.highlightMatches&&(this.matches=this._convertMatches(findController.pageMatches[pageIdx]||null,findController.pageMatchesLength[pageIdx]||null),this._renderMatches(this.matches))}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.DownloadManager=void 0;var _pdfjsLib=__w_pdfjs_require__3(3);function download(blobUrl,filename){const a=document.createElement("a");if(!a.click)throw new Error('DownloadManager: "a.click()" is not supported.');a.href=blobUrl,a.target="_parent","download"in a&&(a.download=filename),(document.body||document.documentElement).append(a),a.click(),a.remove()}exports2.DownloadManager=class DownloadManager{constructor(){this._openBlobUrls=new WeakMap}downloadUrl(url,filename){(0,_pdfjsLib.createValidAbsoluteUrl)(url,"http://example.com")?download(url+"#pdfjs.action=download",filename):console.error(`downloadUrl - not a valid URL: ${url}`)}downloadData(data,filename,contentType){download(URL.createObjectURL(new Blob([data],{type:contentType})),filename)}openOrDownloadData(element,data,filename){const isPdfData=(0,_pdfjsLib.isPdfFile)(filename),contentType=isPdfData?"application/pdf":"";if(isPdfData){let viewerUrl,blobUrl=this._openBlobUrls.get(element);blobUrl||(blobUrl=URL.createObjectURL(new Blob([data],{type:contentType})),this._openBlobUrls.set(element,blobUrl)),viewerUrl="?file="+encodeURIComponent(blobUrl+"#"+filename);try{return window.open(viewerUrl),!0}catch(ex){console.error(`openOrDownloadData: ${ex}`),URL.revokeObjectURL(blobUrl),this._openBlobUrls.delete(element)}}return this.downloadData(data,filename,contentType),!1}download(blob,url,filename){download(URL.createObjectURL(blob),filename)}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.WaitOnType=exports2.EventBus=exports2.AutomationEventBus=void 0,exports2.waitOnEventOrTimeout=function waitOnEventOrTimeout({target,name,delay=0}){return new Promise(function(resolve,reject){if("object"!=typeof target||!name||"string"!=typeof name||!(Number.isInteger(delay)&&delay>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function handler(type){target instanceof EventBus?target._off(name,eventHandler):target.removeEventListener(name,eventHandler),timeout&&clearTimeout(timeout),resolve(type)}const eventHandler=handler.bind(null,WaitOnType.EVENT);target instanceof EventBus?target._on(name,eventHandler):target.addEventListener(name,eventHandler);const timeoutHandler=handler.bind(null,WaitOnType.TIMEOUT),timeout=setTimeout(timeoutHandler,delay)})};const WaitOnType={EVENT:"event",TIMEOUT:"timeout"};exports2.WaitOnType=WaitOnType;class EventBus{constructor(){this._listeners=Object.create(null)}on(eventName,listener,options=null){this._on(eventName,listener,{external:!0,once:options?.once})}off(eventName,listener,options=null){this._off(eventName,listener,{external:!0,once:options?.once})}dispatch(eventName,data){const eventListeners=this._listeners[eventName];if(!eventListeners||0===eventListeners.length)return;let externalListeners;for(const{listener,external,once}of eventListeners.slice(0))once&&this._off(eventName,listener),external?(externalListeners||=[]).push(listener):listener(data);if(externalListeners){for(const listener of externalListeners)listener(data);externalListeners=null}}_on(eventName,listener,options=null){(this._listeners[eventName]||=[]).push({listener,external:!0===options?.external,once:!0===options?.once})}_off(eventName,listener,options=null){const eventListeners=this._listeners[eventName];if(eventListeners)for(let i=0,ii=eventListeners.length;i<ii;i++)if(eventListeners[i].listener===listener)return void eventListeners.splice(i,1)}}exports2.EventBus=EventBus,exports2.AutomationEventBus=class AutomationEventBus extends EventBus{dispatch(eventName,data){throw new Error("Not implemented: AutomationEventBus.dispatch")}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.GenericL10n=void 0,__w_pdfjs_require__3(21);var _l10n_utils=__w_pdfjs_require__3(4);const webL10n=document.webL10n;exports2.GenericL10n=class GenericL10n{constructor(lang){this._lang=lang,this._ready=new Promise((resolve,reject)=>{webL10n.setLanguage((0,_l10n_utils.fixupLangCode)(lang),()=>{resolve(webL10n)})})}getLanguage(){var _this11=this;return _asyncToGenerator2(function*(){return(yield _this11._ready).getLanguage()})()}getDirection(){var _this12=this;return _asyncToGenerator2(function*(){return(yield _this12._ready).getDirection()})()}get(key,args=null,fallback=(0,_l10n_utils.getL10nFallback)(key,args)){var _this13=this;return _asyncToGenerator2(function*(){return(yield _this13._ready).get(key,args,fallback)})()}translate(element){var _this14=this;return _asyncToGenerator2(function*(){return(yield _this14._ready).translate(element)})()}}},()=>{document.webL10n=function(window2,document2,undefined2){var gL10nData={},gTextData="",gTextProp="textContent",gLanguage="",gMacros={},gReadyState="loading",gAsyncResourceLoading=!0;function xhrLoadText(url,onSuccess,onFailure){onSuccess=onSuccess||function(data){},onFailure=onFailure||function(){};var xhr=new XMLHttpRequest;xhr.open("GET",url,gAsyncResourceLoading),xhr.overrideMimeType&&xhr.overrideMimeType("text/plain; charset=utf-8"),xhr.onreadystatechange=function(){4==xhr.readyState&&(200==xhr.status||0===xhr.status?onSuccess(xhr.responseText):onFailure())},xhr.onerror=onFailure,xhr.ontimeout=onFailure;try{xhr.send(null)}catch{onFailure()}}function loadLocale(lang,callback){lang&&(lang=lang.toLowerCase()),callback=callback||function(){},function clear(){gL10nData={},gTextData="",gLanguage=""}(),gLanguage=lang;var langLinks=function getL10nResourceLinks(){return document2.querySelectorAll('link[type="application/l10n"]')}(),langCount=langLinks.length;if(0!==langCount){var onResourceLoaded,gResourceCount=0;onResourceLoaded=function(){++gResourceCount>=langCount&&(callback(),gReadyState="complete")};for(var i=0;i<langCount;i++)new L10nResourceLink(langLinks[i]).load(lang,onResourceLoaded)}else{var dict=function getL10nDictionary(){var script=document2.querySelector('script[type="application/l10n"]');return script?JSON.parse(script.innerHTML):null}();if(dict&&dict.locales&&dict.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(gL10nData=dict.locales[lang])){var defaultLocale=dict.default_locale.toLowerCase();for(var anyCaseLang in dict.locales){if((anyCaseLang=anyCaseLang.toLowerCase())===lang){gL10nData=dict.locales[lang];break}anyCaseLang===defaultLocale&&(gL10nData=dict.locales[defaultLocale])}}callback()}else console.log("no resource to load, early way out");gReadyState="complete"}function L10nResourceLink(link){var href=link.href;this.load=function(lang2,callback2){!function parseResource(href,lang,successCallback,failureCallback){var baseURL=href.replace(/[^\/]*$/,"")||"./";function evalString(text){return text.lastIndexOf("\\")<0?text:text.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}xhrLoadText(href,function(response){gTextData+=response,function parseProperties(text,parsedPropertiesCallback){var dictionary={},reBlank=/^\s*|\s*$/,reComment=/^\s*#|^\s*$/,reSection=/^\s*\[(.*)\]\s*$/,reImport=/^\s*@import\s+url\((.*)\)\s*$/i,reSplit=/^([^=\s]*)\s*=\s*(.+)$/;function parseRawLines(rawText,extendedSyntax,parsedRawLinesCallback){var entries=rawText.replace(reBlank,"").split(/[\r\n]+/),currentLang="*",genericLang=lang.split("-",1)[0],skipLang=!1,match="";!function nextEntry(){for(;;){if(!entries.length)return void parsedRawLinesCallback();var line=entries.shift();if(!reComment.test(line)){if(extendedSyntax){if(match=reSection.exec(line)){currentLang=match[1].toLowerCase(),skipLang="*"!==currentLang&&currentLang!==lang&&currentLang!==genericLang;continue}if(skipLang)continue;if(match=reImport.exec(line))return void loadImport(baseURL+match[1],nextEntry)}var tmp=line.match(reSplit);tmp&&3==tmp.length&&(dictionary[tmp[1]]=evalString(tmp[2]))}}}()}function loadImport(url,callback){xhrLoadText(url,function(content){parseRawLines(content,!1,callback)},function(){console.warn(url+" not found."),callback()})}parseRawLines(text,!0,function(){parsedPropertiesCallback(dictionary)})}(response,function(data){for(var key in data){var id,prop,index=key.lastIndexOf(".");index>0?(id=key.substring(0,index),prop=key.substring(index+1)):(id=key,prop=gTextProp),gL10nData[id]||(gL10nData[id]={}),gL10nData[id][prop]=data[key]}successCallback&&successCallback()})},failureCallback)}(href,lang2,callback2,function(){console.warn(href+" not found."),console.warn('"'+lang2+'" resource not found'),gLanguage="",callback2()})}}}function getL10nData(key,args,fallback){var data=gL10nData[key];if(!data){if(console.warn("#"+key+" is undefined."),!fallback)return null;data=fallback}var rv={};for(var prop in data){var str=data[prop];str=substArguments(str=substIndexes(str,args,key,prop),args,key),rv[prop]=str}return rv}function substIndexes(str,args,key,prop){var reMatch=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(str);if(!reMatch||!reMatch.length)return str;var param,macroName=reMatch[1],paramName=reMatch[2];return args&&paramName in args?param=args[paramName]:paramName in gL10nData&&(param=gL10nData[paramName]),macroName in gMacros&&(str=(0,gMacros[macroName])(str,param,key,prop)),str}function substArguments(str,args,key){return str.replace(/\{\{\s*(.+?)\s*\}\}/g,function(matched_text,arg){return args&&arg in args?args[arg]:arg in gL10nData?gL10nData[arg]:(console.log("argument {{"+arg+"}} for #"+key+" is undefined."),matched_text)})}function translateElement(element){var l10n=function getL10nAttributes(element){if(!element)return{};var l10nId=element.getAttribute("data-l10n-id"),l10nArgs=element.getAttribute("data-l10n-args"),args={};if(l10nArgs)try{args=JSON.parse(l10nArgs)}catch{console.warn("could not parse arguments for #"+l10nId)}return{id:l10nId,args}}(element);if(l10n.id){var data=getL10nData(l10n.id,l10n.args);if(!data)return void console.warn("#"+l10n.id+" is undefined.");if(data[gTextProp]){if(0===function getChildElementCount(element){if(element.children)return element.children.length;if(typeof element.childElementCount<"u")return element.childElementCount;for(var count=0,i=0;i<element.childNodes.length;i++)count+=1===element.nodeType?1:0;return count}(element))element[gTextProp]=data[gTextProp];else{for(var children=element.childNodes,found=!1,i=0,l=children.length;i<l;i++)3===children[i].nodeType&&/\S/.test(children[i].nodeValue)&&(found?children[i].nodeValue="":(children[i].nodeValue=data[gTextProp],found=!0));if(!found){var textNode=document2.createTextNode(data[gTextProp]);element.prepend(textNode)}}delete data[gTextProp]}for(var k in data)element[k]=data[k]}}return gMacros.plural=function(str,param,key,prop){var n=parseFloat(param);if(isNaN(n)||prop!=gTextProp)return str;gMacros._pluralRules||(gMacros._pluralRules=function getPluralRules(lang){function isIn(n,list){return-1!==list.indexOf(n)}function isBetween(n,start,end){return start<=n&&n<=end}var pluralRules={0:function(n){return"other"},1:function(n){return isBetween(n%100,3,10)?"few":0===n?"zero":isBetween(n%100,11,99)?"many":2==n?"two":1==n?"one":"other"},2:function(n){return 0!==n&&n%10==0?"many":2==n?"two":1==n?"one":"other"},3:function(n){return 1==n?"one":"other"},4:function(n){return isBetween(n,0,1)?"one":"other"},5:function(n){return isBetween(n,0,2)&&2!=n?"one":"other"},6:function(n){return 0===n?"zero":n%10==1&&n%100!=11?"one":"other"},7:function(n){return 2==n?"two":1==n?"one":"other"},8:function(n){return isBetween(n,3,6)?"few":isBetween(n,7,10)?"many":2==n?"two":1==n?"one":"other"},9:function(n){return 0===n||1!=n&&isBetween(n%100,1,19)?"few":1==n?"one":"other"},10:function(n){return isBetween(n%10,2,9)&&!isBetween(n%100,11,19)?"few":n%10!=1||isBetween(n%100,11,19)?"other":"one"},11:function(n){return isBetween(n%10,2,4)&&!isBetween(n%100,12,14)?"few":n%10==0||isBetween(n%10,5,9)||isBetween(n%100,11,14)?"many":n%10==1&&n%100!=11?"one":"other"},12:function(n){return isBetween(n,2,4)?"few":1==n?"one":"other"},13:function(n){return isBetween(n%10,2,4)&&!isBetween(n%100,12,14)?"few":1!=n&&isBetween(n%10,0,1)||isBetween(n%10,5,9)||isBetween(n%100,12,14)?"many":1==n?"one":"other"},14:function(n){return isBetween(n%100,3,4)?"few":n%100==2?"two":n%100==1?"one":"other"},15:function(n){return 0===n||isBetween(n%100,2,10)?"few":isBetween(n%100,11,19)?"many":1==n?"one":"other"},16:function(n){return n%10==1&&11!=n?"one":"other"},17:function(n){return 3==n?"few":0===n?"zero":6==n?"many":2==n?"two":1==n?"one":"other"},18:function(n){return 0===n?"zero":isBetween(n,0,2)&&0!==n&&2!=n?"one":"other"},19:function(n){return isBetween(n,2,10)?"few":isBetween(n,0,1)?"one":"other"},20:function(n){return!isBetween(n%10,3,4)&&n%10!=9||isBetween(n%100,10,19)||isBetween(n%100,70,79)||isBetween(n%100,90,99)?n%1e6==0&&0!==n?"many":n%10!=2||isIn(n%100,[12,72,92])?n%10!=1||isIn(n%100,[11,71,91])?"other":"one":"two":"few"},21:function(n){return 0===n?"zero":1==n?"one":"other"},22:function(n){return isBetween(n,0,1)||isBetween(n,11,99)?"one":"other"},23:function(n){return isBetween(n%10,1,2)||n%20==0?"one":"other"},24:function(n){return isBetween(n,3,10)||isBetween(n,13,19)?"few":isIn(n,[2,12])?"two":isIn(n,[1,11])?"one":"other"}},index={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[lang.replace(/-.*$/,"")];return index in pluralRules?pluralRules[index]:(console.warn("plural form unknown for ["+lang+"]"),function(){return"other"})}(gLanguage));var index="["+gMacros._pluralRules(n)+"]";return 0===n&&key+"[zero]"in gL10nData?str=gL10nData[key+"[zero]"][prop]:1==n&&key+"[one]"in gL10nData?str=gL10nData[key+"[one]"][prop]:2==n&&key+"[two]"in gL10nData?str=gL10nData[key+"[two]"][prop]:key+index in gL10nData?str=gL10nData[key+index][prop]:key+"[other]"in gL10nData&&(str=gL10nData[key+"[other]"][prop]),str},{get:function(key,args,fallbackString){var fallback,index=key.lastIndexOf("."),prop=gTextProp;index>0&&(prop=key.substring(index+1),key=key.substring(0,index)),fallbackString&&((fallback={})[prop]=fallbackString);var data=getL10nData(key,args,fallback);return data&&prop in data?data[prop]:"{{"+key+"}}"},getData:function(){return gL10nData},getText:function(){return gTextData},getLanguage:function(){return gLanguage},setLanguage:function(lang,callback){loadLocale(lang,function(){callback&&callback()})},getDirection:function(){var shortCode=gLanguage.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(shortCode)>=0?"rtl":"ltr"},translate:function translateFragment(element){for(var children=function getTranslatableChildren(element){return element?element.querySelectorAll("*[data-l10n-id]"):[]}(element=element||document2.documentElement),elementCount=children.length,i=0;i<elementCount;i++)translateElement(children[i]);translateElement(element)},getReadyState:function(){return gReadyState},ready:function(callback){callback&&("complete"==gReadyState||"interactive"==gReadyState?window2.setTimeout(function(){callback()}):document2.addEventListener&&document2.addEventListener("localized",function once(){document2.removeEventListener("localized",once),callback()}))}}}(window,document)},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFFindController=exports2.FindState=void 0;var _ui_utils=__w_pdfjs_require__3(7),_pdfjsLib=__w_pdfjs_require__3(3),_pdf_find_utils=__w_pdfjs_require__3(23);const FindState={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};exports2.FindState=FindState;const CHARACTERS_TO_NORMALIZE={"\u2010":"-","\u2018":"'","\u2019":"'","\u201a":"'","\u201b":"'","\u201c":'"',"\u201d":'"',"\u201e":'"',"\u201f":'"',"\xbc":"1/4","\xbd":"1/2","\xbe":"3/4"},DIACRITICS_EXCEPTION=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]),DIACRITICS_EXCEPTION_STR=[...DIACRITICS_EXCEPTION.values()].map(x=>String.fromCharCode(x)).join(""),DIACRITICS_REG_EXP=/\p{M}+/gu,SPECIAL_CHARS_REG_EXP=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,NOT_DIACRITIC_FROM_END_REG_EXP=/([^\p{M}])\p{M}*$/u,NOT_DIACRITIC_FROM_START_REG_EXP=/^\p{M}*([^\p{M}])/u,SYLLABLES_REG_EXP=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,SYLLABLES_LENGTHS=new Map;let noSyllablesRegExp=null,withSyllablesRegExp=null;function normalize(text){const syllablePositions=[];let m,normalizationRegex;for(;null!==(m=SYLLABLES_REG_EXP.exec(text));){let{index}=m;for(const char of m[0]){let len=SYLLABLES_LENGTHS.get(char);len||(len=char.normalize("NFD").length,SYLLABLES_LENGTHS.set(char,len)),syllablePositions.push([len,index++])}}if(0===syllablePositions.length&&noSyllablesRegExp)normalizationRegex=noSyllablesRegExp;else if(syllablePositions.length>0&&withSyllablesRegExp)normalizationRegex=withSyllablesRegExp;else{const regexp=`([${Object.keys(CHARACTERS_TO_NORMALIZE).join("")}])|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(\\n)`;normalizationRegex=0===syllablePositions.length?noSyllablesRegExp=new RegExp(regexp+"|(\\u0000)","gum"):withSyllablesRegExp=new RegExp(regexp+"|([\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f])","gum")}const rawDiacriticsPositions=[];for(;null!==(m=DIACRITICS_REG_EXP.exec(text));)rawDiacriticsPositions.push([m[0].length,m.index]);let normalized=text.normalize("NFD");const positions=[[0,0]];let rawDiacriticsIndex=0,syllableIndex=0,shift=0,shiftOrigin=0,eol=0,hasDiacritics=!1;return normalized=normalized.replace(normalizationRegex,(match,p1,p2,p3,p4,p5,i)=>{if(i-=shiftOrigin,p1){const replacement=CHARACTERS_TO_NORMALIZE[match],jj=replacement.length;for(let j=1;j<jj;j++)positions.push([i-shift+j,shift-j]);return shift-=jj-1,replacement}if(p2){const hasTrailingDashEOL=p2.endsWith("\n"),len=hasTrailingDashEOL?p2.length-2:p2.length;hasDiacritics=!0;let jj=len;i+eol===rawDiacriticsPositions[rawDiacriticsIndex]?.[1]&&(jj-=rawDiacriticsPositions[rawDiacriticsIndex][0],++rawDiacriticsIndex);for(let j=1;j<=jj;j++)positions.push([i-1-shift+j,shift-j]);return shift-=jj,shiftOrigin+=jj,hasTrailingDashEOL?(positions.push([(i+=len-1)-shift+1,1+shift]),shift+=1,shiftOrigin+=1,eol+=1,p2.slice(0,len)):p2}if(p3)return positions.push([i-shift+1,1+shift]),shift+=1,shiftOrigin+=1,eol+=1,p3.charAt(0);if(p4)return positions.push([i-shift+1,shift-1]),shift-=1,shiftOrigin+=1,eol+=1," ";if(i+eol===syllablePositions[syllableIndex]?.[1]){const newCharLen=syllablePositions[syllableIndex][0]-1;++syllableIndex;for(let j=1;j<=newCharLen;j++)positions.push([i-(shift-j),shift-j]);shift-=newCharLen,shiftOrigin+=newCharLen}return p5}),positions.push([normalized.length,shift]),[normalized,positions,hasDiacritics]}function getOriginalIndex(diffs,pos,len){if(!diffs)return[pos,len];const start=pos,end=pos+len;let i=(0,_ui_utils.binarySearchFirstItem)(diffs,x=>x[0]>=start);diffs[i][0]>start&&--i;let j=(0,_ui_utils.binarySearchFirstItem)(diffs,x=>x[0]>=end,i);return diffs[j][0]>end&&--j,[start+diffs[i][1],len+diffs[j][1]-diffs[i][1]]}exports2.PDFFindController=class PDFFindController{constructor({linkService,eventBus}){this._linkService=linkService,this._eventBus=eventBus,this.#reset(),eventBus._on("find",this.#onFind.bind(this)),eventBus._on("findbarclose",this.#onFindBarClose.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this._state}setDocument(pdfDocument){this._pdfDocument&&this.#reset(),pdfDocument&&(this._pdfDocument=pdfDocument,this._firstPageCapability.resolve())}#onFind(state){if(!state)return;const pdfDocument=this._pdfDocument,{type}=state;(null===this._state||this.#shouldDirtyMatch(state))&&(this._dirtyMatch=!0),this._state=state,"highlightallchange"!==type&&this.#updateUIState(FindState.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||pdfDocument&&this._pdfDocument!==pdfDocument)return;this.#extractText();const findbarClosed=!this._highlightMatches,pendingTimeout=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),type?this._dirtyMatch?this.#nextMatch():"again"===type?(this.#nextMatch(),findbarClosed&&this._state.highlightAll&&this.#updateAllPages()):"highlightallchange"===type?(pendingTimeout?this.#nextMatch():this._highlightMatches=!0,this.#updateAllPages()):this.#nextMatch():this._findTimeout=setTimeout(()=>{this.#nextMatch(),this._findTimeout=null},250)})}scrollMatchIntoView({element=null,selectedLeft=0,pageIndex=-1,matchIndex=-1}){this._scrollMatches&&element&&-1!==matchIndex&&matchIndex===this._selected.matchIdx&&-1!==pageIndex&&pageIndex===this._selected.pageIdx&&(this._scrollMatches=!1,(0,_ui_utils.scrollIntoView)(element,{top:-50,left:selectedLeft+-400},!0))}#reset(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this._state=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=(0,_pdfjsLib.createPromiseCapability)()}get#query(){return this._state.query!==this._rawQuery&&(this._rawQuery=this._state.query,[this._normalizedQuery]=normalize(this._state.query)),this._normalizedQuery}#shouldDirtyMatch(state){if(state.query!==this._state.query)return!0;switch(state.type){case"again":const pageNumber=this._selected.pageIdx+1,linkService=this._linkService;return pageNumber>=1&&pageNumber<=linkService.pagesCount&&pageNumber!==linkService.page&&!linkService.isPageVisible(pageNumber);case"highlightallchange":return!1}return!0}#isEntireWord(content,startIdx,length){let match=content.slice(0,startIdx).match(NOT_DIACRITIC_FROM_END_REG_EXP);if(match){const first=content.charCodeAt(startIdx),limit=match[1].charCodeAt(0);if((0,_pdf_find_utils.getCharacterType)(first)===(0,_pdf_find_utils.getCharacterType)(limit))return!1}if(match=content.slice(startIdx+length).match(NOT_DIACRITIC_FROM_START_REG_EXP),match){const last=content.charCodeAt(startIdx+length-1),limit=match[1].charCodeAt(0);if((0,_pdf_find_utils.getCharacterType)(last)===(0,_pdf_find_utils.getCharacterType)(limit))return!1}return!0}#calculateRegExpMatch(query,entireWord,pageIndex,pageContent){const matches=[],matchesLength=[],diffs=this._pageDiffs[pageIndex];let match;for(;null!==(match=query.exec(pageContent));){if(entireWord&&!this.#isEntireWord(pageContent,match.index,match[0].length))continue;const[matchPos,matchLen]=getOriginalIndex(diffs,match.index,match[0].length);matchLen&&(matches.push(matchPos),matchesLength.push(matchLen))}this._pageMatches[pageIndex]=matches,this._pageMatchesLength[pageIndex]=matchesLength}#convertToRegExpString(query,hasDiacritics){const{matchDiacritics}=this._state;let isUnicode=!1;return(query=query.replace(SPECIAL_CHARS_REG_EXP,(match,p1,p2,p3,p4,p5)=>p1?`[ ]*\\${p1}[ ]*`:p2?`[ ]*${p2}[ ]*`:p3?"[ ]+":matchDiacritics?p4||p5:p4?DIACRITICS_EXCEPTION.has(p4.charCodeAt(0))?p4:"":hasDiacritics?(isUnicode=!0,`${p5}\\p{M}*`):p5)).endsWith("[ ]*")&&(query=query.slice(0,query.length-4)),matchDiacritics&&hasDiacritics&&(isUnicode=!0,query=`${query}(?=[${DIACRITICS_EXCEPTION_STR}]|[^\\p{M}]|$)`),[isUnicode,query]}#calculateMatch(pageIndex){let query=this.#query;if(0===query.length)return;const{caseSensitive,entireWord,phraseSearch}=this._state,pageContent=this._pageContents[pageIndex],hasDiacritics=this._hasDiacritics[pageIndex];let isUnicode=!1;if(phraseSearch)[isUnicode,query]=this.#convertToRegExpString(query,hasDiacritics);else{const match=query.match(/\S+/g);match&&(query=match.sort().reverse().map(q=>{const[isUnicodePart,queryPart]=this.#convertToRegExpString(q,hasDiacritics);return isUnicode||=isUnicodePart,`(${queryPart})`}).join("|"))}query=new RegExp(query,`g${isUnicode?"u":""}${caseSensitive?"":"i"}`),this.#calculateRegExpMatch(query,entireWord,pageIndex,pageContent),this._state.highlightAll&&this.#updatePage(pageIndex),this._resumePageIdx===pageIndex&&(this._resumePageIdx=null,this.#nextPageMatch());const pageMatchesCount=this._pageMatches[pageIndex].length;pageMatchesCount>0&&(this._matchesCountTotal+=pageMatchesCount,this.#updateUIResultsCount())}#extractText(){if(this._extractTextPromises.length>0)return;let promise=Promise.resolve();for(let i=0,ii=this._linkService.pagesCount;i<ii;i++){const extractTextCapability=(0,_pdfjsLib.createPromiseCapability)();this._extractTextPromises[i]=extractTextCapability.promise,promise=promise.then(()=>this._pdfDocument.getPage(i+1).then(pdfPage=>pdfPage.getTextContent()).then(textContent=>{const strBuf=[];for(const textItem of textContent.items)strBuf.push(textItem.str),textItem.hasEOL&&strBuf.push("\n");[this._pageContents[i],this._pageDiffs[i],this._hasDiacritics[i]]=normalize(strBuf.join("")),extractTextCapability.resolve()},reason=>{console.error(`Unable to get text content for page ${i+1}`,reason),this._pageContents[i]="",this._pageDiffs[i]=null,this._hasDiacritics[i]=!1,extractTextCapability.resolve()}))}}#updatePage(index){this._scrollMatches&&this._selected.pageIdx===index&&(this._linkService.page=index+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:index})}#updateAllPages(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#nextMatch(){const previous=this._state.findPrevious,currentPageIndex=this._linkService.page-1,numPages=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=currentPageIndex,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this._matchesCountTotal=0,this.#updateAllPages();for(let i=0;i<numPages;i++)this._pendingFindMatches.has(i)||(this._pendingFindMatches.add(i),this._extractTextPromises[i].then(()=>{this._pendingFindMatches.delete(i),this.#calculateMatch(i)}))}if(""===this.#query)return void this.#updateUIState(FindState.FOUND);if(this._resumePageIdx)return;const offset=this._offset;if(this._pagesToSearch=numPages,null!==offset.matchIdx){if(!previous&&offset.matchIdx+1<this._pageMatches[offset.pageIdx].length||previous&&offset.matchIdx>0)return offset.matchIdx=previous?offset.matchIdx-1:offset.matchIdx+1,void this.#updateMatch(!0);this.#advanceOffsetPage(previous)}this.#nextPageMatch()}#matchesReady(matches){const offset=this._offset,numMatches=matches.length,previous=this._state.findPrevious;return numMatches?(offset.matchIdx=previous?numMatches-1:0,this.#updateMatch(!0),!0):(this.#advanceOffsetPage(previous),!!(offset.wrapped&&(offset.matchIdx=null,this._pagesToSearch<0))&&(this.#updateMatch(!1),!0))}#nextPageMatch(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let matches=null;do{const pageIdx=this._offset.pageIdx;if(matches=this._pageMatches[pageIdx],!matches){this._resumePageIdx=pageIdx;break}}while(!this.#matchesReady(matches))}#advanceOffsetPage(previous){const offset=this._offset,numPages=this._linkService.pagesCount;offset.pageIdx=previous?offset.pageIdx-1:offset.pageIdx+1,offset.matchIdx=null,this._pagesToSearch--,(offset.pageIdx>=numPages||offset.pageIdx<0)&&(offset.pageIdx=previous?numPages-1:0,offset.wrapped=!0)}#updateMatch(found=!1){let state=FindState.NOT_FOUND;const wrapped=this._offset.wrapped;if(this._offset.wrapped=!1,found){const previousPage=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,state=wrapped?FindState.WRAPPED:FindState.FOUND,-1!==previousPage&&previousPage!==this._selected.pageIdx&&this.#updatePage(previousPage)}this.#updateUIState(state,this._state.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this.#updatePage(this._selected.pageIdx))}#onFindBarClose(evt){const pdfDocument=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||pdfDocument&&this._pdfDocument!==pdfDocument||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#updateUIState(FindState.FOUND),this._highlightMatches=!1,this.#updateAllPages())})}#requestMatchesCount(){const{pageIdx,matchIdx}=this._selected;let current=0,total=this._matchesCountTotal;if(-1!==matchIdx){for(let i=0;i<pageIdx;i++)current+=this._pageMatches[i]?.length||0;current+=matchIdx+1}return(current<1||current>total)&&(current=total=0),{current,total}}#updateUIResultsCount(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#requestMatchesCount()})}#updateUIState(state,previous=!1){this._eventBus.dispatch("updatefindcontrolstate",{source:this,state,previous,matchesCount:this.#requestMatchesCount(),rawQuery:this._state?.query??null})}}},(__unused_webpack_module2,exports2)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.CharacterType=void 0,exports2.getCharacterType=function getCharacterType(charCode){return function isAlphabeticalScript(charCode){return charCode<11904}(charCode)?function isAscii(charCode){return 0==(65408&charCode)}(charCode)?function isAsciiSpace(charCode){return 32===charCode||9===charCode||13===charCode||10===charCode}(charCode)?CharacterType.SPACE:function isAsciiAlpha(charCode){return charCode>=97&&charCode<=122||charCode>=65&&charCode<=90}(charCode)||function isAsciiDigit(charCode){return charCode>=48&&charCode<=57}(charCode)||95===charCode?CharacterType.ALPHA_LETTER:CharacterType.PUNCT:function isThai(charCode){return 3584==(65408&charCode)}(charCode)?CharacterType.THAI_LETTER:160===charCode?CharacterType.SPACE:CharacterType.ALPHA_LETTER:function isHan(charCode){return charCode>=13312&&charCode<=40959||charCode>=63744&&charCode<=64255}(charCode)?CharacterType.HAN_LETTER:function isKatakana(charCode){return charCode>=12448&&charCode<=12543}(charCode)?CharacterType.KATAKANA_LETTER:function isHiragana(charCode){return charCode>=12352&&charCode<=12447}(charCode)?CharacterType.HIRAGANA_LETTER:function isHalfwidthKatakana(charCode){return charCode>=65376&&charCode<=65439}(charCode)?CharacterType.HALFWIDTH_KATAKANA_LETTER:CharacterType.ALPHA_LETTER};const CharacterType={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};exports2.CharacterType=CharacterType},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFHistory=void 0,exports2.isDestArraysEqual=isDestArraysEqual,exports2.isDestHashesEqual=isDestHashesEqual;var _ui_utils=__w_pdfjs_require__3(7),_event_utils=__w_pdfjs_require__3(19);function getCurrentHash(){return document.location.hash}function isDestHashesEqual(destHash,pushHash){return"string"==typeof destHash&&"string"==typeof pushHash&&(destHash===pushHash||(0,_ui_utils.parseQueryString)(destHash).get("nameddest")===pushHash)}function isDestArraysEqual(firstDest,secondDest){function isEntryEqual(first,second){if(typeof first!=typeof second||Array.isArray(first)||Array.isArray(second))return!1;if(null!==first&&"object"==typeof first&&null!==second){if(Object.keys(first).length!==Object.keys(second).length)return!1;for(const key in first)if(!isEntryEqual(first[key],second[key]))return!1;return!0}return first===second||Number.isNaN(first)&&Number.isNaN(second)}if(!Array.isArray(firstDest)||!Array.isArray(secondDest)||firstDest.length!==secondDest.length)return!1;for(let i=0,ii=firstDest.length;i<ii;i++)if(!isEntryEqual(firstDest[i],secondDest[i]))return!1;return!0}exports2.PDFHistory=class PDFHistory{constructor({linkService,eventBus}){this.linkService=linkService,this.eventBus=eventBus,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",evt=>{this._isPagesLoaded=!!evt.pagesCount},{once:!0})})}initialize({fingerprint,resetHistory=!1,updateUrl=!1}){if(!fingerprint||"string"!=typeof fingerprint)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const reInitialized=""!==this._fingerprint&&this._fingerprint!==fingerprint;this._fingerprint=fingerprint,this._updateUrl=!0===updateUrl,this._initialized=!0,this._bindEvents();const state=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=getCurrentHash(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(state,!0)||resetHistory){const{hash,page,rotation}=this._parseCurrentHash(!0);return!hash||reInitialized||resetHistory?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash,page,rotation},!0)}const destination=state.destination;this._updateInternalState(destination,state.uid,!0),void 0!==destination.rotation&&(this._initialRotation=destination.rotation),destination.dest?(this._initialBookmark=JSON.stringify(destination.dest),this._destination.page=null):destination.hash?this._initialBookmark=destination.hash:destination.page&&(this._initialBookmark=`page=${destination.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest=null,explicitDest,pageNumber}){if(!this._initialized)return;if(namedDest&&"string"!=typeof namedDest)return void console.error(`PDFHistory.push: "${namedDest}" is not a valid namedDest parameter.`);if(!Array.isArray(explicitDest))return void console.error(`PDFHistory.push: "${explicitDest}" is not a valid explicitDest parameter.`);if(!this._isValidPage(pageNumber)&&(null!==pageNumber||this._destination))return void console.error(`PDFHistory.push: "${pageNumber}" is not a valid pageNumber parameter.`);const hash=namedDest||JSON.stringify(explicitDest);if(!hash)return;let forceReplace=!1;if(this._destination&&(isDestHashesEqual(this._destination.hash,hash)||isDestArraysEqual(this._destination.dest,explicitDest))){if(this._destination.page)return;forceReplace=!0}this._popStateInProgress&&!forceReplace||(this._pushOrReplaceState({dest:explicitDest,hash,page:pageNumber,rotation:this.linkService.rotation},forceReplace),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(pageNumber){if(this._initialized){if(!this._isValidPage(pageNumber))return void console.error(`PDFHistory.pushPage: "${pageNumber}" is not a valid page number.`);this._destination?.page!==pageNumber&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${pageNumber}`,page:pageNumber,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const state=window.history.state;this._isValidState(state)&&state.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const state=window.history.state;this._isValidState(state)&&state.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(destination,forceReplace=!1){const shouldReplace=forceReplace||!this._destination,newState={fingerprint:this._fingerprint,uid:shouldReplace?this._uid:this._uid+1,destination};let newUrl;if(this._updateInternalState(destination,newState.uid),this._updateUrl&&destination?.hash){const baseUrl=document.location.href.split("#")[0];baseUrl.startsWith("file://")||(newUrl=`${baseUrl}#${destination.hash}`)}shouldReplace?window.history.replaceState(newState,"",newUrl):window.history.pushState(newState,"",newUrl)}_tryPushCurrentPosition(temporary=!1){if(!this._position)return;let position=this._position;if(temporary&&(position=Object.assign(Object.create(null),this._position),position.temporary=!0),!this._destination)return void this._pushOrReplaceState(position);if(this._destination.temporary)return void this._pushOrReplaceState(position,!0);if(this._destination.hash===position.hash||!this._destination.page&&this._numPositionUpdates<=50)return;let forceReplace=!1;if(this._destination.page>=position.first&&this._destination.page<=position.page){if(void 0!==this._destination.dest||!this._destination.first)return;forceReplace=!0}this._pushOrReplaceState(position,forceReplace)}_isValidPage(val){return Number.isInteger(val)&&val>0&&val<=this.linkService.pagesCount}_isValidState(state,checkReload=!1){if(!state)return!1;if(state.fingerprint!==this._fingerprint){if(!checkReload)return!1;{if("string"!=typeof state.fingerprint||state.fingerprint.length!==this._fingerprint.length)return!1;const[perfEntry]=performance.getEntriesByType("navigation");if("reload"!==perfEntry?.type)return!1}}return!(!Number.isInteger(state.uid)||state.uid<0||null===state.destination||"object"!=typeof state.destination)}_updateInternalState(destination,uid,removeTemporary=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),removeTemporary&&destination?.temporary&&delete destination.temporary,this._destination=destination,this._uid=uid,this._maxUid=Math.max(this._maxUid,uid),this._numPositionUpdates=0}_parseCurrentHash(checkNameddest=!1){const hash=unescape(getCurrentHash()).substring(1),params=(0,_ui_utils.parseQueryString)(hash),nameddest=params.get("nameddest")||"";let page=0|params.get("page");return(!this._isValidPage(page)||checkNameddest&&nameddest.length>0)&&(page=null),{hash,page,rotation:this.linkService.rotation}}_updateViewarea({location}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:location.pdfOpenParams.substring(1),page:this.linkService.page,first:location.pageNumber,rotation:location.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null},1e3))}_popState({state}){const newHash=getCurrentHash(),hashChanged=this._currentHash!==newHash;if(this._currentHash=newHash,!state){this._uid++;const{hash,page,rotation}=this._parseCurrentHash();return void this._pushOrReplaceState({hash,page,rotation},!0)}if(!this._isValidState(state))return;this._popStateInProgress=!0,hashChanged&&(this._blockHashChange++,(0,_event_utils.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then(()=>{this._blockHashChange--}));const destination=state.destination;this._updateInternalState(destination,state.uid,!0),(0,_ui_utils.isValidRotation)(destination.rotation)&&(this.linkService.rotation=destination.rotation),destination.dest?this.linkService.goToDestination(destination.dest):destination.hash?this.linkService.setHash(destination.hash):destination.page&&(this.linkService.page=destination.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}_pageHide(){(!this._destination||this._destination.temporary)&&this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.PDFScriptingManager=void 0;var _ui_utils=__w_pdfjs_require__3(7),_pdfjsLib=__w_pdfjs_require__3(3);exports2.PDFScriptingManager=class PDFScriptingManager{constructor({eventBus,sandboxBundleSrc=null,scriptingFactory=null,docPropertiesLookup=null}){this._pdfDocument=null,this._pdfViewer=null,this._closeCapability=null,this._destroyCapability=null,this._scripting=null,this._mouseState=Object.create(null),this._ready=!1,this._eventBus=eventBus,this._sandboxBundleSrc=sandboxBundleSrc,this._scriptingFactory=scriptingFactory,this._docPropertiesLookup=docPropertiesLookup,this._scriptingFactory||window.addEventListener("updatefromsandbox",event=>{this._eventBus.dispatch("updatefromsandbox",{source:window,detail:event.detail})})}setViewer(pdfViewer){this._pdfViewer=pdfViewer}setDocument(pdfDocument){var _this15=this;return _asyncToGenerator2(function*(){if(_this15._pdfDocument&&(yield _this15._destroyScripting()),_this15._pdfDocument=pdfDocument,!pdfDocument)return;const[objects,calculationOrder,docActions]=yield Promise.all([pdfDocument.getFieldObjects(),pdfDocument.getCalculationOrderIds(),pdfDocument.getJSActions()]);if(objects||docActions){if(pdfDocument===_this15._pdfDocument){try{_this15._scripting=_this15._createScripting()}catch(error){return console.error(`PDFScriptingManager.setDocument: "${error?.message}".`),void(yield _this15._destroyScripting())}_this15._internalEvents.set("updatefromsandbox",event=>{event?.source===window&&_this15._updateFromSandbox(event.detail)}),_this15._internalEvents.set("dispatcheventinsandbox",event=>{_this15._scripting?.dispatchEventInSandbox(event.detail)}),_this15._internalEvents.set("pagechanging",({pageNumber,previous})=>{pageNumber!==previous&&(_this15._dispatchPageClose(previous),_this15._dispatchPageOpen(pageNumber))}),_this15._internalEvents.set("pagerendered",({pageNumber})=>{_this15._pageOpenPending.has(pageNumber)&&pageNumber===_this15._pdfViewer.currentPageNumber&&_this15._dispatchPageOpen(pageNumber)}),_this15._internalEvents.set("pagesdestroy",function(){var _ref3=_asyncToGenerator2(function*(event){yield _this15._dispatchPageClose(_this15._pdfViewer.currentPageNumber),yield _this15._scripting?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),_this15._closeCapability?.resolve()});return function(_x){return _ref3.apply(this,arguments)}}()),_this15._domEvents.set("mousedown",event=>{_this15._mouseState.isDown=!0}),_this15._domEvents.set("mouseup",event=>{_this15._mouseState.isDown=!1});for(const[name,listener]of _this15._internalEvents)_this15._eventBus._on(name,listener);for(const[name,listener]of _this15._domEvents)window.addEventListener(name,listener,!0);try{const docProperties=yield _this15._getDocProperties();if(pdfDocument!==_this15._pdfDocument)return;yield _this15._scripting.createSandbox({objects,calculationOrder,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...docProperties,actions:docActions}}),_this15._eventBus.dispatch("sandboxcreated",{source:_this15})}catch(error){return console.error(`PDFScriptingManager.setDocument: "${error?.message}".`),void(yield _this15._destroyScripting())}yield _this15._scripting?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield _this15._dispatchPageOpen(_this15._pdfViewer.currentPageNumber,!0),Promise.resolve().then(()=>{pdfDocument===_this15._pdfDocument&&(_this15._ready=!0)})}}else yield _this15._destroyScripting()})()}dispatchWillSave(detail){var _this16=this;return _asyncToGenerator2(function*(){return _this16._scripting?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})()}dispatchDidSave(detail){var _this17=this;return _asyncToGenerator2(function*(){return _this17._scripting?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})()}dispatchWillPrint(detail){var _this18=this;return _asyncToGenerator2(function*(){return _this18._scripting?.dispatchEventInSandbox({id:"doc",name:"WillPrint"})})()}dispatchDidPrint(detail){var _this19=this;return _asyncToGenerator2(function*(){return _this19._scripting?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})()}get mouseState(){return this._mouseState}get destroyPromise(){return this._destroyCapability?.promise||null}get ready(){return this._ready}get _internalEvents(){return(0,_pdfjsLib.shadow)(this,"_internalEvents",new Map)}get _domEvents(){return(0,_pdfjsLib.shadow)(this,"_domEvents",new Map)}get _pageOpenPending(){return(0,_pdfjsLib.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,_pdfjsLib.shadow)(this,"_visitedPages",new Map)}_updateFromSandbox(detail){var _this20=this;return _asyncToGenerator2(function*(){const isInPresentationMode=_this20._pdfViewer.isInPresentationMode||_this20._pdfViewer.isChangingPresentationMode,{id,siblings,command,value}=detail;if(!id){switch(command){case"clear":console.clear();break;case"error":console.error(value);break;case"layout":if(isInPresentationMode)return;const modes=(0,_ui_utils.apiPageLayoutToViewerModes)(value);_this20._pdfViewer.spreadMode=modes.spreadMode;break;case"page-num":_this20._pdfViewer.currentPageNumber=value+1;break;case"print":yield _this20._pdfViewer.pagesPromise,_this20._eventBus.dispatch("print",{source:_this20});break;case"println":console.log(value);break;case"zoom":if(isInPresentationMode)return;_this20._pdfViewer.currentScaleValue=value;break;case"SaveAs":_this20._eventBus.dispatch("download",{source:_this20});break;case"FirstPage":_this20._pdfViewer.currentPageNumber=1;break;case"LastPage":_this20._pdfViewer.currentPageNumber=_this20._pdfViewer.pagesCount;break;case"NextPage":_this20._pdfViewer.nextPage();break;case"PrevPage":_this20._pdfViewer.previousPage();break;case"ZoomViewIn":if(isInPresentationMode)return;_this20._pdfViewer.increaseScale();break;case"ZoomViewOut":if(isInPresentationMode)return;_this20._pdfViewer.decreaseScale()}return}if(isInPresentationMode&&detail.focus)return;delete detail.id,delete detail.siblings;const ids=siblings?[id,...siblings]:[id];for(const elementId of ids){const element=document.querySelector(`[data-element-id="${elementId}"]`);element?element.dispatchEvent(new CustomEvent("updatefromsandbox",{detail})):_this20._pdfDocument?.annotationStorage.setValue(elementId,detail)}})()}_dispatchPageOpen(pageNumber,initialize=!1){var _this21=this;return _asyncToGenerator2(function*(){const pdfDocument=_this21._pdfDocument,visitedPages=_this21._visitedPages;if(initialize&&(_this21._closeCapability=(0,_pdfjsLib.createPromiseCapability)()),!_this21._closeCapability)return;const pageView=_this21._pdfViewer.getPageView(pageNumber-1);if(pageView?.renderingState!==_ui_utils.RenderingStates.FINISHED)return void _this21._pageOpenPending.add(pageNumber);_this21._pageOpenPending.delete(pageNumber);const actionsPromise=_asyncToGenerator2(function*(){const actions=yield visitedPages.has(pageNumber)?null:pageView.pdfPage?.getJSActions();pdfDocument===_this21._pdfDocument&&(yield _this21._scripting?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber,actions}))})();visitedPages.set(pageNumber,actionsPromise)})()}_dispatchPageClose(pageNumber){var _this22=this;return _asyncToGenerator2(function*(){const pdfDocument=_this22._pdfDocument,visitedPages=_this22._visitedPages;if(!_this22._closeCapability||_this22._pageOpenPending.has(pageNumber))return;const actionsPromise=visitedPages.get(pageNumber);actionsPromise&&(visitedPages.set(pageNumber,null),yield actionsPromise,pdfDocument===_this22._pdfDocument&&(yield _this22._scripting?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber})))})()}_getDocProperties(){var _this23=this;return _asyncToGenerator2(function*(){if(_this23._docPropertiesLookup)return _this23._docPropertiesLookup(_this23._pdfDocument);const{docPropertiesLookup}=__w_pdfjs_require__3(26);return docPropertiesLookup(_this23._pdfDocument)})()}_createScripting(){if(this._destroyCapability=(0,_pdfjsLib.createPromiseCapability)(),this._scripting)throw new Error("_createScripting: Scripting already exists.");if(this._scriptingFactory)return this._scriptingFactory.createScripting({sandboxBundleSrc:this._sandboxBundleSrc});const{GenericScripting}=__w_pdfjs_require__3(26);return new GenericScripting(this._sandboxBundleSrc)}_destroyScripting(){var _this24=this;return _asyncToGenerator2(function*(){if(!_this24._scripting)return _this24._pdfDocument=null,void _this24._destroyCapability?.resolve();_this24._closeCapability&&(yield Promise.race([_this24._closeCapability.promise,new Promise(resolve=>{setTimeout(resolve,1e3)})]).catch(reason=>{}),_this24._closeCapability=null),_this24._pdfDocument=null;try{yield _this24._scripting.destroySandbox()}catch{}for(const[name,listener]of _this24._internalEvents)_this24._eventBus._off(name,listener);_this24._internalEvents.clear();for(const[name,listener]of _this24._domEvents)window.removeEventListener(name,listener,!0);_this24._domEvents.clear(),_this24._pageOpenPending.clear(),_this24._visitedPages.clear(),_this24._scripting=null,delete _this24._mouseState.isDown,_this24._ready=!1,_this24._destroyCapability?.resolve()})()}}},(__unused_webpack_module2,exports2,__w_pdfjs_require__3)=>{Object.defineProperty(exports2,"__esModule",{value:!0}),exports2.GenericScripting=void 0,exports2.docPropertiesLookup=function docPropertiesLookup(_x2){return _docPropertiesLookup.apply(this,arguments)};var _pdfjsLib=__w_pdfjs_require__3(3);function _docPropertiesLookup(){return(_docPropertiesLookup=_asyncToGenerator2(function*(pdfDocument){const baseUrl="".split("#")[0];let{info,metadata,contentDispositionFilename,contentLength}=yield pdfDocument.getMetadata();if(!contentLength){const{length}=yield pdfDocument.getDownloadInfo();contentLength=length}return{...info,baseURL:baseUrl,filesize:contentLength,filename:contentDispositionFilename||(0,_pdfjsLib.getPdfFilenameFromUrl)(""),metadata:metadata?.getRaw(),authors:metadata?.get("dc:creator"),numPages:pdfDocument.numPages,URL:""}})).apply(this,arguments)}exports2.GenericScripting=class GenericScripting{constructor(sandboxBundleSrc){this._ready=(0,_pdfjsLib.loadScript)(sandboxBundleSrc,!0).then(()=>window.pdfjsSandbox.QuickJSSandbox())}createSandbox(data){var _this25=this;return _asyncToGenerator2(function*(){(yield _this25._ready).create(data)})()}dispatchEventInSandbox(event){var _this26=this;return _asyncToGenerator2(function*(){const sandbox=yield _this26._ready;setTimeout(()=>sandbox.dispatchEvent(event),0)})()}destroySandbox(){var _this27=this;return _asyncToGenerator2(function*(){(yield _this27._ready).nukeSandbox()})()}}}],__webpack_module_cache__2={};function __w_pdfjs_require__2(moduleId){var cachedModule=__webpack_module_cache__2[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module3=__webpack_module_cache__2[moduleId]={exports:{}};return __webpack_modules__2[moduleId](module3,module3.exports,__w_pdfjs_require__2),module3.exports}var __nested_webpack_exports__2={};return(()=>{var exports2=__nested_webpack_exports__2;Object.defineProperty(exports2,"__esModule",{value:!0}),Object.defineProperty(exports2,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return _annotation_layer_builder.AnnotationLayerBuilder}}),Object.defineProperty(exports2,"DefaultAnnotationLayerFactory",{enumerable:!0,get:function(){return _default_factory.DefaultAnnotationLayerFactory}}),Object.defineProperty(exports2,"DefaultStructTreeLayerFactory",{enumerable:!0,get:function(){return _default_factory.DefaultStructTreeLayerFactory}}),Object.defineProperty(exports2,"DefaultTextLayerFactory",{enumerable:!0,get:function(){return _default_factory.DefaultTextLayerFactory}}),Object.defineProperty(exports2,"DefaultXfaLayerFactory",{enumerable:!0,get:function(){return _default_factory.DefaultXfaLayerFactory}}),Object.defineProperty(exports2,"DownloadManager",{enumerable:!0,get:function(){return _download_manager.DownloadManager}}),Object.defineProperty(exports2,"EventBus",{enumerable:!0,get:function(){return _event_utils.EventBus}}),Object.defineProperty(exports2,"GenericL10n",{enumerable:!0,get:function(){return _genericl10n.GenericL10n}}),Object.defineProperty(exports2,"LinkTarget",{enumerable:!0,get:function(){return _pdf_link_service.LinkTarget}}),Object.defineProperty(exports2,"NullL10n",{enumerable:!0,get:function(){return _l10n_utils.NullL10n}}),Object.defineProperty(exports2,"PDFFindController",{enumerable:!0,get:function(){return _pdf_find_controller.PDFFindController}}),Object.defineProperty(exports2,"PDFHistory",{enumerable:!0,get:function(){return _pdf_history.PDFHistory}}),Object.defineProperty(exports2,"PDFLinkService",{enumerable:!0,get:function(){return _pdf_link_service.PDFLinkService}}),Object.defineProperty(exports2,"PDFPageView",{enumerable:!0,get:function(){return _pdf_page_view.PDFPageView}}),Object.defineProperty(exports2,"PDFScriptingManager",{enumerable:!0,get:function(){return _pdf_scripting_manager.PDFScriptingManager}}),Object.defineProperty(exports2,"PDFSinglePageViewer",{enumerable:!0,get:function(){return _pdf_viewer.PDFSinglePageViewer}}),Object.defineProperty(exports2,"PDFViewer",{enumerable:!0,get:function(){return _pdf_viewer.PDFViewer}}),Object.defineProperty(exports2,"ProgressBar",{enumerable:!0,get:function(){return _ui_utils.ProgressBar}}),Object.defineProperty(exports2,"RenderingStates",{enumerable:!0,get:function(){return _ui_utils.RenderingStates}}),Object.defineProperty(exports2,"ScrollMode",{enumerable:!0,get:function(){return _ui_utils.ScrollMode}}),Object.defineProperty(exports2,"SimpleLinkService",{enumerable:!0,get:function(){return _pdf_link_service.SimpleLinkService}}),Object.defineProperty(exports2,"SpreadMode",{enumerable:!0,get:function(){return _ui_utils.SpreadMode}}),Object.defineProperty(exports2,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return _struct_tree_layer_builder.StructTreeLayerBuilder}}),Object.defineProperty(exports2,"TextLayerBuilder",{enumerable:!0,get:function(){return _text_layer_builder.TextLayerBuilder}}),Object.defineProperty(exports2,"XfaLayerBuilder",{enumerable:!0,get:function(){return _xfa_layer_builder.XfaLayerBuilder}}),Object.defineProperty(exports2,"parseQueryString",{enumerable:!0,get:function(){return _ui_utils.parseQueryString}});var _default_factory=__w_pdfjs_require__2(1),_pdf_link_service=__w_pdfjs_require__2(6),_ui_utils=__w_pdfjs_require__2(7),_pdf_viewer=__w_pdfjs_require__2(11),_annotation_layer_builder=__w_pdfjs_require__2(5),_download_manager=__w_pdfjs_require__2(18),_event_utils=__w_pdfjs_require__2(19),_genericl10n=__w_pdfjs_require__2(20),_l10n_utils=__w_pdfjs_require__2(4),_pdf_find_controller=__w_pdfjs_require__2(22),_pdf_history=__w_pdfjs_require__2(24),_pdf_page_view=__w_pdfjs_require__2(13),_pdf_scripting_manager=__w_pdfjs_require__2(25),_struct_tree_layer_builder=__w_pdfjs_require__2(8),_text_layer_builder=__w_pdfjs_require__2(9),_xfa_layer_builder=__w_pdfjs_require__2(10)})(),__nested_webpack_exports__2})()}};